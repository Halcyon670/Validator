
2016-09-27 00:51:15.638046: Successfully purged prior log and started a new one.
2016-09-27 00:51:30.910196: Moving forward with the following docs: ['32a970f6e-14d6ebf9480', '345c365a8-14e0260ea7e']
2016-09-27 00:51:30.992753: Checking 32a970f6e-14d6ebf9480 (Avg Monthly Visits vs Days Since Last Trip, AV_Q01):
	Query: SELECT CRMDemo.dbo.cqa.cell_index AS CellIndex,'Q' + substring(cqa.cell_index,1,1) AS QL1,'Q' + substring(cqa.cell_index,1,2) AS QL2,'Q' + substring(cqa.cell_index,1,3) AS QL3,'Q' + substring(cqa.cell_index,1,4) AS QL4,case when SUM(BIS2_VW_PlayerSession.coinin) <> 0 then (SUM(BIS2_VW_PlayerSession.win)/SUM(BIS2_VW_PlayerSession.coinin))*100.0 else 0 end AS ActualHold,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin,Case WHEN count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) <> 0 THEN  sum(BIS2_VW_PlayerSession.TheoWin)/count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) ELSE 0 END AS ADT,case when SUM(BIS2_VW_PlayerSession.Games)<>0 THEN SUM(BIS2_VW_PlayerSession.Coinin)/SUM(BIS2_VW_PlayerSession.Games) ELSE 0 END AS AvgBet,Sum(BIS2_VW_PlayerSession.TheoWin)/cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS AvgMonthlyTheo,cast(count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) as decimal(10,4))/cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS AvgMonthlyVisits,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.CoinIn) AS CoinIn,AVG(BIS2_SQLTC_PlayerSummary.DaysSinceLastTrip) AS DaysSinceLastTrip,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.FreePlay) AS Freeplay,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Games) AS GamesPlayed,SUM(BIS2_VW_PlayerSession.TimePlayed / 3600.0) AS HoursPlayed,CASE when count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar))<>0 THEN SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0)/count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) ELSE 0 END AS HoursPlayedPerVisit,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Jackpot) AS Jackpot,MAX(BIS2_SQLTC_PlayerSummary.AMV) AS MaxAMV,MAX(BIS2_SQLTC_PlayerSummary.DaysSinceLastTrip) AS MaxDaysSinceLastTrip,cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS MonthswithPlay,COUNT(DISTINCT BIS2_VW_PlayerSession.PlayerID) AS Player_Count,case when SUM(BIS2_VW_PlayerSession.coinin) <> 0 then (SUM(BIS2_VW_PlayerSession.theowin)/SUM(BIS2_VW_PlayerSession.coinin))*100.0 else 0 end AS TheoHold,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.TheoWin) AS TheoWin,count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) AS Visits,CASE WHEN COUNT(DISTINCT BIS2_VW_PlayerSession.PlayerID)<>0 THEN cast(count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) as decimal(10,2))/COUNT(DISTINCT BIS2_VW_PlayerSession.PlayerID) ELSE 0 END AS VisitsperPlayer FROM CRMDemo.dbo.BIS2_VW_PlayerSession INNER JOIN CRMDemo.dbo.cqa ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = CRMDemo.dbo.cqa.pk INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_PlayerSummary*/SELECT MAX(BIS2_VW_PlayerSession.GamingDate) AS LastDaywithPlay,CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID AS PlayerID,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin,CASE WHEN SUM(BIS2_VW_PlayerSession.TheoWin)<>0 THEN 100.0*SUM(BIS2_VW_PlayerSession.Win)/SUM(BIS2_VW_PlayerSession.TheoWin) ELSE 0 END AS ActualWinTheoWinRatio,Case WHEN count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) <> 0 THEN  sum(BIS2_VW_PlayerSession.TheoWin)/count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) ELSE 0 END AS ADT,Sum(BIS2_VW_PlayerSession.TheoWin)/cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS AMT,cast(count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) as decimal(10,4))/cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS AMV,datediff(dd,max(cast(BIS2_VW_PlayerSession.GamingDate as varchar)),MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,CASE WHEN SUM(BIS2_VW_PlayerSession.TheoWin)<>0 THEN (SUM(BIS2_VW_PlayerSession.Freeplay)*100.0)/SUM(BIS2_VW_PlayerSession.TheoWin) ELSE 0 END AS FreeplayReinvestmentPct,CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then  datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end AS MeanTimeBetweenTrips,CASE WHEN SUM(case when GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)<>0 THEN (100.0*(SUM(case when   GamingDate>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)-SUM(case when   GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)))/SUM(case when   GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END) ELSE 0 END AS PercentChangeTheoWin,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END) ELSE 0 END AS PercentChangeVisits,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.TheoWin) AS TheoWin,CASE WHEN CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then   datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end <>0 THEN  datediff(dd,  max(cast(BIS2_VW_PlayerSession.GamingDate as varchar)),  MAX(BIS2_FN_SGStartEndDate.SGEndDate))/CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then   datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end ELSE 0 END AS TripsOwed,case when cast(DATEDIFF(dd,max(BIS2_VW_PlayerSession.GamingDate),min(BIS2_VW_PlayerSession.GamingDate)) as decimal(15,2)) <> 0 then  (count(distinct BIS2_VW_PlayerSession.GamingDate)-1)/cast(DATEDIFF(dd,min(BIS2_VW_PlayerSession.GamingDate),max(dbo.BIS2_VW_PlayerSession.GamingDate)) as decimal(15,2))  ELSE 0 END AS VisitDensity,count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) AS Visits FROM CRMDemo.dbo.BIS2_VW_PlayerSession INNER HASH JOIN CRMDemo.dbo.BIS2_FN_SGStartEndDate('20130201 00:00:00','20130501 00:00:00') AS BIS2_FN_SGStartEndDate ON CRMDemo.dbo.BIS2_VW_PlayerSession.hackjoin = BIS2_FN_SGStartEndDate.HackJoin INNER JOIN CRMDemo.dbo.cqa ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = CRMDemo.dbo.cqa.pk WHERE ((CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') AND (CRMDemo.dbo.cqa.allocation_id = '32a975063-14d6ec23654')) GROUP BY CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID/* End: BIS2_SQLTC_PlayerSummary*/) AS BIS2_SQLTC_PlayerSummary ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = BIS2_SQLTC_PlayerSummary.PlayerID WHERE ((CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') AND (CRMDemo.dbo.cqa.allocation_id = '32a975063-14d6ec23654')) GROUP BY CRMDemo.dbo.cqa.cell_index,'Q' + substring(cqa.cell_index,1,1),'Q' + substring(cqa.cell_index,1,2),'Q' + substring(cqa.cell_index,1,3),'Q' + substring(cqa.cell_index,1,4)
	DocAggs: ['ActualHold', 'ActualWin', 'AvgBet', 'CoinIn', 'Freeplay', 'GamesPlayed', 'HoursPlayed', 'HoursPlayedPerVisit', 'Jackpot', 'Player_Count', 'TheoHold', 'TheoWin']
	DocAggDict: {'Jackpot': 'SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Jackpot) AS Jackpot', 'Freeplay': 'SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.FreePlay) AS Freeplay', 'Player_Count': 'COUNT(DISTINCT BIS2_VW_PlayerSession.PlayerID) AS Player_Count', 'HoursPlayed': 'SUM(BIS2_VW_PlayerSession.TimePlayed / 3600.0) AS HoursPlayed', 'GamesPlayed': 'SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Games) AS GamesPlayed', 'ActualHold': 'SUM(BIS2_VW_PlayerSession.coinin) <> 0 then (SUM(BIS2_VW_PlayerSession.win)/SUM(BIS2_VW_PlayerSession.coinin))*100.0 else 0 end AS ActualHold', 'AvgBet': 'SUM(BIS2_VW_PlayerSession.Games)<>0 THEN SUM(BIS2_VW_PlayerSession.Coinin)/SUM(BIS2_VW_PlayerSession.Games) ELSE 0 END AS AvgBet', 'TheoWin': 'SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.TheoWin) AS TheoWin', 'HoursPlayedPerVisit': 'SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0)/count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) ELSE 0 END AS HoursPlayedPerVisit', 'CoinIn': 'SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.CoinIn) AS CoinIn', 'TheoHold': 'SUM(BIS2_VW_PlayerSession.coinin) <> 0 then (SUM(BIS2_VW_PlayerSession.theowin)/SUM(BIS2_VW_PlayerSession.coinin))*100.0 else 0 end AS TheoHold', 'ActualWin': 'SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin'}
	DocJoins: ['CRMDemo.dbo.BIS2_VW_PlayerSession', 'CRMDemo.dbo.cqa', 'BIS2_SQLTC_PlayerSummary']DocJoinDict: {'CRMDemo.dbo.BIS2_VW_PlayerSession': 'FROM CRMDemo.dbo.BIS2_VW_PlayerSession ', 'BIS2_SQLTC_PlayerSummary': "INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_PlayerSummary*/SELECT MAX(BIS2_VW_PlayerSession.GamingDate) AS LastDaywithPlay,CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID AS PlayerID,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin,CASE WHEN SUM(BIS2_VW_PlayerSession.TheoWin)<>0 THEN 100.0*SUM(BIS2_VW_PlayerSession.Win)/SUM(BIS2_VW_PlayerSession.TheoWin) ELSE 0 END AS ActualWinTheoWinRatio,Case WHEN count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) <> 0 THEN  sum(BIS2_VW_PlayerSession.TheoWin)/count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) ELSE 0 END AS ADT,Sum(BIS2_VW_PlayerSession.TheoWin)/cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS AMT,cast(count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) as decimal(10,4))/cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS AMV,datediff(dd,max(cast(BIS2_VW_PlayerSession.GamingDate as varchar)),MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,CASE WHEN SUM(BIS2_VW_PlayerSession.TheoWin)<>0 THEN (SUM(BIS2_VW_PlayerSession.Freeplay)*100.0)/SUM(BIS2_VW_PlayerSession.TheoWin) ELSE 0 END AS FreeplayReinvestmentPct,CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then  datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end AS MeanTimeBetweenTrips,CASE WHEN SUM(case when GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)<>0 THEN (100.0*(SUM(case when   GamingDate>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)-SUM(case when   GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)))/SUM(case when   GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END) ELSE 0 END AS PercentChangeTheoWin,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END) ELSE 0 END AS PercentChangeVisits,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.TheoWin) AS TheoWin,CASE WHEN CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then   datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end <>0 THEN  datediff(dd,  max(cast(BIS2_VW_PlayerSession.GamingDate as varchar)),  MAX(BIS2_FN_SGStartEndDate.SGEndDate))/CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then   datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end ELSE 0 END AS TripsOwed,case when cast(DATEDIFF(dd,max(BIS2_VW_PlayerSession.GamingDate),min(BIS2_VW_PlayerSession.GamingDate)) as decimal(15,2)) <> 0 then  (count(distinct BIS2_VW_PlayerSession.GamingDate)-1)/cast(DATEDIFF(dd,min(BIS2_VW_PlayerSession.GamingDate),max(dbo.BIS2_VW_PlayerSession.GamingDate)) as decimal(15,2))  ELSE 0 END AS VisitDensity,count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) AS Visits FROM CRMDemo.dbo.BIS2_VW_PlayerSession INNER HASH JOIN CRMDemo.dbo.BIS2_FN_SGStartEndDate('20130201 00:00:00','20130501 00:00:00') AS BIS2_FN_SGStartEndDate ON CRMDemo.dbo.BIS2_VW_PlayerSession.hackjoin = BIS2_FN_SGStartEndDate.HackJoin INNER JOIN CRMDemo.dbo.cqa ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = CRMDemo.dbo.cqa.pk WHERE ((CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') AND (CRMDemo.dbo.cqa.allocation_id = '32a975063-14d6ec23654')) GROUP BY CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID/* End: BIS2_SQLTC_PlayerSummary*/) AS BIS2_SQLTC_PlayerSummary ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = BIS2_SQLTC_PlayerSummary.PlayerID ", 'CRMDemo.dbo.cqa': 'INNER JOIN CRMDemo.dbo.cqa ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = CRMDemo.dbo.cqa.pk '}
	DocWhere: ["(CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') ", "(CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') ", "(CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') ", "(CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') ", "(CRMDemo.dbo.cqa.allocation_id = '32a975063-14d6ec23654')"]
	DocWhereAnd: {"(CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') ": 'AND ', "(CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') ": 'start', "(CRMDemo.dbo.cqa.allocation_id = '32a975063-14d6ec23654')": 'AND ', "(CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') ": 'AND ', "(CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') ": 'AND '}
2016-09-27 00:51:53.118795: Final data about 32a970f6e-14d6ebf9480:
	UserAggList: ['ActualWin', 'CoinIn']
	UserRestrictList: []
	FinalQuery: SELECT 'Step 1' AS Step, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.CoinIn) AS CoinIn, 'CRMDemo.dbo.BIS2_VW_PlayerSession' AS StepInfo FROM CRMDemo.dbo.BIS2_VW_PlayerSession WHERE (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502')  UNION ALL SELECT 'Step 2' AS Step, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.CoinIn) AS CoinIn, 'CRMDemo.dbo.cqa' AS StepInfo FROM CRMDemo.dbo.BIS2_VW_PlayerSession INNER JOIN CRMDemo.dbo.cqa ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = CRMDemo.dbo.cqa.pk WHERE (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502')  AND (CRMDemo.dbo.cqa.allocation_id = '32a975063-14d6ec23654') UNION ALL SELECT 'Step 3' AS Step, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.CoinIn) AS CoinIn, 'BIS2_SQLTC_PlayerSummary' AS StepInfo FROM CRMDemo.dbo.BIS2_VW_PlayerSession INNER JOIN CRMDemo.dbo.cqa ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = CRMDemo.dbo.cqa.pk INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_PlayerSummary*/SELECT MAX(BIS2_VW_PlayerSession.GamingDate) AS LastDaywithPlay,CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID AS PlayerID,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin,CASE WHEN SUM(BIS2_VW_PlayerSession.TheoWin)<>0 THEN 100.0*SUM(BIS2_VW_PlayerSession.Win)/SUM(BIS2_VW_PlayerSession.TheoWin) ELSE 0 END AS ActualWinTheoWinRatio,Case WHEN count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) <> 0 THEN  sum(BIS2_VW_PlayerSession.TheoWin)/count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) ELSE 0 END AS ADT,Sum(BIS2_VW_PlayerSession.TheoWin)/cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS AMT,cast(count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) as decimal(10,4))/cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS AMV,datediff(dd,max(cast(BIS2_VW_PlayerSession.GamingDate as varchar)),MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,CASE WHEN SUM(BIS2_VW_PlayerSession.TheoWin)<>0 THEN (SUM(BIS2_VW_PlayerSession.Freeplay)*100.0)/SUM(BIS2_VW_PlayerSession.TheoWin) ELSE 0 END AS FreeplayReinvestmentPct,CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then  datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end AS MeanTimeBetweenTrips,CASE WHEN SUM(case when GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)<>0 THEN (100.0*(SUM(case when   GamingDate>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)-SUM(case when   GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)))/SUM(case when   GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END) ELSE 0 END AS PercentChangeTheoWin,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END) ELSE 0 END AS PercentChangeVisits,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.TheoWin) AS TheoWin,CASE WHEN CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then   datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end <>0 THEN  datediff(dd,  max(cast(BIS2_VW_PlayerSession.GamingDate as varchar)),  MAX(BIS2_FN_SGStartEndDate.SGEndDate))/CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then   datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end ELSE 0 END AS TripsOwed,case when cast(DATEDIFF(dd,max(BIS2_VW_PlayerSession.GamingDate),min(BIS2_VW_PlayerSession.GamingDate)) as decimal(15,2)) <> 0 then  (count(distinct BIS2_VW_PlayerSession.GamingDate)-1)/cast(DATEDIFF(dd,min(BIS2_VW_PlayerSession.GamingDate),max(dbo.BIS2_VW_PlayerSession.GamingDate)) as decimal(15,2))  ELSE 0 END AS VisitDensity,count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) AS Visits FROM CRMDemo.dbo.BIS2_VW_PlayerSession INNER HASH JOIN CRMDemo.dbo.BIS2_FN_SGStartEndDate('20130201 00:00:00','20130501 00:00:00') AS BIS2_FN_SGStartEndDate ON CRMDemo.dbo.BIS2_VW_PlayerSession.hackjoin = BIS2_FN_SGStartEndDate.HackJoin INNER JOIN CRMDemo.dbo.cqa ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = CRMDemo.dbo.cqa.pk WHERE ((CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') AND (CRMDemo.dbo.cqa.allocation_id = '32a975063-14d6ec23654')) GROUP BY CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID/* End: BIS2_SQLTC_PlayerSummary*/) AS BIS2_SQLTC_PlayerSummary ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = BIS2_SQLTC_PlayerSummary.PlayerID WHERE (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502')  AND (CRMDemo.dbo.cqa.allocation_id = '32a975063-14d6ec23654')
2016-09-27 00:51:53.166344: Checking 345c365a8-14e0260ea7e (Player Count by Hour over Week, AV_T01):
	Query: SELECT datepart(yyyy,CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime)*1000000 + datepart(mm,CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime)*10000 + datepart(dd,CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime)*100 + datepart(hh,CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime) AS VBB2__NORM_FIELD,substring(datename(weekday, BIS2_VW_PlayerSession.EndTime),1,3) AS DayofWeek,RIGHT('00' + RTRIM(datepart(dd,BIS2_VW_PlayerSession.EndTime)), 2) AS Day_,DATEPART(yyyy,BIS2_VW_PlayerSession.EndTime)*1000000 + DATEPART(mm,BIS2_VW_PlayerSession.EndTime)*10000 + DATEPART(dd,BIS2_VW_PlayerSession.EndTime)*100 + DATEPART(hh,BIS2_VW_PlayerSession.EndTime) AS HourNorm,RIGHT('00' + RTRIM(datepart(hh,BIS2_VW_PlayerSession.EndTime)), 2) AS Hour_,substring(DATENAME(month, BIS2_VW_PlayerSession.EndTime),1,3) AS MonthName,RIGHT('00' + RTRIM(datepart (yyyy, BIS2_VW_PlayerSession.EndTime)), 4) AS Year_,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.CoinIn) AS CoinIn,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.FreePlay) AS Freeplay,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Games) AS GamesPlayed,SUM(BIS2_VW_PlayerSession.TimePlayed / 3600.0) AS HoursPlayed,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Jackpot) AS Jackpot,COUNT(DISTINCT BIS2_VW_PlayerSession.PlayerID) AS PlayerCount,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.TheoWin) AS TheoWin FROM CRMDemo.dbo.BIS2_VW_PlayerSession INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PlayerSession.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130101 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20121231') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY datepart(yyyy,CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime)*1000000 + datepart(mm,CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime)*10000 + datepart(dd,CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime)*100 + datepart(hh,CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime),substring(datename(weekday, BIS2_VW_PlayerSession.EndTime),1,3),RIGHT('00' + RTRIM(datepart(dd,BIS2_VW_PlayerSession.EndTime)), 2),DATEPART(yyyy,BIS2_VW_PlayerSession.EndTime)*1000000 + DATEPART(mm,BIS2_VW_PlayerSession.EndTime)*10000 + DATEPART(dd,BIS2_VW_PlayerSession.EndTime)*100 + DATEPART(hh,BIS2_VW_PlayerSession.EndTime),RIGHT('00' + RTRIM(datepart(hh,BIS2_VW_PlayerSession.EndTime)), 2),substring(DATENAME(month, BIS2_VW_PlayerSession.EndTime),1,3),RIGHT('00' + RTRIM(datepart (yyyy, BIS2_VW_PlayerSession.EndTime)), 4)
	DocAggs: ['ActualWin', 'CoinIn', 'Freeplay', 'GamesPlayed', 'HoursPlayed', 'Jackpot', 'PlayerCount']
	DocAggDict: {'Jackpot': 'SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Jackpot) AS Jackpot', 'Freeplay': 'SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.FreePlay) AS Freeplay', 'HoursPlayed': 'SUM(BIS2_VW_PlayerSession.TimePlayed / 3600.0) AS HoursPlayed', 'PlayerCount': 'COUNT(DISTINCT BIS2_VW_PlayerSession.PlayerID) AS PlayerCount', 'CoinIn': 'SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.CoinIn) AS CoinIn', 'GamesPlayed': 'SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Games) AS GamesPlayed', 'ActualWin': 'SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin'}
	DocJoins: ['CRMDemo.dbo.BIS2_VW_PlayerSession', 'CRMDemo.dbo.BIS2_VW_Site']DocJoinDict: {'CRMDemo.dbo.BIS2_VW_PlayerSession': 'FROM CRMDemo.dbo.BIS2_VW_PlayerSession ', 'CRMDemo.dbo.BIS2_VW_Site': 'INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PlayerSession.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID '}
	DocWhere: ["(CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130101 00:00:00') ", "(CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') ", "(CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20121231') ", "(CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') ", "(CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')"]
	DocWhereAnd: {"(CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')": 'AND ', "(CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130101 00:00:00') ": 'start', "(CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20121231') ": 'AND ', "(CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') ": 'AND ', "(CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') ": 'AND '}
2016-09-27 00:51:56.756748: Final data about 345c365a8-14e0260ea7e:
	UserAggList: ['ActualWin', 'CoinIn']
	UserRestrictList: []
	FinalQuery: SELECT 'Step 1' AS Step, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.CoinIn) AS CoinIn, 'CRMDemo.dbo.BIS2_VW_PlayerSession' AS StepInfo FROM CRMDemo.dbo.BIS2_VW_PlayerSession WHERE (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130101 00:00:00')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20121231')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502')  UNION ALL SELECT 'Step 2' AS Step, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.CoinIn) AS CoinIn, 'CRMDemo.dbo.BIS2_VW_Site' AS StepInfo FROM CRMDemo.dbo.BIS2_VW_PlayerSession INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PlayerSession.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID WHERE (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130101 00:00:00')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20121231')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502')  AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')
2016-09-27 00:51:56.771758: Now attempting to run the query for 32a970f6e-14d6ebf9480:
2016-09-27 00:51:56.783767: Attempting to connect to the database:
2016-09-27 00:52:02.342414: Database connection successful.
2016-09-27 00:52:19.542983: Query successfully run. Here are the results:
	[('Step 1', Decimal('26121828.5200'), Decimal('322868958.48'), 'CRMDemo.dbo.BIS2_VW_PlayerSession'), ('Step 2', Decimal('26121828.5200'), Decimal('322868958.48'), 'CRMDemo.dbo.cqa'), ('Step 3', Decimal('26121828.5200'), Decimal('322868958.48'), 'BIS2_SQLTC_PlayerSummary')]
2016-09-27 00:52:19.567495: Now attempting to run the query for 345c365a8-14e0260ea7e:
2016-09-27 00:52:19.572003: Attempting to connect to the database:
2016-09-27 00:52:21.694980: Database connection successful.
2016-09-27 00:52:30.296676: Query successfully run. Here are the results:
	[('Step 1', Decimal('35009826.7400'), Decimal('421954547.60'), 'CRMDemo.dbo.BIS2_VW_PlayerSession'), ('Step 2', Decimal('17504913.3700'), Decimal('210977273.80'), 'CRMDemo.dbo.BIS2_VW_Site')]
2016-09-27 00:52:30.303669: Attempting to create the excel sheet for 32a970f6e-14d6ebf9480
2016-09-27 00:52:30.448965: Excel sheet for 32a970f6e-14d6ebf9480 successful.
2016-09-27 00:52:30.452968: Attempting to create the excel sheet for 345c365a8-14e0260ea7e
2016-09-27 00:52:30.472982: Excel sheet for 345c365a8-14e0260ea7e successful.