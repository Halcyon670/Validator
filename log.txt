
2016-10-01 16:03:56.335349: Successfully purged prior log and started a new one.
2016-10-01 16:04:07.294154: Moving forward with the following docs: ['30846d1de-14cd49b8c49']
2016-10-01 16:04:07.487789: Checking 30846d1de-14cd49b8c49 (IVB All Play Theo Win per Day, FV_I01):
	Query: SELECT VBB2__Aggregates.Bank AS Bank,VBB2__Aggregates.CabinetType AS CabinetType,VBB2__Aggregates.Denom AS Denom,VBB2__Aggregates.DisplayType AS DisplayType,VBB2__Aggregates.GameType AS GameType,VBB2__Aggregates.Location AS Location,VBB2__Aggregates.Manufacturer AS Manufacturer,VBB2__Aggregates.Mnum AS Mnum,VBB2__Aggregates.Paylines AS Paylines,VBB2__Aggregates.Reels AS Reels,VBB2__Aggregates.Section AS Section,VBB2__Aggregates.Theme AS Theme,VBB2__Spatials.Latitude AS Latitude,VBB2__Spatials.Longitude AS Longitude,VBB2__Aggregates.Chairs_Standid AS Chairs_Standid,VBB2__Aggregates.Chairs_Standid_SCD_Start AS Chairs_Standid_SCD_Start,VBB2__Aggregates.Chairs_Standid_SCD_End AS Chairs_Standid_SCD_End,VBB2__Aggregates.Chairs_Standid_SCD_History AS Chairs_Standid_SCD_History,VBB2__Aggregates.Chairs_Standid_SCD_Changed AS Chairs_Standid_SCD_Changed,VBB2__Aggregates.Slot_StandID AS Slot_StandID,VBB2__Aggregates.Slot_StandID_SCD_Start AS Slot_StandID_SCD_Start,VBB2__Aggregates.Slot_StandID_SCD_End AS Slot_StandID_SCD_End,VBB2__Aggregates.Slot_StandID_SCD_History AS Slot_StandID_SCD_History,VBB2__Aggregates.Slot_StandID_SCD_Changed AS Slot_StandID_SCD_Changed,VBB2__Aggregates.ActualHold AS ActualHold,VBB2__Aggregates.ActualWin AS ActualWin,VBB2__Aggregates.ActualWinperDay AS ActualWinperDay,VBB2__Aggregates.AvgBet AS AvgBet,VBB2__Aggregates.CoinIn AS CoinIn,VBB2__Aggregates.CoinInperDay AS CoinInperDay,VBB2__Aggregates.DaysonFloor AS DaysonFloor,VBB2__Aggregates.Freeplay AS Freeplay,VBB2__Aggregates.FreeplayperDay AS FreeplayperDay,VBB2__Aggregates.GamesPlayed AS GamesPlayed,VBB2__Aggregates.GamesPlayedperDay AS GamesPlayedperDay,VBB2__Aggregates.GamesPlayedPerMinute AS GamesPlayedPerMinute,VBB2__Aggregates.HoldVariance AS HoldVariance,VBB2__Aggregates.Jackpot AS Jackpot,VBB2__Aggregates.MachineCount AS MachineCount,VBB2__Aggregates.Occupancy AS Occupancy,VBB2__Aggregates.PctofDenomAvgActualWin AS PctofDenomAvgActualWin,VBB2__Aggregates.PctofDenomAvgCoinIn AS PctofDenomAvgCoinIn,VBB2__Aggregates.PctofDenomAvgTheoWin AS PctofDenomAvgTheoWin,VBB2__Aggregates.PctofFloorAvgActualWin AS PctofFloorAvgActualWin,VBB2__Aggregates.PctofFloorAvgCoinIn AS PctofFloorAvgCoinIn,VBB2__Aggregates.PctofFloorAvgTheoWin AS PctofFloorAvgTheoWin,VBB2__Aggregates.PctofSectionAvgActualWin AS PctofSectionAvgActualWin,VBB2__Aggregates.PctofSectionAvgCoinIn AS PctofSectionAvgCoinIn,VBB2__Aggregates.PctofSectionAvgTheoWin AS PctofSectionAvgTheoWin,VBB2__Aggregates.TheoHold AS TheoHold,VBB2__Aggregates.TheoWin AS TheoWin,VBB2__Aggregates.TheoWinperDay AS TheoWinperDay,VBB2__Aggregates.TheoWinperHour AS TheoWinperHour FROM (SELECT CRMDemo.dbo.BIS2_V_Slot_Location_SCD.Bank AS Bank,CRMDemo.dbo.BIS2_VW_Slot_Names.CabinetType AS CabinetType,CRMDemo.dbo.BIS2_GEO_chairs.ogc_fid AS VBB2__kf_Chairs_ogc,CRMDemo.dbo.BIS2_VW_Slot_Names.Denom AS Denom,CRMDemo.dbo.BIS2_VW_Slot_Names.Cabinet AS DisplayType,CRMDemo.dbo.BIS2_VW_Slot_Names.GameType AS GameType,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.Location AS Location,CRMDemo.dbo.BIS2_VW_Slot_Names.MFR AS Manufacturer,CRMDemo.dbo.BIS2_VW_Slot_Names.mnum AS Mnum,CRMDemo.dbo.BIS2_VW_Slot_Names.Paylines AS Paylines,CRMDemo.dbo.BIS2_VW_Slot_Names.Reels AS Reels,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.Section AS Section,CRMDemo.dbo.BIS2_VW_Slot_Names.Description AS Theme,CRMDemo.dbo.BIS2_GEO_chairs.standid AS Chairs_Standid,CRMDemo.dbo.BIS2_GEO_chairs.startgd AS Chairs_Standid_SCD_Start,CRMDemo.dbo.BIS2_GEO_chairs.endgd AS Chairs_Standid_SCD_End,CRMDemo.dbo.BIS2_GEO_chairs.version AS Chairs_Standid_SCD_Version,CASE WHEN(datepart(year,CRMDemo.dbo.BIS2_GEO_chairs.startgd)*10000+datepart(mm,CRMDemo.dbo.BIS2_GEO_chairs.startgd)*100+datepart(dd,CRMDemo.dbo.BIS2_GEO_chairs.startgd))-(datepart(year,'20130501')*10000+datepart(mm,'20130501')*100+datepart(dd,'20130501'))<0 AND (datepart(year,'20130501')*10000+datepart(mm,'20130501')*100+datepart(dd,'20130501'))-(datepart(year,CRMDemo.dbo.BIS2_GEO_chairs.endgd)*10000+datepart(mm,CRMDemo.dbo.BIS2_GEO_chairs.endgd)*100+datepart(dd,CRMDemo.dbo.BIS2_GEO_chairs.endgd))<=0 THEN 0 ELSE 1 END AS Chairs_Standid_SCD_History,CASE WHEN((CRMDemo.dbo.BIS2_GEO_chairs.startgd < '20130501' AND CRMDemo.dbo.BIS2_GEO_chairs.startgd >= '20130201') OR (CRMDemo.dbo.BIS2_GEO_chairs.endgd < '20130501' AND CRMDemo.dbo.BIS2_GEO_chairs.endgd >= '20130201'))THEN 1 ELSE 0 END AS Chairs_Standid_SCD_Changed,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid AS Slot_StandID,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AS Slot_StandID_SCD_Start,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate AS Slot_StandID_SCD_End,CASE WHEN(datepart(year,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate)*10000+datepart(mm,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate)*100+datepart(dd,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate))-(datepart(year,'20130501')*10000+datepart(mm,'20130501')*100+datepart(dd,'20130501'))<0 AND (datepart(year,'20130501')*10000+datepart(mm,'20130501')*100+datepart(dd,'20130501'))-(datepart(year,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate)*10000+datepart(mm,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate)*100+datepart(dd,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate))<=0 THEN 0 ELSE 1 END AS Slot_StandID_SCD_History,CASE WHEN((CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate < '20130501' AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate >= '20130201') OR (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate < '20130501' AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate >= '20130201'))THEN 1 ELSE 0 END AS Slot_StandID_SCD_Changed,case when sum(BIS2_VW_PeriodDetail.MtrCoinIn)<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)*100.0/sum(BIS2_VW_PeriodDetail.MtrCoinIn) ELSE 0 END AS ActualHold,SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrWin) AS ActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS ActualWinperDay,case when sum(BIS2_VW_PeriodDetail.MtrGames) <> 0 then sum(BIS2_VW_PeriodDetail.MtrCoinin)/sum(BIS2_VW_PeriodDetail.MtrGames) else 0 end AS AvgBet,SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrCoinin) AS CoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS CoinInperDay,count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) AS DaysonFloor,SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrBonus) AS Freeplay,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrBonus)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS FreeplayperDay,SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrGames) AS GamesPlayed,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrGames)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS GamesPlayedperDay,MAX(BIS2_SQLTC_Occupancy.GamesPlayedPerMinute) AS GamesPlayedPerMinute,case when sum(BIS2_VW_PeriodDetail.MtrCoinIn)<>0 then (sum(BIS2_VW_PeriodDetail.MtrTheoWin)-sum(BIS2_VW_PeriodDetail.MtrWin))*100.0/sum(BIS2_VW_PeriodDetail.MtrCoinIn) ELSE 0 END AS HoldVariance,SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrJackpot) AS Jackpot,COUNT(DISTINCT BIS2_VW_PeriodDetail.StandID) AS MachineCount,MAX(BIS2_SQLTC_Occupancy.Occupancy) AS Occupancy,CASE WHEN MAX(BIS2_SQLTC_DenomAvg.DenomAvgActualWIn)<>0 then case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( BIS2_VW_PeriodDetail.date as varchar)) else 0 END /   MAX(BIS2_SQLTC_DenomAvg.DenomAvgActualWin) ELSE 0 END *100.0 AS PctofDenomAvgActualWin,CASE WHEN MAX(BIS2_SQLTC_DenomAvg.DenomAvgCoinIn)<>0 then case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END /   MAX(BIS2_SQLTC_DenomAvg.DenomAvgCoinIn) ELSE 0 END *100.0 AS PctofDenomAvgCoinIn,CASE WHEN MAX(BIS2_SQLTC_DenomAvg.DenomAvgTheoWin)<>0 then case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast(BIS2_VW_PeriodDetail.date as varchar))else 0 END /   MAX(BIS2_SQLTC_DenomAvg.DenomAvgTheoWin) ELSE 0 END *100.0 AS PctofDenomAvgTheoWin,CASE WHEN MAX(BIS2_SQLTC_FloorAvg.FloorAvgActualWIn)<>0 then case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( BIS2_VW_PeriodDetail.Date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( BIS2_VW_PeriodDetail.Date as varchar)) else 0 END / MAX(BIS2_SQLTC_FloorAvg.FloorAvgActualWin) ELSE 0 END *100.0 AS PctofFloorAvgActualWin,CASE WHEN MAX(BIS2_SQLTC_FloorAvg.FloorAvgCoinIn)<>0 then case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast(BIS2_VW_PeriodDetail.date as varchar))else 0 END / MAX(BIS2_SQLTC_FloorAvg.FloorAvgCoinIn) ELSE 0 END *100.0 AS PctofFloorAvgCoinIn,CASE WHEN MAX(BIS2_SQLTC_FloorAvg.FloorAvgTheoWin)<>0 then case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( BIS2_VW_PeriodDetail.Date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( BIS2_VW_PeriodDetail.Date as varchar)) else 0 END / MAX(BIS2_SQLTC_FloorAvg.FloorAvgTheoWIn) ELSE 0 END *100.0 AS PctofFloorAvgTheoWin,CASE WHEN MAX(BIS2_SQLTC_SectionAvg.SectionAvgActualWIn)<>0 then case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( BIS2_VW_PeriodDetail.Date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast(BIS2_VW_PeriodDetail.Date as varchar)) else 0 END / MAX(BIS2_SQLTC_SectionAvg.SectionAvgActualWin) ELSE 0 END *100.0 AS PctofSectionAvgActualWin,CASE WHEN MAX(BIS2_SQLTC_SectionAvg.SectionAvgCoinIn)<>0 then case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( BIS2_VW_PeriodDetail.Date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( BIS2_VW_PeriodDetail.Date as varchar)) else 0 END / MAX(BIS2_SQLTC_SectionAvg.SectionAvgCoinIn) ELSE 0 END *100.0 AS PctofSectionAvgCoinIn,CASE WHEN MAX(BIS2_SQLTC_SectionAvg.SectionAvgTheoWin)<>0 then case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( BIS2_VW_PeriodDetail.Date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( BIS2_VW_PeriodDetail.Date as varchar)) else 0 END / MAX(BIS2_SQLTC_SectionAvg.SectionAvgTheoWin) ELSE 0 END *100.0 AS PctofSectionAvgTheoWin,case when sum(BIS2_VW_PeriodDetail.MtrCoinIn)<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)*100.0/sum(BIS2_VW_PeriodDetail.MtrCoinIn) ELSE 0 END AS TheoHold,SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrTheoWin) AS TheoWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS TheoWinperDay,MAX(BIS2_SQLTC_Occupancy.TheoWinPerHour) AS TheoWinperHour FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo.dbo.BIS2_GEO_chairs ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid = CRMDemo.dbo.BIS2_GEO_chairs.standid AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo.dbo.BIS2_GEO_chairs.casinoid) INNER JOIN CRMDemo.dbo.BIS2_VW_Slot_Names ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo.dbo.BIS2_VW_Slot_Names.SiteID) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DenomAvg*/SELECT CRMDemo.dbo.BIS2_VW_Slot_Names.Denom AS Denom,CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID AS SiteID,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS DenomAvgTheoWin FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo.dbo.BIS2_VW_Slot_Names ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo.dbo.BIS2_VW_Slot_Names.SiteID) INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY CRMDemo.dbo.BIS2_VW_Slot_Names.Denom,CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID) AS BIS2_SQLTC_DenomAvg ON (CRMDemo.dbo.BIS2_VW_Slot_Names.SiteID = BIS2_SQLTC_DenomAvg.SiteID AND CRMDemo.dbo.BIS2_VW_Slot_Names.Denom = BIS2_SQLTC_DenomAvg.Denom) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_SectionAvg*/SELECT CRMDemo.dbo.BIS2_V_Slot_Location_SCD.Section AS Section,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AS siteid,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS SectionAvgTheoWin FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) WHERE ((CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY CRMDemo.dbo.BIS2_V_Slot_Location_SCD.Section,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid) AS BIS2_SQLTC_SectionAvg ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = BIS2_SQLTC_SectionAvg.siteid AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.Section = BIS2_SQLTC_SectionAvg.Section) INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_Occupancy*/SELECT BIS2_SQLTC_RatedMetrics.Mnum AS Mnum,BIS2_SQLTC_RatedMetrics.SiteID AS SiteID,BIS2_SQLTC_RatedMetrics.StandID AS StandID,BIS2_SQLTC_RatedMetrics.startdate AS startdate,BIS2_SQLTC_RatedMetrics.GamesPlayedPerMinute AS GamesPlayedPerMinute,CASE WHEN BIS2_SQLTC_RatedMetrics.GamesPlayedperHour/24.0 <> 0 THEN   100.0*BIS2_SQLTC_UnRatedMetrics.GamesPlayedperDay/BIS2_SQLTC_RatedMetrics.GamesPlayedperHour/24.0 ELSE 0 END AS Occupancy,BIS2_SQLTC_RatedMetrics.TheoWinperHour AS TheoWinperHour FROM (/* SqlTableCalculator: BIS2_SQLTC_RatedMetrics*/SELECT CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AS Mnum,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AS SiteID,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid AS StandID,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AS startdate,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0) <> 0 THEN  SUM(BIS2_VW_PlayerSession.Games)/(SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0)) ELSE 0 END AS GamesPlayedPerHour,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed/60.0) <> 0 THEN  SUM(BIS2_VW_PlayerSession.Games)/(SUM(BIS2_VW_PlayerSession.TimePlayed/60.0)) ELSE 0 END AS GamesPlayedPerMinute,COUNT(DISTINCT BIS2_VW_PlayerSession.PlayerID) AS PlayerCount,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed) <> 0 THEN SUM(BIS2_VW_PlayerSession.TheoWin) /   (SUM(BIS2_VW_PlayerSession.TimePlayed)/3600.00) ELSE 0 END AS TheoWinperHour FROM CRMDemo.dbo.BIS2_VW_PlayerSession INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PlayerSession.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PlayerSession.MNUM = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PlayerSession.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate) AS BIS2_SQLTC_RatedMetrics INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_UnratedMetrics*/SELECT CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AS Mnum,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AS SiteID,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid AS StandID,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AS startdate,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrGames)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS GamesPlayedperDay FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate) AS BIS2_SQLTC_UnratedMetrics ON (BIS2_SQLTC_RatedMetrics.SiteID = BIS2_SQLTC_UnratedMetrics.SiteID AND BIS2_SQLTC_RatedMetrics.Mnum = BIS2_SQLTC_UnratedMetrics.Mnum AND BIS2_SQLTC_RatedMetrics.StandID = BIS2_SQLTC_UnratedMetrics.StandID AND BIS2_SQLTC_RatedMetrics.startdate = BIS2_SQLTC_UnratedMetrics.startdate)) AS BIS2_SQLTC_Occupancy ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = BIS2_SQLTC_Occupancy.SiteID AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum = BIS2_SQLTC_Occupancy.Mnum AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid = BIS2_SQLTC_Occupancy.StandID AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate = BIS2_SQLTC_Occupancy.startdate) INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_FloorAvg*/SELECT CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID AS SiteID,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS FloorAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS FloorAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS FloorAvgTheoWin FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID) AS BIS2_SQLTC_FloorAvg ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = BIS2_SQLTC_FloorAvg.SiteID WHERE ((CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB') AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_GEO_chairs.startgd) AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_GEO_chairs.endgd) AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate) AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate)) GROUP BY CRMDemo.dbo.BIS2_V_Slot_Location_SCD.Bank,CRMDemo.dbo.BIS2_VW_Slot_Names.CabinetType,CRMDemo.dbo.BIS2_GEO_chairs.ogc_fid,CRMDemo.dbo.BIS2_VW_Slot_Names.Denom,CRMDemo.dbo.BIS2_VW_Slot_Names.Cabinet,CRMDemo.dbo.BIS2_VW_Slot_Names.GameType,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.Location,CRMDemo.dbo.BIS2_VW_Slot_Names.MFR,CRMDemo.dbo.BIS2_VW_Slot_Names.mnum,CRMDemo.dbo.BIS2_VW_Slot_Names.Paylines,CRMDemo.dbo.BIS2_VW_Slot_Names.Reels,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.Section,CRMDemo.dbo.BIS2_VW_Slot_Names.Description,CRMDemo.dbo.BIS2_GEO_chairs.standid,CRMDemo.dbo.BIS2_GEO_chairs.startgd,CRMDemo.dbo.BIS2_GEO_chairs.endgd,CRMDemo.dbo.BIS2_GEO_chairs.version,CASE WHEN(datepart(year,CRMDemo.dbo.BIS2_GEO_chairs.startgd)*10000+datepart(mm,CRMDemo.dbo.BIS2_GEO_chairs.startgd)*100+datepart(dd,CRMDemo.dbo.BIS2_GEO_chairs.startgd))-(datepart(year,'20130501')*10000+datepart(mm,'20130501')*100+datepart(dd,'20130501'))<0 AND (datepart(year,'20130501')*10000+datepart(mm,'20130501')*100+datepart(dd,'20130501'))-(datepart(year,CRMDemo.dbo.BIS2_GEO_chairs.endgd)*10000+datepart(mm,CRMDemo.dbo.BIS2_GEO_chairs.endgd)*100+datepart(dd,CRMDemo.dbo.BIS2_GEO_chairs.endgd))<=0 THEN 0 ELSE 1 END,CASE WHEN((CRMDemo.dbo.BIS2_GEO_chairs.startgd < '20130501' AND CRMDemo.dbo.BIS2_GEO_chairs.startgd >= '20130201') OR (CRMDemo.dbo.BIS2_GEO_chairs.endgd < '20130501' AND CRMDemo.dbo.BIS2_GEO_chairs.endgd >= '20130201'))THEN 1 ELSE 0 END,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate,CASE WHEN(datepart(year,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate)*10000+datepart(mm,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate)*100+datepart(dd,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate))-(datepart(year,'20130501')*10000+datepart(mm,'20130501')*100+datepart(dd,'20130501'))<0 AND (datepart(year,'20130501')*10000+datepart(mm,'20130501')*100+datepart(dd,'20130501'))-(datepart(year,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate)*10000+datepart(mm,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate)*100+datepart(dd,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate))<=0 THEN 0 ELSE 1 END,CASE WHEN((CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate < '20130501' AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate >= '20130201') OR (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate < '20130501' AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate >= '20130201'))THEN 1 ELSE 0 END) AS VBB2__Aggregates INNER JOIN (SELECT CRMDemo.dbo.BIS2_GEO_chairs.ogc_fid AS VBB2__kf_Chairs_ogc,CRMDemo.dbo.BIS2_GEO_chairs.wkt_geo AS Latitude,CRMDemo.dbo.BIS2_GEO_chairs.wkt_geo AS Longitude FROM CRMDemo.dbo.BIS2_GEO_chairs) AS VBB2__Spatials ON VBB2__Aggregates.VBB2__kf_Chairs_ogc = VBB2__Spatials.VBB2__kf_Chairs_ogc ORDER BY Chairs_Standid,Chairs_Standid_SCD_History,Chairs_Standid_SCD_Start DESC,Slot_StandID,Slot_StandID_SCD_History,Slot_StandID_SCD_Start DESC
	DocAggs: ['ActualWin', 'CoinIn', 'Freeplay', 'GamesPlayed', 'Jackpot', 'MachineCount', 'TheoWin']
	DocAggDict: {'ActualWin': 'SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrWin) AS ActualWin', 'TheoWin': 'SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrTheoWin) AS TheoWin', 'GamesPlayed': 'SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrGames) AS GamesPlayed', 'Freeplay': 'SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrBonus) AS Freeplay', 'CoinIn': 'SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrCoinin) AS CoinIn', 'MachineCount': 'COUNT(DISTINCT BIS2_VW_PeriodDetail.StandID) AS MachineCount', 'Jackpot': 'SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrJackpot) AS Jackpot'}
	DocJoins: ['CRMDemo.dbo.BIS2_VW_PeriodDetail', 'CRMDemo.dbo.BIS2_VW_Site', 'CRMDemo.dbo.BIS2_V_Slot_Location_SCD', 'CRMDemo.dbo.BIS2_VW_Slot_Names', 'BIS2_SQLTC_DenomAvg', 'BIS2_SQLTC_SectionAvg', 'BIS2_SQLTC_Occupancy', 'BIS2_SQLTC_FloorAvg', 'CRMDemo.dbo.BIS2_GEO_chairs']DocJoinDict: {'CRMDemo.dbo.BIS2_GEO_chairs': 'INNER JOIN CRMDemo.dbo.BIS2_GEO_chairs ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid = CRMDemo.dbo.BIS2_GEO_chairs.standid AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo.dbo.BIS2_GEO_chairs.casinoid) ', 'CRMDemo.dbo.BIS2_VW_Site': 'INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID ', 'BIS2_SQLTC_DenomAvg': "INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DenomAvg*/SELECT CRMDemo.dbo.BIS2_VW_Slot_Names.Denom AS Denom,CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID AS SiteID,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS DenomAvgTheoWin FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo.dbo.BIS2_VW_Slot_Names ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo.dbo.BIS2_VW_Slot_Names.SiteID) INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY CRMDemo.dbo.BIS2_VW_Slot_Names.Denom,CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID) AS BIS2_SQLTC_DenomAvg ON (CRMDemo.dbo.BIS2_VW_Slot_Names.SiteID = BIS2_SQLTC_DenomAvg.SiteID AND CRMDemo.dbo.BIS2_VW_Slot_Names.Denom = BIS2_SQLTC_DenomAvg.Denom) ", 'CRMDemo.dbo.BIS2_VW_Slot_Names': 'INNER JOIN CRMDemo.dbo.BIS2_VW_Slot_Names ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo.dbo.BIS2_VW_Slot_Names.SiteID) ', 'BIS2_SQLTC_Occupancy': "INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_Occupancy*/SELECT BIS2_SQLTC_RatedMetrics.Mnum AS Mnum,BIS2_SQLTC_RatedMetrics.SiteID AS SiteID,BIS2_SQLTC_RatedMetrics.StandID AS StandID,BIS2_SQLTC_RatedMetrics.startdate AS startdate,BIS2_SQLTC_RatedMetrics.GamesPlayedPerMinute AS GamesPlayedPerMinute,CASE WHEN BIS2_SQLTC_RatedMetrics.GamesPlayedperHour/24.0 <> 0 THEN   100.0*BIS2_SQLTC_UnRatedMetrics.GamesPlayedperDay/BIS2_SQLTC_RatedMetrics.GamesPlayedperHour/24.0 ELSE 0 END AS Occupancy,BIS2_SQLTC_RatedMetrics.TheoWinperHour AS TheoWinperHour FROM (/* SqlTableCalculator: BIS2_SQLTC_RatedMetrics*/SELECT CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AS Mnum,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AS SiteID,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid AS StandID,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AS startdate,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0) <> 0 THEN  SUM(BIS2_VW_PlayerSession.Games)/(SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0)) ELSE 0 END AS GamesPlayedPerHour,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed/60.0) <> 0 THEN  SUM(BIS2_VW_PlayerSession.Games)/(SUM(BIS2_VW_PlayerSession.TimePlayed/60.0)) ELSE 0 END AS GamesPlayedPerMinute,COUNT(DISTINCT BIS2_VW_PlayerSession.PlayerID) AS PlayerCount,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed) <> 0 THEN SUM(BIS2_VW_PlayerSession.TheoWin) /   (SUM(BIS2_VW_PlayerSession.TimePlayed)/3600.00) ELSE 0 END AS TheoWinperHour FROM CRMDemo.dbo.BIS2_VW_PlayerSession INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PlayerSession.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PlayerSession.MNUM = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PlayerSession.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate) AS BIS2_SQLTC_RatedMetrics INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_UnratedMetrics*/SELECT CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AS Mnum,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AS SiteID,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid AS StandID,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AS startdate,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrGames)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS GamesPlayedperDay FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate) AS BIS2_SQLTC_UnratedMetrics ON (BIS2_SQLTC_RatedMetrics.SiteID = BIS2_SQLTC_UnratedMetrics.SiteID AND BIS2_SQLTC_RatedMetrics.Mnum = BIS2_SQLTC_UnratedMetrics.Mnum AND BIS2_SQLTC_RatedMetrics.StandID = BIS2_SQLTC_UnratedMetrics.StandID AND BIS2_SQLTC_RatedMetrics.startdate = BIS2_SQLTC_UnratedMetrics.startdate)) AS BIS2_SQLTC_Occupancy ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = BIS2_SQLTC_Occupancy.SiteID AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum = BIS2_SQLTC_Occupancy.Mnum AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid = BIS2_SQLTC_Occupancy.StandID AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate = BIS2_SQLTC_Occupancy.startdate) ", 'CRMDemo.dbo.BIS2_VW_PeriodDetail': 'FROM CRMDemo.dbo.BIS2_VW_PeriodDetail ', 'BIS2_SQLTC_SectionAvg': "INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_SectionAvg*/SELECT CRMDemo.dbo.BIS2_V_Slot_Location_SCD.Section AS Section,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AS siteid,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS SectionAvgTheoWin FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) WHERE ((CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY CRMDemo.dbo.BIS2_V_Slot_Location_SCD.Section,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid) AS BIS2_SQLTC_SectionAvg ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = BIS2_SQLTC_SectionAvg.siteid AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.Section = BIS2_SQLTC_SectionAvg.Section) ", 'CRMDemo.dbo.BIS2_V_Slot_Location_SCD': 'INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) ', 'BIS2_SQLTC_FloorAvg': "INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_FloorAvg*/SELECT CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID AS SiteID,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS FloorAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS FloorAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS FloorAvgTheoWin FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID) AS BIS2_SQLTC_FloorAvg ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = BIS2_SQLTC_FloorAvg.SiteID "}
	DocWhere: ["(CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') ", "(CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501') ", "(CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB') ", '(CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_GEO_chairs.startgd) ', '(CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_GEO_chairs.endgd) ', '(CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate) ', '(CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate)']
	DocWhereAnd: {'(CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate)': 'AND ', "(CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB') ": 'AND ', "(CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') ": 'start', '(CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_GEO_chairs.startgd) ': 'AND ', "(CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501') ": 'AND ', '(CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate) ': 'AND ', '(CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_GEO_chairs.endgd) ': 'AND '}
2016-10-01 16:04:17.300745: Final data about 30846d1de-14cd49b8c49:
	UserAggList: ['ActualWin', 'CoinIn', 'Jackpot', 'TheoWin']
	UserRestrictList: ["(CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB') "]
	FinalQuery: SELECT 'Step 1' AS Step, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrWin) AS ActualWin, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrCoinin) AS CoinIn, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrJackpot) AS Jackpot, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrTheoWin) AS TheoWin, 'CRMDemo.dbo.BIS2_VW_PeriodDetail' AS StepInfo FROM CRMDemo.dbo.BIS2_VW_PeriodDetail WHERE (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201')  AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501')  UNION ALL SELECT 'Step 2' AS Step, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrWin) AS ActualWin, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrCoinin) AS CoinIn, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrJackpot) AS Jackpot, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrTheoWin) AS TheoWin, 'CRMDemo.dbo.BIS2_VW_Site' AS StepInfo FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID WHERE (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201')  AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501')  UNION ALL SELECT 'Step 2B' AS Step, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrWin) AS ActualWin, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrCoinin) AS CoinIn, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrJackpot) AS Jackpot, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrTheoWin) AS TheoWin, 'CRMDemo.dbo.BIS2_VW_Site (Restriction)' AS StepInfo FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID WHERE (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201')  AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501')  AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')  UNION ALL SELECT 'Step 3' AS Step, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrWin) AS ActualWin, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrCoinin) AS CoinIn, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrJackpot) AS Jackpot, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrTheoWin) AS TheoWin, 'CRMDemo.dbo.BIS2_V_Slot_Location_SCD' AS StepInfo FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) WHERE (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201')  AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501')  AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')  UNION ALL SELECT 'Step 4' AS Step, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrWin) AS ActualWin, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrCoinin) AS CoinIn, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrJackpot) AS Jackpot, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrTheoWin) AS TheoWin, 'CRMDemo.dbo.BIS2_VW_Slot_Names' AS StepInfo FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo.dbo.BIS2_VW_Slot_Names ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo.dbo.BIS2_VW_Slot_Names.SiteID) WHERE (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201')  AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501')  AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')  UNION ALL SELECT 'Step 5' AS Step, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrWin) AS ActualWin, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrCoinin) AS CoinIn, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrJackpot) AS Jackpot, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrTheoWin) AS TheoWin, 'BIS2_SQLTC_DenomAvg' AS StepInfo FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo.dbo.BIS2_VW_Slot_Names ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo.dbo.BIS2_VW_Slot_Names.SiteID) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DenomAvg*/SELECT CRMDemo.dbo.BIS2_VW_Slot_Names.Denom AS Denom,CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID AS SiteID,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS DenomAvgTheoWin FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo.dbo.BIS2_VW_Slot_Names ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo.dbo.BIS2_VW_Slot_Names.SiteID) INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY CRMDemo.dbo.BIS2_VW_Slot_Names.Denom,CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID) AS BIS2_SQLTC_DenomAvg ON (CRMDemo.dbo.BIS2_VW_Slot_Names.SiteID = BIS2_SQLTC_DenomAvg.SiteID AND CRMDemo.dbo.BIS2_VW_Slot_Names.Denom = BIS2_SQLTC_DenomAvg.Denom) WHERE (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201')  AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501')  AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')  UNION ALL SELECT 'Step 6' AS Step, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrWin) AS ActualWin, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrCoinin) AS CoinIn, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrJackpot) AS Jackpot, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrTheoWin) AS TheoWin, 'BIS2_SQLTC_SectionAvg' AS StepInfo FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo.dbo.BIS2_VW_Slot_Names ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo.dbo.BIS2_VW_Slot_Names.SiteID) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DenomAvg*/SELECT CRMDemo.dbo.BIS2_VW_Slot_Names.Denom AS Denom,CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID AS SiteID,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS DenomAvgTheoWin FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo.dbo.BIS2_VW_Slot_Names ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo.dbo.BIS2_VW_Slot_Names.SiteID) INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY CRMDemo.dbo.BIS2_VW_Slot_Names.Denom,CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID) AS BIS2_SQLTC_DenomAvg ON (CRMDemo.dbo.BIS2_VW_Slot_Names.SiteID = BIS2_SQLTC_DenomAvg.SiteID AND CRMDemo.dbo.BIS2_VW_Slot_Names.Denom = BIS2_SQLTC_DenomAvg.Denom) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_SectionAvg*/SELECT CRMDemo.dbo.BIS2_V_Slot_Location_SCD.Section AS Section,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AS siteid,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS SectionAvgTheoWin FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) WHERE ((CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY CRMDemo.dbo.BIS2_V_Slot_Location_SCD.Section,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid) AS BIS2_SQLTC_SectionAvg ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = BIS2_SQLTC_SectionAvg.siteid AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.Section = BIS2_SQLTC_SectionAvg.Section) WHERE (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201')  AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501')  AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')  UNION ALL SELECT 'Step 7' AS Step, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrWin) AS ActualWin, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrCoinin) AS CoinIn, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrJackpot) AS Jackpot, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrTheoWin) AS TheoWin, 'BIS2_SQLTC_Occupancy' AS StepInfo FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo.dbo.BIS2_VW_Slot_Names ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo.dbo.BIS2_VW_Slot_Names.SiteID) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DenomAvg*/SELECT CRMDemo.dbo.BIS2_VW_Slot_Names.Denom AS Denom,CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID AS SiteID,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS DenomAvgTheoWin FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo.dbo.BIS2_VW_Slot_Names ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo.dbo.BIS2_VW_Slot_Names.SiteID) INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY CRMDemo.dbo.BIS2_VW_Slot_Names.Denom,CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID) AS BIS2_SQLTC_DenomAvg ON (CRMDemo.dbo.BIS2_VW_Slot_Names.SiteID = BIS2_SQLTC_DenomAvg.SiteID AND CRMDemo.dbo.BIS2_VW_Slot_Names.Denom = BIS2_SQLTC_DenomAvg.Denom) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_SectionAvg*/SELECT CRMDemo.dbo.BIS2_V_Slot_Location_SCD.Section AS Section,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AS siteid,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS SectionAvgTheoWin FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) WHERE ((CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY CRMDemo.dbo.BIS2_V_Slot_Location_SCD.Section,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid) AS BIS2_SQLTC_SectionAvg ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = BIS2_SQLTC_SectionAvg.siteid AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.Section = BIS2_SQLTC_SectionAvg.Section) INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_Occupancy*/SELECT BIS2_SQLTC_RatedMetrics.Mnum AS Mnum,BIS2_SQLTC_RatedMetrics.SiteID AS SiteID,BIS2_SQLTC_RatedMetrics.StandID AS StandID,BIS2_SQLTC_RatedMetrics.startdate AS startdate,BIS2_SQLTC_RatedMetrics.GamesPlayedPerMinute AS GamesPlayedPerMinute,CASE WHEN BIS2_SQLTC_RatedMetrics.GamesPlayedperHour/24.0 <> 0 THEN   100.0*BIS2_SQLTC_UnRatedMetrics.GamesPlayedperDay/BIS2_SQLTC_RatedMetrics.GamesPlayedperHour/24.0 ELSE 0 END AS Occupancy,BIS2_SQLTC_RatedMetrics.TheoWinperHour AS TheoWinperHour FROM (/* SqlTableCalculator: BIS2_SQLTC_RatedMetrics*/SELECT CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AS Mnum,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AS SiteID,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid AS StandID,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AS startdate,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0) <> 0 THEN  SUM(BIS2_VW_PlayerSession.Games)/(SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0)) ELSE 0 END AS GamesPlayedPerHour,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed/60.0) <> 0 THEN  SUM(BIS2_VW_PlayerSession.Games)/(SUM(BIS2_VW_PlayerSession.TimePlayed/60.0)) ELSE 0 END AS GamesPlayedPerMinute,COUNT(DISTINCT BIS2_VW_PlayerSession.PlayerID) AS PlayerCount,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed) <> 0 THEN SUM(BIS2_VW_PlayerSession.TheoWin) /   (SUM(BIS2_VW_PlayerSession.TimePlayed)/3600.00) ELSE 0 END AS TheoWinperHour FROM CRMDemo.dbo.BIS2_VW_PlayerSession INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PlayerSession.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PlayerSession.MNUM = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PlayerSession.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate) AS BIS2_SQLTC_RatedMetrics INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_UnratedMetrics*/SELECT CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AS Mnum,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AS SiteID,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid AS StandID,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AS startdate,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrGames)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS GamesPlayedperDay FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate) AS BIS2_SQLTC_UnratedMetrics ON (BIS2_SQLTC_RatedMetrics.SiteID = BIS2_SQLTC_UnratedMetrics.SiteID AND BIS2_SQLTC_RatedMetrics.Mnum = BIS2_SQLTC_UnratedMetrics.Mnum AND BIS2_SQLTC_RatedMetrics.StandID = BIS2_SQLTC_UnratedMetrics.StandID AND BIS2_SQLTC_RatedMetrics.startdate = BIS2_SQLTC_UnratedMetrics.startdate)) AS BIS2_SQLTC_Occupancy ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = BIS2_SQLTC_Occupancy.SiteID AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum = BIS2_SQLTC_Occupancy.Mnum AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid = BIS2_SQLTC_Occupancy.StandID AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate = BIS2_SQLTC_Occupancy.startdate) WHERE (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201')  AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501')  AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')  UNION ALL SELECT 'Step 8' AS Step, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrWin) AS ActualWin, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrCoinin) AS CoinIn, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrJackpot) AS Jackpot, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrTheoWin) AS TheoWin, 'BIS2_SQLTC_FloorAvg' AS StepInfo FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo.dbo.BIS2_VW_Slot_Names ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo.dbo.BIS2_VW_Slot_Names.SiteID) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DenomAvg*/SELECT CRMDemo.dbo.BIS2_VW_Slot_Names.Denom AS Denom,CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID AS SiteID,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS DenomAvgTheoWin FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo.dbo.BIS2_VW_Slot_Names ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo.dbo.BIS2_VW_Slot_Names.SiteID) INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY CRMDemo.dbo.BIS2_VW_Slot_Names.Denom,CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID) AS BIS2_SQLTC_DenomAvg ON (CRMDemo.dbo.BIS2_VW_Slot_Names.SiteID = BIS2_SQLTC_DenomAvg.SiteID AND CRMDemo.dbo.BIS2_VW_Slot_Names.Denom = BIS2_SQLTC_DenomAvg.Denom) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_SectionAvg*/SELECT CRMDemo.dbo.BIS2_V_Slot_Location_SCD.Section AS Section,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AS siteid,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS SectionAvgTheoWin FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) WHERE ((CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY CRMDemo.dbo.BIS2_V_Slot_Location_SCD.Section,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid) AS BIS2_SQLTC_SectionAvg ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = BIS2_SQLTC_SectionAvg.siteid AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.Section = BIS2_SQLTC_SectionAvg.Section) INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_Occupancy*/SELECT BIS2_SQLTC_RatedMetrics.Mnum AS Mnum,BIS2_SQLTC_RatedMetrics.SiteID AS SiteID,BIS2_SQLTC_RatedMetrics.StandID AS StandID,BIS2_SQLTC_RatedMetrics.startdate AS startdate,BIS2_SQLTC_RatedMetrics.GamesPlayedPerMinute AS GamesPlayedPerMinute,CASE WHEN BIS2_SQLTC_RatedMetrics.GamesPlayedperHour/24.0 <> 0 THEN   100.0*BIS2_SQLTC_UnRatedMetrics.GamesPlayedperDay/BIS2_SQLTC_RatedMetrics.GamesPlayedperHour/24.0 ELSE 0 END AS Occupancy,BIS2_SQLTC_RatedMetrics.TheoWinperHour AS TheoWinperHour FROM (/* SqlTableCalculator: BIS2_SQLTC_RatedMetrics*/SELECT CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AS Mnum,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AS SiteID,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid AS StandID,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AS startdate,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0) <> 0 THEN  SUM(BIS2_VW_PlayerSession.Games)/(SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0)) ELSE 0 END AS GamesPlayedPerHour,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed/60.0) <> 0 THEN  SUM(BIS2_VW_PlayerSession.Games)/(SUM(BIS2_VW_PlayerSession.TimePlayed/60.0)) ELSE 0 END AS GamesPlayedPerMinute,COUNT(DISTINCT BIS2_VW_PlayerSession.PlayerID) AS PlayerCount,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed) <> 0 THEN SUM(BIS2_VW_PlayerSession.TheoWin) /   (SUM(BIS2_VW_PlayerSession.TimePlayed)/3600.00) ELSE 0 END AS TheoWinperHour FROM CRMDemo.dbo.BIS2_VW_PlayerSession INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PlayerSession.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PlayerSession.MNUM = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PlayerSession.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate) AS BIS2_SQLTC_RatedMetrics INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_UnratedMetrics*/SELECT CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AS Mnum,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AS SiteID,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid AS StandID,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AS startdate,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrGames)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS GamesPlayedperDay FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate) AS BIS2_SQLTC_UnratedMetrics ON (BIS2_SQLTC_RatedMetrics.SiteID = BIS2_SQLTC_UnratedMetrics.SiteID AND BIS2_SQLTC_RatedMetrics.Mnum = BIS2_SQLTC_UnratedMetrics.Mnum AND BIS2_SQLTC_RatedMetrics.StandID = BIS2_SQLTC_UnratedMetrics.StandID AND BIS2_SQLTC_RatedMetrics.startdate = BIS2_SQLTC_UnratedMetrics.startdate)) AS BIS2_SQLTC_Occupancy ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = BIS2_SQLTC_Occupancy.SiteID AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum = BIS2_SQLTC_Occupancy.Mnum AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid = BIS2_SQLTC_Occupancy.StandID AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate = BIS2_SQLTC_Occupancy.startdate) INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_FloorAvg*/SELECT CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID AS SiteID,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS FloorAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS FloorAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS FloorAvgTheoWin FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID) AS BIS2_SQLTC_FloorAvg ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = BIS2_SQLTC_FloorAvg.SiteID WHERE (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201')  AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501')  AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')  UNION ALL SELECT 'Step 9' AS Step, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrWin) AS ActualWin, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrCoinin) AS CoinIn, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrJackpot) AS Jackpot, SUM(CRMDemo.dbo.BIS2_VW_PeriodDetail.MtrTheoWin) AS TheoWin, 'CRMDemo.dbo.BIS2_GEO_chairs' AS StepInfo FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo.dbo.BIS2_VW_Slot_Names ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo.dbo.BIS2_VW_Slot_Names.SiteID) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DenomAvg*/SELECT CRMDemo.dbo.BIS2_VW_Slot_Names.Denom AS Denom,CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID AS SiteID,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS DenomAvgTheoWin FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo.dbo.BIS2_VW_Slot_Names ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo.dbo.BIS2_VW_Slot_Names.SiteID) INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY CRMDemo.dbo.BIS2_VW_Slot_Names.Denom,CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID) AS BIS2_SQLTC_DenomAvg ON (CRMDemo.dbo.BIS2_VW_Slot_Names.SiteID = BIS2_SQLTC_DenomAvg.SiteID AND CRMDemo.dbo.BIS2_VW_Slot_Names.Denom = BIS2_SQLTC_DenomAvg.Denom) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_SectionAvg*/SELECT CRMDemo.dbo.BIS2_V_Slot_Location_SCD.Section AS Section,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AS siteid,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS SectionAvgTheoWin FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) WHERE ((CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY CRMDemo.dbo.BIS2_V_Slot_Location_SCD.Section,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid) AS BIS2_SQLTC_SectionAvg ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = BIS2_SQLTC_SectionAvg.siteid AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.Section = BIS2_SQLTC_SectionAvg.Section) INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_Occupancy*/SELECT BIS2_SQLTC_RatedMetrics.Mnum AS Mnum,BIS2_SQLTC_RatedMetrics.SiteID AS SiteID,BIS2_SQLTC_RatedMetrics.StandID AS StandID,BIS2_SQLTC_RatedMetrics.startdate AS startdate,BIS2_SQLTC_RatedMetrics.GamesPlayedPerMinute AS GamesPlayedPerMinute,CASE WHEN BIS2_SQLTC_RatedMetrics.GamesPlayedperHour/24.0 <> 0 THEN   100.0*BIS2_SQLTC_UnRatedMetrics.GamesPlayedperDay/BIS2_SQLTC_RatedMetrics.GamesPlayedperHour/24.0 ELSE 0 END AS Occupancy,BIS2_SQLTC_RatedMetrics.TheoWinperHour AS TheoWinperHour FROM (/* SqlTableCalculator: BIS2_SQLTC_RatedMetrics*/SELECT CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AS Mnum,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AS SiteID,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid AS StandID,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AS startdate,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0) <> 0 THEN  SUM(BIS2_VW_PlayerSession.Games)/(SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0)) ELSE 0 END AS GamesPlayedPerHour,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed/60.0) <> 0 THEN  SUM(BIS2_VW_PlayerSession.Games)/(SUM(BIS2_VW_PlayerSession.TimePlayed/60.0)) ELSE 0 END AS GamesPlayedPerMinute,COUNT(DISTINCT BIS2_VW_PlayerSession.PlayerID) AS PlayerCount,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed) <> 0 THEN SUM(BIS2_VW_PlayerSession.TheoWin) /   (SUM(BIS2_VW_PlayerSession.TimePlayed)/3600.00) ELSE 0 END AS TheoWinperHour FROM CRMDemo.dbo.BIS2_VW_PlayerSession INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PlayerSession.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PlayerSession.MNUM = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PlayerSession.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate) AS BIS2_SQLTC_RatedMetrics INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_UnratedMetrics*/SELECT CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AS Mnum,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AS SiteID,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid AS StandID,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AS startdate,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrGames)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS GamesPlayedperDay FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid,CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate) AS BIS2_SQLTC_UnratedMetrics ON (BIS2_SQLTC_RatedMetrics.SiteID = BIS2_SQLTC_UnratedMetrics.SiteID AND BIS2_SQLTC_RatedMetrics.Mnum = BIS2_SQLTC_UnratedMetrics.Mnum AND BIS2_SQLTC_RatedMetrics.StandID = BIS2_SQLTC_UnratedMetrics.StandID AND BIS2_SQLTC_RatedMetrics.startdate = BIS2_SQLTC_UnratedMetrics.startdate)) AS BIS2_SQLTC_Occupancy ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = BIS2_SQLTC_Occupancy.SiteID AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.mnum = BIS2_SQLTC_Occupancy.Mnum AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid = BIS2_SQLTC_Occupancy.StandID AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.startdate = BIS2_SQLTC_Occupancy.startdate) INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_FloorAvg*/SELECT CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID AS SiteID,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS FloorAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS FloorAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS FloorAvgTheoWin FROM CRMDemo.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo.dbo.BIS2_VW_Site ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB')) GROUP BY CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID) AS BIS2_SQLTC_FloorAvg ON CRMDemo.dbo.BIS2_VW_PeriodDetail.SiteID = BIS2_SQLTC_FloorAvg.SiteID INNER JOIN CRMDemo.dbo.BIS2_GEO_chairs ON (CRMDemo.dbo.BIS2_V_Slot_Location_SCD.standid = CRMDemo.dbo.BIS2_GEO_chairs.standid AND CRMDemo.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo.dbo.BIS2_GEO_chairs.casinoid) WHERE (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date >= '20130201')  AND (CRMDemo.dbo.BIS2_VW_PeriodDetail.Date < '20130501')  AND (CRMDemo.dbo.BIS2_VW_Site.SiteCode = 'IVB') 
2016-10-01 16:04:17.318758: Now attempting to run the query for 30846d1de-14cd49b8c49:
2016-10-01 16:04:17.334770: Attempting to connect to the database:
2016-10-01 16:04:21.523642: Database connection successful.
2016-10-01 16:04:40.767548: Query successfully run. Here are the results:
	[('Step 1', Decimal('13499086.20'), Decimal('195469637.02'), Decimal('3927304.31'), Decimal('15287616.767470'), 'CRMDemo.dbo.BIS2_VW_PeriodDetail'), ('Step 2', Decimal('9908042.75'), Decimal('139961868.26'), Decimal('2325298.57'), Decimal('11062230.334488'), 'CRMDemo.dbo.BIS2_VW_Site'), ('Step 2B', Decimal('3266250.71'), Decimal('46793996.85'), Decimal('869093.53'), Decimal('3731938.472171'), 'CRMDemo.dbo.BIS2_VW_Site (Restriction)'), ('Step 3', Decimal('3201268.46'), Decimal('46179940.00'), Decimal('879593.53'), Decimal('3672917.055309'), 'CRMDemo.dbo.BIS2_V_Slot_Location_SCD'), ('Step 4', Decimal('3201268.46'), Decimal('46179940.00'), Decimal('879593.53'), Decimal('3672917.055309'), 'CRMDemo.dbo.BIS2_VW_Slot_Names'), ('Step 5', Decimal('3201268.46'), Decimal('46179940.00'), Decimal('879593.53'), Decimal('3672917.055309'), 'BIS2_SQLTC_DenomAvg'), ('Step 6', Decimal('3201268.46'), Decimal('46179940.00'), Decimal('879593.53'), Decimal('3672917.055309'), 'BIS2_SQLTC_SectionAvg'), ('Step 7', Decimal('3201268.46'), Decimal('46179940.00'), Decimal('879593.53'), Decimal('3672917.055309'), 'BIS2_SQLTC_Occupancy'), ('Step 8', Decimal('3201268.46'), Decimal('46179940.00'), Decimal('879593.53'), Decimal('3672917.055309'), 'BIS2_SQLTC_FloorAvg'), ('Step 9', Decimal('3240438.12'), Decimal('46850249.74'), Decimal('883732.66'), Decimal('3724970.702525'), 'CRMDemo.dbo.BIS2_GEO_chairs')]
2016-10-01 16:04:40.780564: Attempting to create the excel sheet for 30846d1de-14cd49b8c49
2016-10-01 16:04:47.431730: Excel sheet for 30846d1de-14cd49b8c49 successful.