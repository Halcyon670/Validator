
2016-10-03 16:08:29.690103: Successfully purged prior log and started a new one.
2016-10-03 16:08:48.412139: Moving forward with the following docs: ['32a970f6e-14d6ebf9480', '318c6d3f5-15000fbfb14', '336ddaaf0-14b2cd789aa']
2016-10-03 16:08:48.511719: Checking 32a970f6e-14d6ebf9480 (Avg Monthly Visits vs Days Since Last Trip, AV_Q01):
	Query: SELECT CRMDemo.dbo.cqa.cell_index AS CellIndex,'Q' + substring(cqa.cell_index,1,1) AS QL1,'Q' + substring(cqa.cell_index,1,2) AS QL2,'Q' + substring(cqa.cell_index,1,3) AS QL3,'Q' + substring(cqa.cell_index,1,4) AS QL4,case when SUM(BIS2_VW_PlayerSession.coinin) <> 0 then (SUM(BIS2_VW_PlayerSession.win)/SUM(BIS2_VW_PlayerSession.coinin))*100.0 else 0 end AS ActualHold,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin,Case WHEN count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) <> 0 THEN  sum(BIS2_VW_PlayerSession.TheoWin)/count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) ELSE 0 END AS ADT,case when SUM(BIS2_VW_PlayerSession.Games)<>0 THEN SUM(BIS2_VW_PlayerSession.Coinin)/SUM(BIS2_VW_PlayerSession.Games) ELSE 0 END AS AvgBet,Sum(BIS2_VW_PlayerSession.TheoWin)/cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS AvgMonthlyTheo,cast(count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) as decimal(10,4))/cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS AvgMonthlyVisits,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.CoinIn) AS CoinIn,AVG(BIS2_SQLTC_PlayerSummary.DaysSinceLastTrip) AS DaysSinceLastTrip,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.FreePlay) AS Freeplay,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Games) AS GamesPlayed,SUM(BIS2_VW_PlayerSession.TimePlayed / 3600.0) AS HoursPlayed,CASE when count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar))<>0 THEN SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0)/count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) ELSE 0 END AS HoursPlayedPerVisit,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Jackpot) AS Jackpot,MAX(BIS2_SQLTC_PlayerSummary.AMV) AS MaxAMV,MAX(BIS2_SQLTC_PlayerSummary.DaysSinceLastTrip) AS MaxDaysSinceLastTrip,cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS MonthswithPlay,COUNT(DISTINCT BIS2_VW_PlayerSession.PlayerID) AS Player_Count,case when SUM(BIS2_VW_PlayerSession.coinin) <> 0 then (SUM(BIS2_VW_PlayerSession.theowin)/SUM(BIS2_VW_PlayerSession.coinin))*100.0 else 0 end AS TheoHold,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.TheoWin) AS TheoWin,count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) AS Visits,CASE WHEN COUNT(DISTINCT BIS2_VW_PlayerSession.PlayerID)<>0 THEN cast(count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) as decimal(10,2))/COUNT(DISTINCT BIS2_VW_PlayerSession.PlayerID) ELSE 0 END AS VisitsperPlayer FROM CRMDemo.dbo.BIS2_VW_PlayerSession INNER JOIN CRMDemo.dbo.cqa ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = CRMDemo.dbo.cqa.pk INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_PlayerSummary*/SELECT MAX(BIS2_VW_PlayerSession.GamingDate) AS LastDaywithPlay,CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID AS PlayerID,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin,CASE WHEN SUM(BIS2_VW_PlayerSession.TheoWin)<>0 THEN 100.0*SUM(BIS2_VW_PlayerSession.Win)/SUM(BIS2_VW_PlayerSession.TheoWin) ELSE 0 END AS ActualWinTheoWinRatio,Case WHEN count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) <> 0 THEN  sum(BIS2_VW_PlayerSession.TheoWin)/count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) ELSE 0 END AS ADT,Sum(BIS2_VW_PlayerSession.TheoWin)/cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS AMT,cast(count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) as decimal(10,4))/cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS AMV,datediff(dd,max(cast(BIS2_VW_PlayerSession.GamingDate as varchar)),MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,CASE WHEN SUM(BIS2_VW_PlayerSession.TheoWin)<>0 THEN (SUM(BIS2_VW_PlayerSession.Freeplay)*100.0)/SUM(BIS2_VW_PlayerSession.TheoWin) ELSE 0 END AS FreeplayReinvestmentPct,CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then  datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end AS MeanTimeBetweenTrips,CASE WHEN SUM(case when GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)<>0 THEN (100.0*(SUM(case when   GamingDate>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)-SUM(case when   GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)))/SUM(case when   GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END) ELSE 0 END AS PercentChangeTheoWin,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END) ELSE 0 END AS PercentChangeVisits,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.TheoWin) AS TheoWin,CASE WHEN CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then   datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end <>0 THEN  datediff(dd,  max(cast(BIS2_VW_PlayerSession.GamingDate as varchar)),  MAX(BIS2_FN_SGStartEndDate.SGEndDate))/CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then   datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end ELSE 0 END AS TripsOwed,case when cast(DATEDIFF(dd,max(BIS2_VW_PlayerSession.GamingDate),min(BIS2_VW_PlayerSession.GamingDate)) as decimal(15,2)) <> 0 then  (count(distinct BIS2_VW_PlayerSession.GamingDate)-1)/cast(DATEDIFF(dd,min(BIS2_VW_PlayerSession.GamingDate),max(dbo.BIS2_VW_PlayerSession.GamingDate)) as decimal(15,2))  ELSE 0 END AS VisitDensity,count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) AS Visits FROM CRMDemo.dbo.BIS2_VW_PlayerSession INNER HASH JOIN CRMDemo.dbo.BIS2_FN_SGStartEndDate('20130201 00:00:00','20130501 00:00:00') AS BIS2_FN_SGStartEndDate ON CRMDemo.dbo.BIS2_VW_PlayerSession.hackjoin = BIS2_FN_SGStartEndDate.HackJoin INNER JOIN CRMDemo.dbo.cqa ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = CRMDemo.dbo.cqa.pk WHERE ((CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') AND (CRMDemo.dbo.cqa.allocation_id = '32a975063-14d6ec23654')) GROUP BY CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID/* End: BIS2_SQLTC_PlayerSummary*/) AS BIS2_SQLTC_PlayerSummary ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = BIS2_SQLTC_PlayerSummary.PlayerID WHERE ((CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') AND (CRMDemo.dbo.cqa.allocation_id = '32a975063-14d6ec23654')) GROUP BY CRMDemo.dbo.cqa.cell_index,'Q' + substring(cqa.cell_index,1,1),'Q' + substring(cqa.cell_index,1,2),'Q' + substring(cqa.cell_index,1,3),'Q' + substring(cqa.cell_index,1,4)
	DocAggs: ['ActualHold', 'ActualWin', 'AvgBet', 'CoinIn', 'Freeplay', 'GamesPlayed', 'HoursPlayed', 'HoursPlayedPerVisit', 'Jackpot', 'Player_Count', 'TheoHold', 'TheoWin']
	DocAggDict: {'HoursPlayed': 'SUM(BIS2_VW_PlayerSession.TimePlayed / 3600.0) AS HoursPlayed', 'CoinIn': 'SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.CoinIn) AS CoinIn', 'AvgBet': 'SUM(BIS2_VW_PlayerSession.Games)<>0 THEN SUM(BIS2_VW_PlayerSession.Coinin)/SUM(BIS2_VW_PlayerSession.Games) ELSE 0 END AS AvgBet', 'TheoHold': 'SUM(BIS2_VW_PlayerSession.coinin) <> 0 then (SUM(BIS2_VW_PlayerSession.theowin)/SUM(BIS2_VW_PlayerSession.coinin))*100.0 else 0 end AS TheoHold', 'GamesPlayed': 'SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Games) AS GamesPlayed', 'Player_Count': 'COUNT(DISTINCT BIS2_VW_PlayerSession.PlayerID) AS Player_Count', 'ActualWin': 'SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin', 'ActualHold': 'SUM(BIS2_VW_PlayerSession.coinin) <> 0 then (SUM(BIS2_VW_PlayerSession.win)/SUM(BIS2_VW_PlayerSession.coinin))*100.0 else 0 end AS ActualHold', 'TheoWin': 'SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.TheoWin) AS TheoWin', 'Jackpot': 'SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Jackpot) AS Jackpot', 'HoursPlayedPerVisit': 'SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0)/count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) ELSE 0 END AS HoursPlayedPerVisit', 'Freeplay': 'SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.FreePlay) AS Freeplay'}
	DocJoins: ['CRMDemo.dbo.BIS2_VW_PlayerSession', 'BIS2_SQLTC_PlayerSummary', 'CRMDemo.dbo.cqa']DocJoinDict: {'BIS2_SQLTC_PlayerSummary': "INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_PlayerSummary*/SELECT MAX(BIS2_VW_PlayerSession.GamingDate) AS LastDaywithPlay,CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID AS PlayerID,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin,CASE WHEN SUM(BIS2_VW_PlayerSession.TheoWin)<>0 THEN 100.0*SUM(BIS2_VW_PlayerSession.Win)/SUM(BIS2_VW_PlayerSession.TheoWin) ELSE 0 END AS ActualWinTheoWinRatio,Case WHEN count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) <> 0 THEN  sum(BIS2_VW_PlayerSession.TheoWin)/count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) ELSE 0 END AS ADT,Sum(BIS2_VW_PlayerSession.TheoWin)/cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS AMT,cast(count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) as decimal(10,4))/cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS AMV,datediff(dd,max(cast(BIS2_VW_PlayerSession.GamingDate as varchar)),MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,CASE WHEN SUM(BIS2_VW_PlayerSession.TheoWin)<>0 THEN (SUM(BIS2_VW_PlayerSession.Freeplay)*100.0)/SUM(BIS2_VW_PlayerSession.TheoWin) ELSE 0 END AS FreeplayReinvestmentPct,CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then  datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end AS MeanTimeBetweenTrips,CASE WHEN SUM(case when GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)<>0 THEN (100.0*(SUM(case when   GamingDate>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)-SUM(case when   GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)))/SUM(case when   GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END) ELSE 0 END AS PercentChangeTheoWin,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END) ELSE 0 END AS PercentChangeVisits,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.TheoWin) AS TheoWin,CASE WHEN CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then   datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end <>0 THEN  datediff(dd,  max(cast(BIS2_VW_PlayerSession.GamingDate as varchar)),  MAX(BIS2_FN_SGStartEndDate.SGEndDate))/CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then   datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end ELSE 0 END AS TripsOwed,case when cast(DATEDIFF(dd,max(BIS2_VW_PlayerSession.GamingDate),min(BIS2_VW_PlayerSession.GamingDate)) as decimal(15,2)) <> 0 then  (count(distinct BIS2_VW_PlayerSession.GamingDate)-1)/cast(DATEDIFF(dd,min(BIS2_VW_PlayerSession.GamingDate),max(dbo.BIS2_VW_PlayerSession.GamingDate)) as decimal(15,2))  ELSE 0 END AS VisitDensity,count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) AS Visits FROM CRMDemo.dbo.BIS2_VW_PlayerSession INNER HASH JOIN CRMDemo.dbo.BIS2_FN_SGStartEndDate('20130201 00:00:00','20130501 00:00:00') AS BIS2_FN_SGStartEndDate ON CRMDemo.dbo.BIS2_VW_PlayerSession.hackjoin = BIS2_FN_SGStartEndDate.HackJoin INNER JOIN CRMDemo.dbo.cqa ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = CRMDemo.dbo.cqa.pk WHERE ((CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') AND (CRMDemo.dbo.cqa.allocation_id = '32a975063-14d6ec23654')) GROUP BY CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID/* End: BIS2_SQLTC_PlayerSummary*/) AS BIS2_SQLTC_PlayerSummary ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = BIS2_SQLTC_PlayerSummary.PlayerID ", 'CRMDemo.dbo.cqa': 'INNER JOIN CRMDemo.dbo.cqa ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = CRMDemo.dbo.cqa.pk ', 'CRMDemo.dbo.BIS2_VW_PlayerSession': 'FROM CRMDemo.dbo.BIS2_VW_PlayerSession '}
	DocWhere: ["(CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') ", "(CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') ", "(CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') ", "(CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') ", "(CRMDemo.dbo.cqa.allocation_id = '32a975063-14d6ec23654')"]
	DocWhereAnd: {"(CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') ": 'AND ', "(CRMDemo.dbo.cqa.allocation_id = '32a975063-14d6ec23654')": 'AND ', "(CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') ": 'start', "(CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') ": 'AND ', "(CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') ": 'AND '}
2016-10-03 16:08:55.757409: Final data about 32a970f6e-14d6ebf9480:
	UserAggList: ['ActualWin', 'CoinIn', 'Jackpot', 'TheoWin']
	UserRestrictList: []
	FinalQuery: SELECT 'Step 1' AS Step, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.CoinIn) AS CoinIn, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Jackpot) AS Jackpot, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.TheoWin) AS TheoWin, 'CRMDemo.dbo.BIS2_VW_PlayerSession' AS StepInfo FROM CRMDemo.dbo.BIS2_VW_PlayerSession WHERE (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502')  UNION ALL SELECT 'Step 2' AS Step, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.CoinIn) AS CoinIn, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Jackpot) AS Jackpot, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.TheoWin) AS TheoWin, 'BIS2_SQLTC_PlayerSummary' AS StepInfo FROM CRMDemo.dbo.BIS2_VW_PlayerSession INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_PlayerSummary*/SELECT MAX(BIS2_VW_PlayerSession.GamingDate) AS LastDaywithPlay,CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID AS PlayerID,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin,CASE WHEN SUM(BIS2_VW_PlayerSession.TheoWin)<>0 THEN 100.0*SUM(BIS2_VW_PlayerSession.Win)/SUM(BIS2_VW_PlayerSession.TheoWin) ELSE 0 END AS ActualWinTheoWinRatio,Case WHEN count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) <> 0 THEN  sum(BIS2_VW_PlayerSession.TheoWin)/count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) ELSE 0 END AS ADT,Sum(BIS2_VW_PlayerSession.TheoWin)/cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS AMT,cast(count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) as decimal(10,4))/cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS AMV,datediff(dd,max(cast(BIS2_VW_PlayerSession.GamingDate as varchar)),MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,CASE WHEN SUM(BIS2_VW_PlayerSession.TheoWin)<>0 THEN (SUM(BIS2_VW_PlayerSession.Freeplay)*100.0)/SUM(BIS2_VW_PlayerSession.TheoWin) ELSE 0 END AS FreeplayReinvestmentPct,CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then  datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end AS MeanTimeBetweenTrips,CASE WHEN SUM(case when GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)<>0 THEN (100.0*(SUM(case when   GamingDate>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)-SUM(case when   GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)))/SUM(case when   GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END) ELSE 0 END AS PercentChangeTheoWin,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END) ELSE 0 END AS PercentChangeVisits,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.TheoWin) AS TheoWin,CASE WHEN CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then   datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end <>0 THEN  datediff(dd,  max(cast(BIS2_VW_PlayerSession.GamingDate as varchar)),  MAX(BIS2_FN_SGStartEndDate.SGEndDate))/CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then   datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end ELSE 0 END AS TripsOwed,case when cast(DATEDIFF(dd,max(BIS2_VW_PlayerSession.GamingDate),min(BIS2_VW_PlayerSession.GamingDate)) as decimal(15,2)) <> 0 then  (count(distinct BIS2_VW_PlayerSession.GamingDate)-1)/cast(DATEDIFF(dd,min(BIS2_VW_PlayerSession.GamingDate),max(dbo.BIS2_VW_PlayerSession.GamingDate)) as decimal(15,2))  ELSE 0 END AS VisitDensity,count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) AS Visits FROM CRMDemo.dbo.BIS2_VW_PlayerSession INNER HASH JOIN CRMDemo.dbo.BIS2_FN_SGStartEndDate('20130201 00:00:00','20130501 00:00:00') AS BIS2_FN_SGStartEndDate ON CRMDemo.dbo.BIS2_VW_PlayerSession.hackjoin = BIS2_FN_SGStartEndDate.HackJoin INNER JOIN CRMDemo.dbo.cqa ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = CRMDemo.dbo.cqa.pk WHERE ((CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') AND (CRMDemo.dbo.cqa.allocation_id = '32a975063-14d6ec23654')) GROUP BY CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID/* End: BIS2_SQLTC_PlayerSummary*/) AS BIS2_SQLTC_PlayerSummary ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = BIS2_SQLTC_PlayerSummary.PlayerID WHERE (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502')  UNION ALL SELECT 'Step 3' AS Step, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.CoinIn) AS CoinIn, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Jackpot) AS Jackpot, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.TheoWin) AS TheoWin, 'CRMDemo.dbo.cqa' AS StepInfo FROM CRMDemo.dbo.BIS2_VW_PlayerSession INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_PlayerSummary*/SELECT MAX(BIS2_VW_PlayerSession.GamingDate) AS LastDaywithPlay,CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID AS PlayerID,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin,CASE WHEN SUM(BIS2_VW_PlayerSession.TheoWin)<>0 THEN 100.0*SUM(BIS2_VW_PlayerSession.Win)/SUM(BIS2_VW_PlayerSession.TheoWin) ELSE 0 END AS ActualWinTheoWinRatio,Case WHEN count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) <> 0 THEN  sum(BIS2_VW_PlayerSession.TheoWin)/count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) ELSE 0 END AS ADT,Sum(BIS2_VW_PlayerSession.TheoWin)/cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS AMT,cast(count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) as decimal(10,4))/cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS AMV,datediff(dd,max(cast(BIS2_VW_PlayerSession.GamingDate as varchar)),MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,CASE WHEN SUM(BIS2_VW_PlayerSession.TheoWin)<>0 THEN (SUM(BIS2_VW_PlayerSession.Freeplay)*100.0)/SUM(BIS2_VW_PlayerSession.TheoWin) ELSE 0 END AS FreeplayReinvestmentPct,CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then  datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end AS MeanTimeBetweenTrips,CASE WHEN SUM(case when GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)<>0 THEN (100.0*(SUM(case when   GamingDate>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)-SUM(case when   GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)))/SUM(case when   GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END) ELSE 0 END AS PercentChangeTheoWin,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END) ELSE 0 END AS PercentChangeVisits,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.TheoWin) AS TheoWin,CASE WHEN CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then   datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end <>0 THEN  datediff(dd,  max(cast(BIS2_VW_PlayerSession.GamingDate as varchar)),  MAX(BIS2_FN_SGStartEndDate.SGEndDate))/CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then   datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end ELSE 0 END AS TripsOwed,case when cast(DATEDIFF(dd,max(BIS2_VW_PlayerSession.GamingDate),min(BIS2_VW_PlayerSession.GamingDate)) as decimal(15,2)) <> 0 then  (count(distinct BIS2_VW_PlayerSession.GamingDate)-1)/cast(DATEDIFF(dd,min(BIS2_VW_PlayerSession.GamingDate),max(dbo.BIS2_VW_PlayerSession.GamingDate)) as decimal(15,2))  ELSE 0 END AS VisitDensity,count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) AS Visits FROM CRMDemo.dbo.BIS2_VW_PlayerSession INNER HASH JOIN CRMDemo.dbo.BIS2_FN_SGStartEndDate('20130201 00:00:00','20130501 00:00:00') AS BIS2_FN_SGStartEndDate ON CRMDemo.dbo.BIS2_VW_PlayerSession.hackjoin = BIS2_FN_SGStartEndDate.HackJoin INNER JOIN CRMDemo.dbo.cqa ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = CRMDemo.dbo.cqa.pk WHERE ((CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') AND (CRMDemo.dbo.cqa.allocation_id = '32a975063-14d6ec23654')) GROUP BY CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID/* End: BIS2_SQLTC_PlayerSummary*/) AS BIS2_SQLTC_PlayerSummary ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = BIS2_SQLTC_PlayerSummary.PlayerID INNER JOIN CRMDemo.dbo.cqa ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = CRMDemo.dbo.cqa.pk WHERE (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502')  AND (CRMDemo.dbo.cqa.allocation_id = '32a975063-14d6ec23654')
2016-10-03 16:08:55.968557: Checking 318c6d3f5-15000fbfb14 (WVB All Play Theo Win per Day, FV_I01 - TEST):
	Query: SELECT VBB2__Aggregates.Bank AS Bank,VBB2__Aggregates.CabinetType AS CabinetType,VBB2__Aggregates.Denom AS Denom,VBB2__Aggregates.DisplayType AS DisplayType,VBB2__Aggregates.GameType AS GameType,VBB2__Aggregates.Location AS Location,VBB2__Aggregates.Manufacturer AS Manufacturer,VBB2__Aggregates.Mnum AS Mnum,VBB2__Aggregates.Paylines AS Paylines,VBB2__Aggregates.Reels AS Reels,VBB2__Aggregates.Section AS Section,VBB2__Aggregates.Theme AS Theme,VBB2__Spatials.Latitude AS Latitude,VBB2__Spatials.Longitude AS Longitude,VBB2__Aggregates.Chairs_Standid AS Chairs_Standid,VBB2__Aggregates.Chairs_Standid_SCD_Start AS Chairs_Standid_SCD_Start,VBB2__Aggregates.Chairs_Standid_SCD_End AS Chairs_Standid_SCD_End,VBB2__Aggregates.Chairs_Standid_SCD_History AS Chairs_Standid_SCD_History,VBB2__Aggregates.Chairs_Standid_SCD_Changed AS Chairs_Standid_SCD_Changed,VBB2__Aggregates.Slot_StandID AS Slot_StandID,VBB2__Aggregates.Slot_StandID_SCD_Start AS Slot_StandID_SCD_Start,VBB2__Aggregates.Slot_StandID_SCD_End AS Slot_StandID_SCD_End,VBB2__Aggregates.Slot_StandID_SCD_History AS Slot_StandID_SCD_History,VBB2__Aggregates.Slot_StandID_SCD_Changed AS Slot_StandID_SCD_Changed,VBB2__Aggregates.ActualHold AS ActualHold,VBB2__Aggregates.ActualWin AS ActualWin,VBB2__Aggregates.ActualWinperDay AS ActualWinperDay,VBB2__Aggregates.AvgBet AS AvgBet,VBB2__Aggregates.CoinIn AS CoinIn,VBB2__Aggregates.CoinInperDay AS CoinInperDay,VBB2__Aggregates.DaysonFloor AS DaysonFloor,VBB2__Aggregates.Freeplay AS Freeplay,VBB2__Aggregates.FreeplayperDay AS FreeplayperDay,VBB2__Aggregates.GamesPlayed AS GamesPlayed,VBB2__Aggregates.GamesPlayedperDay AS GamesPlayedperDay,VBB2__Aggregates.GamesPlayedPerMinute AS GamesPlayedPerMinute,VBB2__Aggregates.HoldVariance AS HoldVariance,VBB2__Aggregates.Jackpot AS Jackpot,VBB2__Aggregates.MachineCount AS MachineCount,VBB2__Aggregates.Occupancy AS Occupancy,VBB2__Aggregates.PctofDenomAvgActualWin AS PctofDenomAvgActualWin,VBB2__Aggregates.PctofDenomAvgCoinIn AS PctofDenomAvgCoinIn,VBB2__Aggregates.PctofDenomAvgTheoWin AS PctofDenomAvgTheoWin,VBB2__Aggregates.PctofFloorAvgActualWin AS PctofFloorAvgActualWin,VBB2__Aggregates.PctofFloorAvgCoinIn AS PctofFloorAvgCoinIn,VBB2__Aggregates.PctofFloorAvgTheoWin AS PctofFloorAvgTheoWin,VBB2__Aggregates.PctofSectionAvgActualWin AS PctofSectionAvgActualWin,VBB2__Aggregates.PctofSectionAvgCoinIn AS PctofSectionAvgCoinIn,VBB2__Aggregates.PctofSectionAvgTheoWin AS PctofSectionAvgTheoWin,VBB2__Aggregates.TheoHold AS TheoHold,VBB2__Aggregates.TheoWin AS TheoWin,VBB2__Aggregates.TheoWinperDay AS TheoWinperDay,VBB2__Aggregates.TheoWinperHour AS TheoWinperHour FROM (SELECT CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Bank AS Bank,CRMDemo_US.dbo.BIS2_VW_Slot_Names.CabinetType AS CabinetType,CRMDemo_US.dbo.BIS2_GEO_chairs.ogc_fid AS VBB2__kf_Chairs_ogc,CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom AS Denom,CRMDemo_US.dbo.BIS2_VW_Slot_Names.Cabinet AS DisplayType,CRMDemo_US.dbo.BIS2_VW_Slot_Names.GameType AS GameType,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Location AS Location,CRMDemo_US.dbo.BIS2_VW_Slot_Names.MFR AS Manufacturer,CRMDemo_US.dbo.BIS2_VW_Slot_Names.mnum AS Mnum,CRMDemo_US.dbo.BIS2_VW_Slot_Names.Paylines AS Paylines,CRMDemo_US.dbo.BIS2_VW_Slot_Names.Reels AS Reels,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Section AS Section,CRMDemo_US.dbo.BIS2_VW_Slot_Names.Description AS Theme,CRMDemo_US.dbo.BIS2_GEO_chairs.standid AS Chairs_Standid,CRMDemo_US.dbo.BIS2_GEO_chairs.startgd AS Chairs_Standid_SCD_Start,CRMDemo_US.dbo.BIS2_GEO_chairs.endgd AS Chairs_Standid_SCD_End,CRMDemo_US.dbo.BIS2_GEO_chairs.version AS Chairs_Standid_SCD_Version,CASE WHEN(datepart(year,CRMDemo_US.dbo.BIS2_GEO_chairs.startgd)*10000+datepart(mm,CRMDemo_US.dbo.BIS2_GEO_chairs.startgd)*100+datepart(dd,CRMDemo_US.dbo.BIS2_GEO_chairs.startgd))-(datepart(year,'20130501')*10000+datepart(mm,'20130501')*100+datepart(dd,'20130501'))<0 AND (datepart(year,'20130501')*10000+datepart(mm,'20130501')*100+datepart(dd,'20130501'))-(datepart(year,CRMDemo_US.dbo.BIS2_GEO_chairs.endgd)*10000+datepart(mm,CRMDemo_US.dbo.BIS2_GEO_chairs.endgd)*100+datepart(dd,CRMDemo_US.dbo.BIS2_GEO_chairs.endgd))<=0 THEN 0 ELSE 1 END AS Chairs_Standid_SCD_History,CASE WHEN((CRMDemo_US.dbo.BIS2_GEO_chairs.startgd < '20130501' AND CRMDemo_US.dbo.BIS2_GEO_chairs.startgd >= '20130201') OR (CRMDemo_US.dbo.BIS2_GEO_chairs.endgd < '20130501' AND CRMDemo_US.dbo.BIS2_GEO_chairs.endgd >= '20130201'))THEN 1 ELSE 0 END AS Chairs_Standid_SCD_Changed,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid AS Slot_StandID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AS Slot_StandID_SCD_Start,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate AS Slot_StandID_SCD_End,CASE WHEN(datepart(year,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate)*10000+datepart(mm,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate)*100+datepart(dd,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate))-(datepart(year,'20130501')*10000+datepart(mm,'20130501')*100+datepart(dd,'20130501'))<0 AND (datepart(year,'20130501')*10000+datepart(mm,'20130501')*100+datepart(dd,'20130501'))-(datepart(year,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate)*10000+datepart(mm,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate)*100+datepart(dd,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate))<=0 THEN 0 ELSE 1 END AS Slot_StandID_SCD_History,CASE WHEN((CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate < '20130501' AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate >= '20130201') OR (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate < '20130501' AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate >= '20130201'))THEN 1 ELSE 0 END AS Slot_StandID_SCD_Changed,case when sum(BIS2_VW_PeriodDetail.MtrCoinIn)<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)*100.0/sum(BIS2_VW_PeriodDetail.MtrCoinIn) ELSE 0 END AS ActualHold,SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrWin) AS ActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS ActualWinperDay,case when sum(BIS2_VW_PeriodDetail.MtrGames) <> 0 then sum(BIS2_VW_PeriodDetail.MtrCoinin)/sum(BIS2_VW_PeriodDetail.MtrGames) else 0 end AS AvgBet,SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrCoinin) AS CoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS CoinInperDay,count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) AS DaysonFloor,SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrBonus) AS Freeplay,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrBonus)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS FreeplayperDay,SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrGames) AS GamesPlayed,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrGames)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS GamesPlayedperDay,MAX(BIS2_SQLTC_Occupancy.GamesPlayedPerMinute) AS GamesPlayedPerMinute,case when sum(BIS2_VW_PeriodDetail.MtrCoinIn)<>0 then (sum(BIS2_VW_PeriodDetail.MtrWin)-sum(BIS2_VW_PeriodDetail.MtrTheoWin))*100.0/sum(BIS2_VW_PeriodDetail.MtrCoinIn) ELSE 0 END AS HoldVariance,SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrJackpot) AS Jackpot,COUNT(DISTINCT BIS2_VW_PeriodDetail.StandID) AS MachineCount,MAX(BIS2_SQLTC_Occupancy.Occupancy) AS Occupancy,CASE WHEN MAX(BIS2_SQLTC_DenomAvg.DenomAvgActualWIn)<>0 then case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( BIS2_VW_PeriodDetail.date as varchar)) else 0 END /   MAX(BIS2_SQLTC_DenomAvg.DenomAvgActualWin) ELSE 0 END *100.0 AS PctofDenomAvgActualWin,CASE WHEN MAX(BIS2_SQLTC_DenomAvg.DenomAvgCoinIn)<>0 then case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END /   MAX(BIS2_SQLTC_DenomAvg.DenomAvgCoinIn) ELSE 0 END *100.0 AS PctofDenomAvgCoinIn,CASE WHEN MAX(BIS2_SQLTC_DenomAvg.DenomAvgTheoWin)<>0 then case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast(BIS2_VW_PeriodDetail.date as varchar))else 0 END /   MAX(BIS2_SQLTC_DenomAvg.DenomAvgTheoWin) ELSE 0 END *100.0 AS PctofDenomAvgTheoWin,CASE WHEN MAX(BIS2_SQLTC_FloorAvg.FloorAvgActualWIn)<>0 then case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( BIS2_VW_PeriodDetail.Date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( BIS2_VW_PeriodDetail.Date as varchar)) else 0 END / MAX(BIS2_SQLTC_FloorAvg.FloorAvgActualWin) ELSE 0 END *100.0 AS PctofFloorAvgActualWin,CASE WHEN MAX(BIS2_SQLTC_FloorAvg.FloorAvgCoinIn)<>0 then case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast(BIS2_VW_PeriodDetail.date as varchar))else 0 END / MAX(BIS2_SQLTC_FloorAvg.FloorAvgCoinIn) ELSE 0 END *100.0 AS PctofFloorAvgCoinIn,CASE WHEN MAX(BIS2_SQLTC_FloorAvg.FloorAvgTheoWin)<>0 then case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( BIS2_VW_PeriodDetail.Date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( BIS2_VW_PeriodDetail.Date as varchar)) else 0 END / MAX(BIS2_SQLTC_FloorAvg.FloorAvgTheoWIn) ELSE 0 END *100.0 AS PctofFloorAvgTheoWin,CASE WHEN MAX(BIS2_SQLTC_SectionAvg.SectionAvgActualWIn)<>0 then case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( BIS2_VW_PeriodDetail.Date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast(BIS2_VW_PeriodDetail.Date as varchar)) else 0 END / MAX(BIS2_SQLTC_SectionAvg.SectionAvgActualWin) ELSE 0 END *100.0 AS PctofSectionAvgActualWin,CASE WHEN MAX(BIS2_SQLTC_SectionAvg.SectionAvgCoinIn)<>0 then case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( BIS2_VW_PeriodDetail.Date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( BIS2_VW_PeriodDetail.Date as varchar)) else 0 END / MAX(BIS2_SQLTC_SectionAvg.SectionAvgCoinIn) ELSE 0 END *100.0 AS PctofSectionAvgCoinIn,CASE WHEN MAX(BIS2_SQLTC_SectionAvg.SectionAvgTheoWin)<>0 then case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( BIS2_VW_PeriodDetail.Date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( BIS2_VW_PeriodDetail.Date as varchar)) else 0 END / MAX(BIS2_SQLTC_SectionAvg.SectionAvgTheoWin) ELSE 0 END *100.0 AS PctofSectionAvgTheoWin,case when sum(BIS2_VW_PeriodDetail.MtrCoinIn)<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)*100.0/sum(BIS2_VW_PeriodDetail.MtrCoinIn) ELSE 0 END AS TheoHold,SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrTheoWin) AS TheoWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS TheoWinperDay,MAX(BIS2_SQLTC_Occupancy.TheoWinPerHour) AS TheoWinperHour FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo_US.dbo.BIS2_GEO_chairs ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid = CRMDemo_US.dbo.BIS2_GEO_chairs.standid AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_GEO_chairs.casinoid) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Slot_Names ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo_US.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DenomAvg*/SELECT CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom AS Denom,CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID AS SiteID,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS DenomAvgTheoWin FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Slot_Names ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo_US.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom,CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID/* End: BIS2_SQLTC_DenomAvg*/) AS BIS2_SQLTC_DenomAvg ON (CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID = BIS2_SQLTC_DenomAvg.SiteID AND CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom = BIS2_SQLTC_DenomAvg.Denom) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_SectionAvg*/SELECT CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Section AS Section,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AS siteid,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS SectionAvgTheoWin FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Section,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid/* End: BIS2_SQLTC_SectionAvg*/) AS BIS2_SQLTC_SectionAvg ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = BIS2_SQLTC_SectionAvg.siteid AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Section = BIS2_SQLTC_SectionAvg.Section) INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_Occupancy*/SELECT BIS2_SQLTC_RatedMetrics.Mnum AS Mnum,BIS2_SQLTC_UnratedMetrics.Mnum_Location AS Mnum_Location,BIS2_SQLTC_RatedMetrics.SiteID AS SiteID,BIS2_SQLTC_RatedMetrics.StandID AS StandID,BIS2_SQLTC_RatedMetrics.startdate AS startdate,BIS2_SQLTC_RatedMetrics.GamesPlayedPerMinute AS GamesPlayedPerMinute,CASE WHEN BIS2_SQLTC_RatedMetrics.GamesPlayedperHour/24.0 <> 0 THEN   100.0*BIS2_SQLTC_UnRatedMetrics.GamesPlayedperDay/BIS2_SQLTC_RatedMetrics.GamesPlayedperHour/24.0 ELSE 0 END AS Occupancy,BIS2_SQLTC_RatedMetrics.TheoWinperHour AS TheoWinperHour FROM (/* SqlTableCalculator: BIS2_SQLTC_RatedMetrics*/SELECT CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AS Mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AS SiteID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid AS StandID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AS startdate,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0) <> 0 THEN  SUM(BIS2_VW_PlayerSession.Games)/(SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0)) ELSE 0 END AS GamesPlayedPerHour,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed/60.0) <> 0 THEN  SUM(BIS2_VW_PlayerSession.Games)/(SUM(BIS2_VW_PlayerSession.TimePlayed/60.0)) ELSE 0 END AS GamesPlayedPerMinute,COUNT(DISTINCT BIS2_VW_PlayerSession.PlayerID) AS PlayerCount,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed) <> 0 THEN SUM(BIS2_VW_PlayerSession.TheoWin) /   (SUM(BIS2_VW_PlayerSession.TimePlayed)/3600.00) ELSE 0 END AS TheoWinperHour FROM CRMDemo_US.dbo.BIS2_VW_PlayerSession INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PlayerSession.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PlayerSession.MNUM = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PlayerSession.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') AND (CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') AND (CRMDemo_US.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') AND (CRMDemo_US.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate/* End: BIS2_SQLTC_RatedMetrics*/) AS BIS2_SQLTC_RatedMetrics INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_UnratedMetrics*/SELECT CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AS Mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Mnum_Location AS Mnum_Location,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AS SiteID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid AS StandID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AS startdate,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrGames)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS GamesPlayedperDay FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Mnum_Location,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate/* End: BIS2_SQLTC_UnratedMetrics*/) AS BIS2_SQLTC_UnratedMetrics ON (BIS2_SQLTC_RatedMetrics.SiteID = BIS2_SQLTC_UnratedMetrics.SiteID AND BIS2_SQLTC_RatedMetrics.Mnum = BIS2_SQLTC_UnratedMetrics.Mnum AND BIS2_SQLTC_RatedMetrics.StandID = BIS2_SQLTC_UnratedMetrics.StandID AND BIS2_SQLTC_RatedMetrics.startdate = BIS2_SQLTC_UnratedMetrics.startdate)/* End: BIS2_SQLTC_Occupancy*/) AS BIS2_SQLTC_Occupancy ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = BIS2_SQLTC_Occupancy.SiteID AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum = BIS2_SQLTC_Occupancy.Mnum AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid = BIS2_SQLTC_Occupancy.StandID AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate = BIS2_SQLTC_Occupancy.startdate) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_FloorAvg*/SELECT CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID AS SiteID,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS FloorAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS FloorAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS FloorAvgTheoWin FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID/* End: BIS2_SQLTC_FloorAvg*/) AS BIS2_SQLTC_FloorAvg ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = BIS2_SQLTC_FloorAvg.SiteID WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_GEO_chairs.startgd) AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_GEO_chairs.endgd) AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate) AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate)) GROUP BY CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Bank,CRMDemo_US.dbo.BIS2_VW_Slot_Names.CabinetType,CRMDemo_US.dbo.BIS2_GEO_chairs.ogc_fid,CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom,CRMDemo_US.dbo.BIS2_VW_Slot_Names.Cabinet,CRMDemo_US.dbo.BIS2_VW_Slot_Names.GameType,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Location,CRMDemo_US.dbo.BIS2_VW_Slot_Names.MFR,CRMDemo_US.dbo.BIS2_VW_Slot_Names.mnum,CRMDemo_US.dbo.BIS2_VW_Slot_Names.Paylines,CRMDemo_US.dbo.BIS2_VW_Slot_Names.Reels,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Section,CRMDemo_US.dbo.BIS2_VW_Slot_Names.Description,CRMDemo_US.dbo.BIS2_GEO_chairs.standid,CRMDemo_US.dbo.BIS2_GEO_chairs.startgd,CRMDemo_US.dbo.BIS2_GEO_chairs.endgd,CRMDemo_US.dbo.BIS2_GEO_chairs.version,CASE WHEN(datepart(year,CRMDemo_US.dbo.BIS2_GEO_chairs.startgd)*10000+datepart(mm,CRMDemo_US.dbo.BIS2_GEO_chairs.startgd)*100+datepart(dd,CRMDemo_US.dbo.BIS2_GEO_chairs.startgd))-(datepart(year,'20130501')*10000+datepart(mm,'20130501')*100+datepart(dd,'20130501'))<0 AND (datepart(year,'20130501')*10000+datepart(mm,'20130501')*100+datepart(dd,'20130501'))-(datepart(year,CRMDemo_US.dbo.BIS2_GEO_chairs.endgd)*10000+datepart(mm,CRMDemo_US.dbo.BIS2_GEO_chairs.endgd)*100+datepart(dd,CRMDemo_US.dbo.BIS2_GEO_chairs.endgd))<=0 THEN 0 ELSE 1 END,CASE WHEN((CRMDemo_US.dbo.BIS2_GEO_chairs.startgd < '20130501' AND CRMDemo_US.dbo.BIS2_GEO_chairs.startgd >= '20130201') OR (CRMDemo_US.dbo.BIS2_GEO_chairs.endgd < '20130501' AND CRMDemo_US.dbo.BIS2_GEO_chairs.endgd >= '20130201'))THEN 1 ELSE 0 END,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate,CASE WHEN(datepart(year,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate)*10000+datepart(mm,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate)*100+datepart(dd,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate))-(datepart(year,'20130501')*10000+datepart(mm,'20130501')*100+datepart(dd,'20130501'))<0 AND (datepart(year,'20130501')*10000+datepart(mm,'20130501')*100+datepart(dd,'20130501'))-(datepart(year,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate)*10000+datepart(mm,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate)*100+datepart(dd,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate))<=0 THEN 0 ELSE 1 END,CASE WHEN((CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate < '20130501' AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate >= '20130201') OR (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate < '20130501' AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate >= '20130201'))THEN 1 ELSE 0 END) AS VBB2__Aggregates INNER JOIN (SELECT CRMDemo_US.dbo.BIS2_GEO_chairs.ogc_fid AS VBB2__kf_Chairs_ogc,CRMDemo_US.dbo.BIS2_GEO_chairs.wkt_geo AS Latitude,CRMDemo_US.dbo.BIS2_GEO_chairs.wkt_geo AS Longitude FROM CRMDemo_US.dbo.BIS2_GEO_chairs) AS VBB2__Spatials ON VBB2__Aggregates.VBB2__kf_Chairs_ogc = VBB2__Spatials.VBB2__kf_Chairs_ogc ORDER BY Chairs_Standid,Chairs_Standid_SCD_History,Chairs_Standid_SCD_Start DESC,Slot_StandID,Slot_StandID_SCD_History,Slot_StandID_SCD_Start DESC
	DocAggs: ['ActualWin', 'CoinIn', 'Freeplay', 'GamesPlayed', 'Jackpot', 'MachineCount', 'TheoWin']
	DocAggDict: {'ActualWin': 'SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrWin) AS ActualWin', 'CoinIn': 'SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrCoinin) AS CoinIn', 'MachineCount': 'COUNT(DISTINCT BIS2_VW_PeriodDetail.StandID) AS MachineCount', 'Jackpot': 'SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrJackpot) AS Jackpot', 'TheoWin': 'SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrTheoWin) AS TheoWin', 'GamesPlayed': 'SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrGames) AS GamesPlayed', 'Freeplay': 'SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrBonus) AS Freeplay'}
	DocJoins: ['CRMDemo_US.dbo.BIS2_VW_PeriodDetail', 'CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD', 'CRMDemo_US.dbo.BIS2_GEO_chairs', 'CRMDemo_US.dbo.BIS2_VW_Slot_Names', 'BIS2_SQLTC_DenomAvg', 'BIS2_SQLTC_SectionAvg', 'BIS2_SQLTC_Occupancy', 'CRMDemo_US.dbo.BIS2_VW_Site', 'BIS2_SQLTC_FloorAvg']DocJoinDict: {'CRMDemo_US.dbo.BIS2_VW_PeriodDetail': 'FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail ', 'BIS2_SQLTC_DenomAvg': "INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DenomAvg*/SELECT CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom AS Denom,CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID AS SiteID,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS DenomAvgTheoWin FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Slot_Names ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo_US.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom,CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID/* End: BIS2_SQLTC_DenomAvg*/) AS BIS2_SQLTC_DenomAvg ON (CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID = BIS2_SQLTC_DenomAvg.SiteID AND CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom = BIS2_SQLTC_DenomAvg.Denom) ", 'CRMDemo_US.dbo.BIS2_VW_Site': 'INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID ', 'BIS2_SQLTC_SectionAvg': "INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_SectionAvg*/SELECT CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Section AS Section,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AS siteid,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS SectionAvgTheoWin FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Section,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid/* End: BIS2_SQLTC_SectionAvg*/) AS BIS2_SQLTC_SectionAvg ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = BIS2_SQLTC_SectionAvg.siteid AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Section = BIS2_SQLTC_SectionAvg.Section) ", 'BIS2_SQLTC_Occupancy': "INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_Occupancy*/SELECT BIS2_SQLTC_RatedMetrics.Mnum AS Mnum,BIS2_SQLTC_UnratedMetrics.Mnum_Location AS Mnum_Location,BIS2_SQLTC_RatedMetrics.SiteID AS SiteID,BIS2_SQLTC_RatedMetrics.StandID AS StandID,BIS2_SQLTC_RatedMetrics.startdate AS startdate,BIS2_SQLTC_RatedMetrics.GamesPlayedPerMinute AS GamesPlayedPerMinute,CASE WHEN BIS2_SQLTC_RatedMetrics.GamesPlayedperHour/24.0 <> 0 THEN   100.0*BIS2_SQLTC_UnRatedMetrics.GamesPlayedperDay/BIS2_SQLTC_RatedMetrics.GamesPlayedperHour/24.0 ELSE 0 END AS Occupancy,BIS2_SQLTC_RatedMetrics.TheoWinperHour AS TheoWinperHour FROM (/* SqlTableCalculator: BIS2_SQLTC_RatedMetrics*/SELECT CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AS Mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AS SiteID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid AS StandID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AS startdate,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0) <> 0 THEN  SUM(BIS2_VW_PlayerSession.Games)/(SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0)) ELSE 0 END AS GamesPlayedPerHour,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed/60.0) <> 0 THEN  SUM(BIS2_VW_PlayerSession.Games)/(SUM(BIS2_VW_PlayerSession.TimePlayed/60.0)) ELSE 0 END AS GamesPlayedPerMinute,COUNT(DISTINCT BIS2_VW_PlayerSession.PlayerID) AS PlayerCount,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed) <> 0 THEN SUM(BIS2_VW_PlayerSession.TheoWin) /   (SUM(BIS2_VW_PlayerSession.TimePlayed)/3600.00) ELSE 0 END AS TheoWinperHour FROM CRMDemo_US.dbo.BIS2_VW_PlayerSession INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PlayerSession.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PlayerSession.MNUM = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PlayerSession.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') AND (CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') AND (CRMDemo_US.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') AND (CRMDemo_US.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate/* End: BIS2_SQLTC_RatedMetrics*/) AS BIS2_SQLTC_RatedMetrics INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_UnratedMetrics*/SELECT CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AS Mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Mnum_Location AS Mnum_Location,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AS SiteID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid AS StandID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AS startdate,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrGames)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS GamesPlayedperDay FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Mnum_Location,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate/* End: BIS2_SQLTC_UnratedMetrics*/) AS BIS2_SQLTC_UnratedMetrics ON (BIS2_SQLTC_RatedMetrics.SiteID = BIS2_SQLTC_UnratedMetrics.SiteID AND BIS2_SQLTC_RatedMetrics.Mnum = BIS2_SQLTC_UnratedMetrics.Mnum AND BIS2_SQLTC_RatedMetrics.StandID = BIS2_SQLTC_UnratedMetrics.StandID AND BIS2_SQLTC_RatedMetrics.startdate = BIS2_SQLTC_UnratedMetrics.startdate)/* End: BIS2_SQLTC_Occupancy*/) AS BIS2_SQLTC_Occupancy ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = BIS2_SQLTC_Occupancy.SiteID AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum = BIS2_SQLTC_Occupancy.Mnum AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid = BIS2_SQLTC_Occupancy.StandID AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate = BIS2_SQLTC_Occupancy.startdate) ", 'CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD': 'INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) ', 'CRMDemo_US.dbo.BIS2_VW_Slot_Names': 'INNER JOIN CRMDemo_US.dbo.BIS2_VW_Slot_Names ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo_US.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID) ', 'BIS2_SQLTC_FloorAvg': "INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_FloorAvg*/SELECT CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID AS SiteID,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS FloorAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS FloorAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS FloorAvgTheoWin FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID/* End: BIS2_SQLTC_FloorAvg*/) AS BIS2_SQLTC_FloorAvg ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = BIS2_SQLTC_FloorAvg.SiteID ", 'CRMDemo_US.dbo.BIS2_GEO_chairs': 'INNER JOIN CRMDemo_US.dbo.BIS2_GEO_chairs ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid = CRMDemo_US.dbo.BIS2_GEO_chairs.standid AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_GEO_chairs.casinoid) '}
	DocWhere: ["(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') ", "(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') ", "(CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB') ", '(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_GEO_chairs.startgd) ', '(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_GEO_chairs.endgd) ', '(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate) ', '(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate)']
	DocWhereAnd: {"(CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB') ": 'AND ', '(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate)': 'AND ', '(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate) ': 'AND ', '(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_GEO_chairs.startgd) ': 'AND ', '(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_GEO_chairs.endgd) ': 'AND ', "(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') ": 'start', "(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') ": 'AND '}
2016-10-03 16:09:04.769502: Final data about 318c6d3f5-15000fbfb14:
	UserAggList: ['ActualWin', 'CoinIn', 'Freeplay', 'Jackpot', 'TheoWin']
	UserRestrictList: ["(CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB') "]
	FinalQuery: SELECT 'Step 1' AS Step, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrWin) AS ActualWin, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrCoinin) AS CoinIn, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrBonus) AS Freeplay, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrJackpot) AS Jackpot, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrTheoWin) AS TheoWin, 'CRMDemo_US.dbo.BIS2_VW_PeriodDetail' AS StepInfo FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail WHERE (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201')  AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501')  UNION ALL SELECT 'Step 2' AS Step, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrWin) AS ActualWin, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrCoinin) AS CoinIn, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrBonus) AS Freeplay, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrJackpot) AS Jackpot, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrTheoWin) AS TheoWin, 'CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD' AS StepInfo FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) WHERE (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201')  AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501')  UNION ALL SELECT 'Step 3' AS Step, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrWin) AS ActualWin, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrCoinin) AS CoinIn, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrBonus) AS Freeplay, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrJackpot) AS Jackpot, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrTheoWin) AS TheoWin, 'CRMDemo_US.dbo.BIS2_GEO_chairs' AS StepInfo FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo_US.dbo.BIS2_GEO_chairs ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid = CRMDemo_US.dbo.BIS2_GEO_chairs.standid AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_GEO_chairs.casinoid) WHERE (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201')  AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501')  UNION ALL SELECT 'Step 4' AS Step, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrWin) AS ActualWin, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrCoinin) AS CoinIn, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrBonus) AS Freeplay, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrJackpot) AS Jackpot, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrTheoWin) AS TheoWin, 'CRMDemo_US.dbo.BIS2_VW_Slot_Names' AS StepInfo FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo_US.dbo.BIS2_GEO_chairs ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid = CRMDemo_US.dbo.BIS2_GEO_chairs.standid AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_GEO_chairs.casinoid) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Slot_Names ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo_US.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID) WHERE (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201')  AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501')  UNION ALL SELECT 'Step 5' AS Step, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrWin) AS ActualWin, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrCoinin) AS CoinIn, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrBonus) AS Freeplay, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrJackpot) AS Jackpot, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrTheoWin) AS TheoWin, 'BIS2_SQLTC_DenomAvg' AS StepInfo FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo_US.dbo.BIS2_GEO_chairs ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid = CRMDemo_US.dbo.BIS2_GEO_chairs.standid AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_GEO_chairs.casinoid) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Slot_Names ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo_US.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DenomAvg*/SELECT CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom AS Denom,CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID AS SiteID,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS DenomAvgTheoWin FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Slot_Names ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo_US.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom,CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID/* End: BIS2_SQLTC_DenomAvg*/) AS BIS2_SQLTC_DenomAvg ON (CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID = BIS2_SQLTC_DenomAvg.SiteID AND CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom = BIS2_SQLTC_DenomAvg.Denom) WHERE (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201')  AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501')  UNION ALL SELECT 'Step 6' AS Step, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrWin) AS ActualWin, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrCoinin) AS CoinIn, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrBonus) AS Freeplay, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrJackpot) AS Jackpot, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrTheoWin) AS TheoWin, 'BIS2_SQLTC_SectionAvg' AS StepInfo FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo_US.dbo.BIS2_GEO_chairs ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid = CRMDemo_US.dbo.BIS2_GEO_chairs.standid AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_GEO_chairs.casinoid) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Slot_Names ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo_US.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DenomAvg*/SELECT CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom AS Denom,CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID AS SiteID,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS DenomAvgTheoWin FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Slot_Names ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo_US.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom,CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID/* End: BIS2_SQLTC_DenomAvg*/) AS BIS2_SQLTC_DenomAvg ON (CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID = BIS2_SQLTC_DenomAvg.SiteID AND CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom = BIS2_SQLTC_DenomAvg.Denom) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_SectionAvg*/SELECT CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Section AS Section,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AS siteid,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS SectionAvgTheoWin FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Section,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid/* End: BIS2_SQLTC_SectionAvg*/) AS BIS2_SQLTC_SectionAvg ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = BIS2_SQLTC_SectionAvg.siteid AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Section = BIS2_SQLTC_SectionAvg.Section) WHERE (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201')  AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501')  UNION ALL SELECT 'Step 7' AS Step, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrWin) AS ActualWin, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrCoinin) AS CoinIn, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrBonus) AS Freeplay, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrJackpot) AS Jackpot, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrTheoWin) AS TheoWin, 'BIS2_SQLTC_Occupancy' AS StepInfo FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo_US.dbo.BIS2_GEO_chairs ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid = CRMDemo_US.dbo.BIS2_GEO_chairs.standid AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_GEO_chairs.casinoid) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Slot_Names ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo_US.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DenomAvg*/SELECT CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom AS Denom,CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID AS SiteID,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS DenomAvgTheoWin FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Slot_Names ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo_US.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom,CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID/* End: BIS2_SQLTC_DenomAvg*/) AS BIS2_SQLTC_DenomAvg ON (CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID = BIS2_SQLTC_DenomAvg.SiteID AND CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom = BIS2_SQLTC_DenomAvg.Denom) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_SectionAvg*/SELECT CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Section AS Section,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AS siteid,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS SectionAvgTheoWin FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Section,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid/* End: BIS2_SQLTC_SectionAvg*/) AS BIS2_SQLTC_SectionAvg ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = BIS2_SQLTC_SectionAvg.siteid AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Section = BIS2_SQLTC_SectionAvg.Section) INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_Occupancy*/SELECT BIS2_SQLTC_RatedMetrics.Mnum AS Mnum,BIS2_SQLTC_UnratedMetrics.Mnum_Location AS Mnum_Location,BIS2_SQLTC_RatedMetrics.SiteID AS SiteID,BIS2_SQLTC_RatedMetrics.StandID AS StandID,BIS2_SQLTC_RatedMetrics.startdate AS startdate,BIS2_SQLTC_RatedMetrics.GamesPlayedPerMinute AS GamesPlayedPerMinute,CASE WHEN BIS2_SQLTC_RatedMetrics.GamesPlayedperHour/24.0 <> 0 THEN   100.0*BIS2_SQLTC_UnRatedMetrics.GamesPlayedperDay/BIS2_SQLTC_RatedMetrics.GamesPlayedperHour/24.0 ELSE 0 END AS Occupancy,BIS2_SQLTC_RatedMetrics.TheoWinperHour AS TheoWinperHour FROM (/* SqlTableCalculator: BIS2_SQLTC_RatedMetrics*/SELECT CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AS Mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AS SiteID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid AS StandID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AS startdate,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0) <> 0 THEN  SUM(BIS2_VW_PlayerSession.Games)/(SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0)) ELSE 0 END AS GamesPlayedPerHour,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed/60.0) <> 0 THEN  SUM(BIS2_VW_PlayerSession.Games)/(SUM(BIS2_VW_PlayerSession.TimePlayed/60.0)) ELSE 0 END AS GamesPlayedPerMinute,COUNT(DISTINCT BIS2_VW_PlayerSession.PlayerID) AS PlayerCount,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed) <> 0 THEN SUM(BIS2_VW_PlayerSession.TheoWin) /   (SUM(BIS2_VW_PlayerSession.TimePlayed)/3600.00) ELSE 0 END AS TheoWinperHour FROM CRMDemo_US.dbo.BIS2_VW_PlayerSession INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PlayerSession.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PlayerSession.MNUM = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PlayerSession.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') AND (CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') AND (CRMDemo_US.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') AND (CRMDemo_US.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate/* End: BIS2_SQLTC_RatedMetrics*/) AS BIS2_SQLTC_RatedMetrics INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_UnratedMetrics*/SELECT CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AS Mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Mnum_Location AS Mnum_Location,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AS SiteID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid AS StandID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AS startdate,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrGames)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS GamesPlayedperDay FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Mnum_Location,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate/* End: BIS2_SQLTC_UnratedMetrics*/) AS BIS2_SQLTC_UnratedMetrics ON (BIS2_SQLTC_RatedMetrics.SiteID = BIS2_SQLTC_UnratedMetrics.SiteID AND BIS2_SQLTC_RatedMetrics.Mnum = BIS2_SQLTC_UnratedMetrics.Mnum AND BIS2_SQLTC_RatedMetrics.StandID = BIS2_SQLTC_UnratedMetrics.StandID AND BIS2_SQLTC_RatedMetrics.startdate = BIS2_SQLTC_UnratedMetrics.startdate)/* End: BIS2_SQLTC_Occupancy*/) AS BIS2_SQLTC_Occupancy ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = BIS2_SQLTC_Occupancy.SiteID AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum = BIS2_SQLTC_Occupancy.Mnum AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid = BIS2_SQLTC_Occupancy.StandID AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate = BIS2_SQLTC_Occupancy.startdate) WHERE (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201')  AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501')  UNION ALL SELECT 'Step 8' AS Step, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrWin) AS ActualWin, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrCoinin) AS CoinIn, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrBonus) AS Freeplay, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrJackpot) AS Jackpot, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrTheoWin) AS TheoWin, 'CRMDemo_US.dbo.BIS2_VW_Site' AS StepInfo FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo_US.dbo.BIS2_GEO_chairs ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid = CRMDemo_US.dbo.BIS2_GEO_chairs.standid AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_GEO_chairs.casinoid) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Slot_Names ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo_US.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DenomAvg*/SELECT CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom AS Denom,CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID AS SiteID,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS DenomAvgTheoWin FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Slot_Names ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo_US.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom,CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID/* End: BIS2_SQLTC_DenomAvg*/) AS BIS2_SQLTC_DenomAvg ON (CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID = BIS2_SQLTC_DenomAvg.SiteID AND CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom = BIS2_SQLTC_DenomAvg.Denom) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_SectionAvg*/SELECT CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Section AS Section,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AS siteid,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS SectionAvgTheoWin FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Section,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid/* End: BIS2_SQLTC_SectionAvg*/) AS BIS2_SQLTC_SectionAvg ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = BIS2_SQLTC_SectionAvg.siteid AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Section = BIS2_SQLTC_SectionAvg.Section) INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_Occupancy*/SELECT BIS2_SQLTC_RatedMetrics.Mnum AS Mnum,BIS2_SQLTC_UnratedMetrics.Mnum_Location AS Mnum_Location,BIS2_SQLTC_RatedMetrics.SiteID AS SiteID,BIS2_SQLTC_RatedMetrics.StandID AS StandID,BIS2_SQLTC_RatedMetrics.startdate AS startdate,BIS2_SQLTC_RatedMetrics.GamesPlayedPerMinute AS GamesPlayedPerMinute,CASE WHEN BIS2_SQLTC_RatedMetrics.GamesPlayedperHour/24.0 <> 0 THEN   100.0*BIS2_SQLTC_UnRatedMetrics.GamesPlayedperDay/BIS2_SQLTC_RatedMetrics.GamesPlayedperHour/24.0 ELSE 0 END AS Occupancy,BIS2_SQLTC_RatedMetrics.TheoWinperHour AS TheoWinperHour FROM (/* SqlTableCalculator: BIS2_SQLTC_RatedMetrics*/SELECT CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AS Mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AS SiteID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid AS StandID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AS startdate,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0) <> 0 THEN  SUM(BIS2_VW_PlayerSession.Games)/(SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0)) ELSE 0 END AS GamesPlayedPerHour,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed/60.0) <> 0 THEN  SUM(BIS2_VW_PlayerSession.Games)/(SUM(BIS2_VW_PlayerSession.TimePlayed/60.0)) ELSE 0 END AS GamesPlayedPerMinute,COUNT(DISTINCT BIS2_VW_PlayerSession.PlayerID) AS PlayerCount,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed) <> 0 THEN SUM(BIS2_VW_PlayerSession.TheoWin) /   (SUM(BIS2_VW_PlayerSession.TimePlayed)/3600.00) ELSE 0 END AS TheoWinperHour FROM CRMDemo_US.dbo.BIS2_VW_PlayerSession INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PlayerSession.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PlayerSession.MNUM = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PlayerSession.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') AND (CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') AND (CRMDemo_US.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') AND (CRMDemo_US.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate/* End: BIS2_SQLTC_RatedMetrics*/) AS BIS2_SQLTC_RatedMetrics INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_UnratedMetrics*/SELECT CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AS Mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Mnum_Location AS Mnum_Location,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AS SiteID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid AS StandID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AS startdate,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrGames)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS GamesPlayedperDay FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Mnum_Location,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate/* End: BIS2_SQLTC_UnratedMetrics*/) AS BIS2_SQLTC_UnratedMetrics ON (BIS2_SQLTC_RatedMetrics.SiteID = BIS2_SQLTC_UnratedMetrics.SiteID AND BIS2_SQLTC_RatedMetrics.Mnum = BIS2_SQLTC_UnratedMetrics.Mnum AND BIS2_SQLTC_RatedMetrics.StandID = BIS2_SQLTC_UnratedMetrics.StandID AND BIS2_SQLTC_RatedMetrics.startdate = BIS2_SQLTC_UnratedMetrics.startdate)/* End: BIS2_SQLTC_Occupancy*/) AS BIS2_SQLTC_Occupancy ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = BIS2_SQLTC_Occupancy.SiteID AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum = BIS2_SQLTC_Occupancy.Mnum AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid = BIS2_SQLTC_Occupancy.StandID AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate = BIS2_SQLTC_Occupancy.startdate) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID WHERE (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201')  AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501')  UNION ALL SELECT 'Step 8B' AS Step, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrWin) AS ActualWin, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrCoinin) AS CoinIn, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrBonus) AS Freeplay, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrJackpot) AS Jackpot, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrTheoWin) AS TheoWin, 'CRMDemo_US.dbo.BIS2_VW_Site (Restriction)' AS StepInfo FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo_US.dbo.BIS2_GEO_chairs ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid = CRMDemo_US.dbo.BIS2_GEO_chairs.standid AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_GEO_chairs.casinoid) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Slot_Names ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo_US.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DenomAvg*/SELECT CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom AS Denom,CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID AS SiteID,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS DenomAvgTheoWin FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Slot_Names ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo_US.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom,CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID/* End: BIS2_SQLTC_DenomAvg*/) AS BIS2_SQLTC_DenomAvg ON (CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID = BIS2_SQLTC_DenomAvg.SiteID AND CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom = BIS2_SQLTC_DenomAvg.Denom) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_SectionAvg*/SELECT CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Section AS Section,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AS siteid,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS SectionAvgTheoWin FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Section,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid/* End: BIS2_SQLTC_SectionAvg*/) AS BIS2_SQLTC_SectionAvg ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = BIS2_SQLTC_SectionAvg.siteid AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Section = BIS2_SQLTC_SectionAvg.Section) INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_Occupancy*/SELECT BIS2_SQLTC_RatedMetrics.Mnum AS Mnum,BIS2_SQLTC_UnratedMetrics.Mnum_Location AS Mnum_Location,BIS2_SQLTC_RatedMetrics.SiteID AS SiteID,BIS2_SQLTC_RatedMetrics.StandID AS StandID,BIS2_SQLTC_RatedMetrics.startdate AS startdate,BIS2_SQLTC_RatedMetrics.GamesPlayedPerMinute AS GamesPlayedPerMinute,CASE WHEN BIS2_SQLTC_RatedMetrics.GamesPlayedperHour/24.0 <> 0 THEN   100.0*BIS2_SQLTC_UnRatedMetrics.GamesPlayedperDay/BIS2_SQLTC_RatedMetrics.GamesPlayedperHour/24.0 ELSE 0 END AS Occupancy,BIS2_SQLTC_RatedMetrics.TheoWinperHour AS TheoWinperHour FROM (/* SqlTableCalculator: BIS2_SQLTC_RatedMetrics*/SELECT CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AS Mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AS SiteID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid AS StandID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AS startdate,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0) <> 0 THEN  SUM(BIS2_VW_PlayerSession.Games)/(SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0)) ELSE 0 END AS GamesPlayedPerHour,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed/60.0) <> 0 THEN  SUM(BIS2_VW_PlayerSession.Games)/(SUM(BIS2_VW_PlayerSession.TimePlayed/60.0)) ELSE 0 END AS GamesPlayedPerMinute,COUNT(DISTINCT BIS2_VW_PlayerSession.PlayerID) AS PlayerCount,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed) <> 0 THEN SUM(BIS2_VW_PlayerSession.TheoWin) /   (SUM(BIS2_VW_PlayerSession.TimePlayed)/3600.00) ELSE 0 END AS TheoWinperHour FROM CRMDemo_US.dbo.BIS2_VW_PlayerSession INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PlayerSession.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PlayerSession.MNUM = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PlayerSession.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') AND (CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') AND (CRMDemo_US.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') AND (CRMDemo_US.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate/* End: BIS2_SQLTC_RatedMetrics*/) AS BIS2_SQLTC_RatedMetrics INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_UnratedMetrics*/SELECT CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AS Mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Mnum_Location AS Mnum_Location,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AS SiteID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid AS StandID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AS startdate,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrGames)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS GamesPlayedperDay FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Mnum_Location,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate/* End: BIS2_SQLTC_UnratedMetrics*/) AS BIS2_SQLTC_UnratedMetrics ON (BIS2_SQLTC_RatedMetrics.SiteID = BIS2_SQLTC_UnratedMetrics.SiteID AND BIS2_SQLTC_RatedMetrics.Mnum = BIS2_SQLTC_UnratedMetrics.Mnum AND BIS2_SQLTC_RatedMetrics.StandID = BIS2_SQLTC_UnratedMetrics.StandID AND BIS2_SQLTC_RatedMetrics.startdate = BIS2_SQLTC_UnratedMetrics.startdate)/* End: BIS2_SQLTC_Occupancy*/) AS BIS2_SQLTC_Occupancy ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = BIS2_SQLTC_Occupancy.SiteID AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum = BIS2_SQLTC_Occupancy.Mnum AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid = BIS2_SQLTC_Occupancy.StandID AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate = BIS2_SQLTC_Occupancy.startdate) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID WHERE (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201')  AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501')  AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')  UNION ALL SELECT 'Step 9' AS Step, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrWin) AS ActualWin, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrCoinin) AS CoinIn, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrBonus) AS Freeplay, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrJackpot) AS Jackpot, SUM(CRMDemo_US.dbo.BIS2_VW_PeriodDetail.MtrTheoWin) AS TheoWin, 'BIS2_SQLTC_FloorAvg' AS StepInfo FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo_US.dbo.BIS2_GEO_chairs ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid = CRMDemo_US.dbo.BIS2_GEO_chairs.standid AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_GEO_chairs.casinoid) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Slot_Names ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo_US.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DenomAvg*/SELECT CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom AS Denom,CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID AS SiteID,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS DenomAvgTheoWin FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Slot_Names ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo_US.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom,CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID/* End: BIS2_SQLTC_DenomAvg*/) AS BIS2_SQLTC_DenomAvg ON (CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID = BIS2_SQLTC_DenomAvg.SiteID AND CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom = BIS2_SQLTC_DenomAvg.Denom) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_SectionAvg*/SELECT CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Section AS Section,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AS siteid,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS SectionAvgTheoWin FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Section,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid/* End: BIS2_SQLTC_SectionAvg*/) AS BIS2_SQLTC_SectionAvg ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = BIS2_SQLTC_SectionAvg.siteid AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Section = BIS2_SQLTC_SectionAvg.Section) INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_Occupancy*/SELECT BIS2_SQLTC_RatedMetrics.Mnum AS Mnum,BIS2_SQLTC_UnratedMetrics.Mnum_Location AS Mnum_Location,BIS2_SQLTC_RatedMetrics.SiteID AS SiteID,BIS2_SQLTC_RatedMetrics.StandID AS StandID,BIS2_SQLTC_RatedMetrics.startdate AS startdate,BIS2_SQLTC_RatedMetrics.GamesPlayedPerMinute AS GamesPlayedPerMinute,CASE WHEN BIS2_SQLTC_RatedMetrics.GamesPlayedperHour/24.0 <> 0 THEN   100.0*BIS2_SQLTC_UnRatedMetrics.GamesPlayedperDay/BIS2_SQLTC_RatedMetrics.GamesPlayedperHour/24.0 ELSE 0 END AS Occupancy,BIS2_SQLTC_RatedMetrics.TheoWinperHour AS TheoWinperHour FROM (/* SqlTableCalculator: BIS2_SQLTC_RatedMetrics*/SELECT CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AS Mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AS SiteID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid AS StandID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AS startdate,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0) <> 0 THEN  SUM(BIS2_VW_PlayerSession.Games)/(SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0)) ELSE 0 END AS GamesPlayedPerHour,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed/60.0) <> 0 THEN  SUM(BIS2_VW_PlayerSession.Games)/(SUM(BIS2_VW_PlayerSession.TimePlayed/60.0)) ELSE 0 END AS GamesPlayedPerMinute,COUNT(DISTINCT BIS2_VW_PlayerSession.PlayerID) AS PlayerCount,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed) <> 0 THEN SUM(BIS2_VW_PlayerSession.TheoWin) /   (SUM(BIS2_VW_PlayerSession.TimePlayed)/3600.00) ELSE 0 END AS TheoWinperHour FROM CRMDemo_US.dbo.BIS2_VW_PlayerSession INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PlayerSession.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PlayerSession.MNUM = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PlayerSession.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') AND (CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') AND (CRMDemo_US.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') AND (CRMDemo_US.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate/* End: BIS2_SQLTC_RatedMetrics*/) AS BIS2_SQLTC_RatedMetrics INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_UnratedMetrics*/SELECT CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AS Mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Mnum_Location AS Mnum_Location,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AS SiteID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid AS StandID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AS startdate,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrGames)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS GamesPlayedperDay FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Mnum_Location,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate/* End: BIS2_SQLTC_UnratedMetrics*/) AS BIS2_SQLTC_UnratedMetrics ON (BIS2_SQLTC_RatedMetrics.SiteID = BIS2_SQLTC_UnratedMetrics.SiteID AND BIS2_SQLTC_RatedMetrics.Mnum = BIS2_SQLTC_UnratedMetrics.Mnum AND BIS2_SQLTC_RatedMetrics.StandID = BIS2_SQLTC_UnratedMetrics.StandID AND BIS2_SQLTC_RatedMetrics.startdate = BIS2_SQLTC_UnratedMetrics.startdate)/* End: BIS2_SQLTC_Occupancy*/) AS BIS2_SQLTC_Occupancy ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = BIS2_SQLTC_Occupancy.SiteID AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum = BIS2_SQLTC_Occupancy.Mnum AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid = BIS2_SQLTC_Occupancy.StandID AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate = BIS2_SQLTC_Occupancy.startdate) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_FloorAvg*/SELECT CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID AS SiteID,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS FloorAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS FloorAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS FloorAvgTheoWin FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB')) GROUP BY CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID/* End: BIS2_SQLTC_FloorAvg*/) AS BIS2_SQLTC_FloorAvg ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = BIS2_SQLTC_FloorAvg.SiteID WHERE (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201')  AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501')  AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteCode = 'WVB') 
2016-10-03 16:09:04.813530: Checking 336ddaaf0-14b2cd789aa (Segments by Week Dashboard, AV_D06):
	Query: SELECT BIS2_FN_SegmentsByWeek.ADTAMTGroup AS ADTAMTGroup,BIS2_FN_SegmentsByWeek.AMVGroup AS AMVGroup,BIS2_FN_SegmentsByWeek.EndofWeek AS EndofWeek,BIS2_FN_SegmentsByWeek.WeekEndDateType AS WeekEndDateType,SUM(BIS2_FN_SegmentsByWeek.ActualWin) AS ActualWin,SUM(BIS2_FN_SegmentsByWeek.AvgDailyTheoWinNetFreeplay) AS AvgDailyTheoWinNetFreeplay,SUM(BIS2_FN_SegmentsByWeek.Freeplay) AS Freeplay,SUM(BIS2_FN_SegmentsByWeek.FreeplayPercentageofTheoWinNetFreeplay) AS FreeplayPercentageofTheoWinNetFreeplay,SUM(BIS2_FN_SegmentsByWeek.PlayerCount) AS PlayerCount,SUM(BIS2_FN_SegmentsByWeek.TheoWin) AS TheoWin,SUM(BIS2_FN_SegmentsbyWeek.TheoWin-BIS2_FN_SegmentsbyWeek.Freeplay) AS TheoWinNetFreeplay,SUM(BIS2_FN_SegmentsByWeek.Visits) AS Visits,SUM(BIS2_FN_SegmentsByWeek.VisitsperPlayer) AS VisitsperPlayer FROM CRMDemo.dbo.BIS2_FN_SegmentsByWeek('20120801 00:00:00','20130801 00:00:00') AS BIS2_FN_SegmentsByWeek GROUP BY BIS2_FN_SegmentsByWeek.ADTAMTGroup,BIS2_FN_SegmentsByWeek.AMVGroup,BIS2_FN_SegmentsByWeek.EndofWeek,BIS2_FN_SegmentsByWeek.WeekEndDateType
	DocAggs: ['ActualWin', 'AvgDailyTheoWinNetFreeplay', 'Freeplay', 'FreeplayPercentageofTheoWinNetFreeplay', 'PlayerCount', 'TheoWin', 'TheoWinNetFreeplay', 'Visits']
	DocAggDict: {'ActualWin': 'SUM(BIS2_FN_SegmentsByWeek.ActualWin) AS ActualWin', 'Visits': 'SUM(BIS2_FN_SegmentsByWeek.Visits) AS Visits', 'AvgDailyTheoWinNetFreeplay': 'SUM(BIS2_FN_SegmentsByWeek.AvgDailyTheoWinNetFreeplay) AS AvgDailyTheoWinNetFreeplay', 'TheoWinNetFreeplay': 'SUM(BIS2_FN_SegmentsbyWeek.TheoWin-BIS2_FN_SegmentsbyWeek.Freeplay) AS TheoWinNetFreeplay', 'TheoWin': 'SUM(BIS2_FN_SegmentsByWeek.TheoWin) AS TheoWin', 'FreeplayPercentageofTheoWinNetFreeplay': 'SUM(BIS2_FN_SegmentsByWeek.FreeplayPercentageofTheoWinNetFreeplay) AS FreeplayPercentageofTheoWinNetFreeplay', 'Freeplay': 'SUM(BIS2_FN_SegmentsByWeek.Freeplay) AS Freeplay', 'PlayerCount': 'SUM(BIS2_FN_SegmentsByWeek.PlayerCount) AS PlayerCount'}
	DocJoins: ["CRMDemo.dbo.BIS2_FN_SegmentsByWeek('20120801"]DocJoinDict: {"CRMDemo.dbo.BIS2_FN_SegmentsByWeek('20120801": "FROM CRMDemo.dbo.BIS2_FN_SegmentsByWeek('20120801 00:00:00','20130801 00:00:00') AS BIS2_FN_SegmentsByWeek "}
	DocWhere: ["BIS2_FN_SegmentsByWeek.ADTAMTGroup AS ADTAMTGroup,BIS2_FN_SegmentsByWeek.AMVGroup AS AMVGroup,BIS2_FN_SegmentsByWeek.EndofWeek AS EndofWeek,BIS2_FN_SegmentsByWeek.WeekEndDateType AS WeekEndDateType,SUM(BIS2_FN_SegmentsByWeek.ActualWin) AS ActualWin,SUM(BIS2_FN_SegmentsByWeek.AvgDailyTheoWinNetFreeplay) AS AvgDailyTheoWinNetFreeplay,SUM(BIS2_FN_SegmentsByWeek.Freeplay) AS Freeplay,SUM(BIS2_FN_SegmentsByWeek.FreeplayPercentageofTheoWinNetFreeplay) AS FreeplayPercentageofTheoWinNetFreeplay,SUM(BIS2_FN_SegmentsByWeek.PlayerCount) AS PlayerCount,SUM(BIS2_FN_SegmentsByWeek.TheoWin) AS TheoWin,SUM(BIS2_FN_SegmentsbyWeek.TheoWin-BIS2_FN_SegmentsbyWeek.Freeplay) AS TheoWinNetFreeplay,SUM(BIS2_FN_SegmentsByWeek.Visits) AS Visits,SUM(BIS2_FN_SegmentsByWeek.VisitsperPlayer) AS VisitsperPlayer FROM CRMDemo.dbo.BIS2_FN_SegmentsByWeek('20120801 00:00:00','20130801 00:00:00') AS BIS2_FN_SegmentsByWeek "]
	DocWhereAnd: {"BIS2_FN_SegmentsByWeek.ADTAMTGroup AS ADTAMTGroup,BIS2_FN_SegmentsByWeek.AMVGroup AS AMVGroup,BIS2_FN_SegmentsByWeek.EndofWeek AS EndofWeek,BIS2_FN_SegmentsByWeek.WeekEndDateType AS WeekEndDateType,SUM(BIS2_FN_SegmentsByWeek.ActualWin) AS ActualWin,SUM(BIS2_FN_SegmentsByWeek.AvgDailyTheoWinNetFreeplay) AS AvgDailyTheoWinNetFreeplay,SUM(BIS2_FN_SegmentsByWeek.Freeplay) AS Freeplay,SUM(BIS2_FN_SegmentsByWeek.FreeplayPercentageofTheoWinNetFreeplay) AS FreeplayPercentageofTheoWinNetFreeplay,SUM(BIS2_FN_SegmentsByWeek.PlayerCount) AS PlayerCount,SUM(BIS2_FN_SegmentsByWeek.TheoWin) AS TheoWin,SUM(BIS2_FN_SegmentsbyWeek.TheoWin-BIS2_FN_SegmentsbyWeek.Freeplay) AS TheoWinNetFreeplay,SUM(BIS2_FN_SegmentsByWeek.Visits) AS Visits,SUM(BIS2_FN_SegmentsByWeek.VisitsperPlayer) AS VisitsperPlayer FROM CRMDemo.dbo.BIS2_FN_SegmentsByWeek('20120801 00:00:00','20130801 00:00:00') AS BIS2_FN_SegmentsByWeek ": 'start'}
2016-10-03 16:09:24.782242: Final data about 336ddaaf0-14b2cd789aa:
	UserAggList: ['ActualWin', 'Freeplay', 'PlayerCount', 'TheoWin']
	UserRestrictList: []
	FinalQuery: SELECT 'Step 1' AS Step, SUM(BIS2_FN_SegmentsByWeek.ActualWin) AS ActualWin, SUM(BIS2_FN_SegmentsByWeek.Freeplay) AS Freeplay, SUM(BIS2_FN_SegmentsByWeek.PlayerCount) AS PlayerCount, SUM(BIS2_FN_SegmentsByWeek.TheoWin) AS TheoWin, 'CRMDemo.dbo.BIS2_FN_SegmentsByWeek' AS StepInfo FROM CRMDemo.dbo.BIS2_FN_SegmentsByWeek('20120801 00:00:00','20130801 00:00:00') AS BIS2_FN_SegmentsByWeek WHERE BIS2_FN_SegmentsByWeek.ADTAMTGroup AS ADTAMTGroup,BIS2_FN_SegmentsByWeek.AMVGroup AS AMVGroup,BIS2_FN_SegmentsByWeek.EndofWeek AS EndofWeek,BIS2_FN_SegmentsByWeek.WeekEndDateType AS WeekEndDateType,SUM(BIS2_FN_SegmentsByWeek.ActualWin) AS ActualWin,SUM(BIS2_FN_SegmentsByWeek.AvgDailyTheoWinNetFreeplay) AS AvgDailyTheoWinNetFreeplay,SUM(BIS2_FN_SegmentsByWeek.Freeplay) AS Freeplay,SUM(BIS2_FN_SegmentsByWeek.FreeplayPercentageofTheoWinNetFreeplay) AS FreeplayPercentageofTheoWinNetFreeplay,SUM(BIS2_FN_SegmentsByWeek.PlayerCount) AS PlayerCount,SUM(BIS2_FN_SegmentsByWeek.TheoWin) AS TheoWin,SUM(BIS2_FN_SegmentsbyWeek.TheoWin-BIS2_FN_SegmentsbyWeek.Freeplay) AS TheoWinNetFreeplay,SUM(BIS2_FN_SegmentsByWeek.Visits) AS Visits,SUM(BIS2_FN_SegmentsByWeek.VisitsperPlayer) AS VisitsperPlayer FROM CRMDemo.dbo.BIS2_FN_SegmentsByWeek('20120801 00:00:00','20130801 00:00:00') AS BIS2_FN_SegmentsByWeek 
2016-10-03 16:09:24.796782: Now attempting to run the query for 32a970f6e-14d6ebf9480:
2016-10-03 16:09:24.809790: Attempting to connect to the database:
2016-10-03 16:09:29.583712: Database connection successful.
2016-10-03 16:09:50.655941: Query successfully run. Here are the results:
	[('Step 1', Decimal('26121828.5200'), Decimal('322868958.48'), Decimal('6176001.44'), Decimal('25648192.9598'), 'CRMDemo.dbo.BIS2_VW_PlayerSession'), ('Step 2', Decimal('26121828.5200'), Decimal('322868958.48'), Decimal('6176001.44'), Decimal('25648192.9598'), 'BIS2_SQLTC_PlayerSummary'), ('Step 3', Decimal('26121828.5200'), Decimal('322868958.48'), Decimal('6176001.44'), Decimal('25648192.9598'), 'CRMDemo.dbo.cqa')]
2016-10-03 16:09:50.667451: Now attempting to run the query for 318c6d3f5-15000fbfb14:
2016-10-03 16:09:50.678937: Attempting to connect to the database:
2016-10-03 16:09:52.992589: Database connection successful.
2016-10-03 16:09:55.179151: An error has occurred in this query. Please run the query in SQL Server for more information.
2016-10-03 16:09:56.052521: Now attempting to run the query for 336ddaaf0-14b2cd789aa:
2016-10-03 16:09:56.065556: Attempting to connect to the database:
2016-10-03 16:09:57.903504: Database connection successful.
2016-10-03 16:09:58.518973: An error has occurred in this query. Please run the query in SQL Server for more information.
2016-10-03 16:09:59.422111: Queries completed with 2 errors.
	Errored documents are: ['318c6d3f5-15000fbfb14', '336ddaaf0-14b2cd789aa'].
2016-10-03 16:09:59.438623: Attempting to create the excel sheet for 32a970f6e-14d6ebf9480
2016-10-03 16:10:01.089814: Excel sheet for 32a970f6e-14d6ebf9480 successful.