2016-09-08 09:47:02.235386: Successfully stripped the joins: ['FROM BIS2Data.dbo.BIS2_VW_DAILYPTNRTG ', 'INNER JOIN BIS2Data.dbo.BIS2_VW_Site ON BIS2Data.dbo.BIS2_VW_DAILYPTNRTG.SiteID = BIS2Data.dbo.BIS2_VW_Site.SiteID ', 'INNER HASH JOIN BIS2Data.dbo.BIS2_VW_DEVICE ON (BIS2Data.dbo.BIS2_VW_DAILYPTNRTG.DEVID = BIS2Data.dbo.BIS2_VW_DEVICE.DEVID AND BIS2Data.dbo.BIS2_VW_DAILYPTNRTG.DATEINSERTED >= BIS2Data.dbo.BIS2_VW_DEVICE.Start_date AND BIS2Data.dbo.BIS2_VW_DAILYPTNRTG.DATEINSERTED < BIS2Data.dbo.BIS2_VW_DEVICE.end_date) ', 'LEFT HASH JOIN BIS2Data.dbo.BIS2_VW_DEVICECUSTOMFIELDS ON (BIS2Data.dbo.BIS2_VW_DEVICE.DEVID = BIS2Data.dbo.BIS2_VW_DEVICECUSTOMFIELDS.DEVID AND BIS2Data.dbo.BIS2_VW_DEVICE.SiteID = BIS2Data.dbo.BIS2_VW_DEVICECUSTOMFIELDS.SiteID) ', 'INNER JOIN BIS2Data.dbo.BIS2_GEO_chairs ON (BIS2Data.dbo.BIS2_VW_DEVICE.StandID = BIS2Data.dbo.BIS2_GEO_chairs.standid AND BIS2Data.dbo.BIS2_VW_DEVICE.SiteID = BIS2Data.dbo.BIS2_GEO_chairs.casinoid) ', 'INNER JOIN BIS2Data.dbo.BIS2_VW_MANUFACTURER ON (BIS2Data.dbo.BIS2_VW_DEVICE.MFRID = BIS2Data.dbo.BIS2_VW_MANUFACTURER.MFRID AND BIS2Data.dbo.BIS2_VW_DEVICE.SiteID = BIS2Data.dbo.BIS2_VW_MANUFACTURER.SiteID) ', "LEFT HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_OccupancyCalc*/SELECT BIS2_SQLTC_UnRatedMetrics.DEVID AS DEVID,BIS2_SQLTC_UnRatedMetrics.SiteID AS SiteID,BIS2_SQLTC_UnRatedMetrics.StandID AS StandID,BIS2_SQLTC_UnRatedMetrics.StartDate AS StartDate,SUM(BIS2_SQLTC_UnRatedMetrics.CoinInperDay) AS CoinInperDay,SUM(BIS2_SQLTC_UnRatedMetrics.GamesPlayedperDay) AS GamesPlayedperDay,SUM(BIS2_SQLTC_RatedMetrics.GamesPlayedPerMinute) AS GamesPlayedPerMinute,SUM(CASE WHEN BIS2_SQLTC_RatedMetrics.CoinInperHour<>0\nTHEN 100.0 *BIS2_SQLTC_UnRatedMetrics.CoinInperDay/BIS2_SQLTC_RatedMetrics.CoinInperHour/24.0 ELSE 0 END) AS Occupancy,SUM(BIS2_SQLTC_RatedMetrics.PlayerCount) AS PlayerCount,SUM(BIS2_SQLTC_RatedMetrics.TheoWinperHour) AS TheoWinperHour FROM (/* SqlTableCalculator: BIS2_SQLTC_UnRatedMetrics*/SELECT BIS2Data.dbo.BIS2_VW_DEVICE.DEVID AS DEVID,BIS2Data.dbo.BIS2_VW_DAILYDEVSTAT.SiteID AS SiteID,BIS2Data.dbo.BIS2_VW_DEVICE.StandID AS StandID,BIS2Data.dbo.BIS2_VW_DEVICE.Start_date AS StartDate,case when count(distinct cast(BIS2_VW_DAILYDEVSTAT.DateInserted as varchar) cast(BIS2_VW_DEVICE.StandID as varchar) cast(BIS2_VW_DAILYDEVSTAT.DEVID as varchar))<>0 then sum(BIS2_VW_DAILYDEVSTAT.COININAMT)/count(distinct cast(BIS2_VW_DAILYDEVSTAT.DateInserted as varchar) cast(BIS2_VW_DEVICE.StandID as varchar) cast(BIS2_VW_DAILYDEVSTAT.DEVID as varchar)) else 0 end AS CoinInperDay,case when count(distinct cast(BIS2_VW_DAILYDEVSTAT.DateInserted as varchar) cast(BIS2_VW_DEVICE.StandID as varchar))<>0 then sum(BIS2_VW_DAILYDEVSTAT.PLAYCNT)/count(distinct cast(BIS2_VW_DAILYDEVSTAT.DateInserted as varchar) cast(BIS2_VW_DEVICE.StandID as varchar) cast(BIS2_VW_DAILYDEVSTAT.DEVID as varchar)) else 0 end AS GamesPlayedperDay FROM BIS2Data.dbo.BIS2_VW_DAILYDEVSTAT INNER JOIN BIS2Data.dbo.BIS2_VW_Site ON BIS2Data.dbo.BIS2_VW_DAILYDEVSTAT.SiteID = BIS2Data.dbo.BIS2_VW_Site.SiteID INNER HASH JOIN BIS2Data.dbo.BIS2_VW_DEVICE ON (BIS2Data.dbo.BIS2_VW_DAILYDEVSTAT.DEVID = BIS2Data.dbo.BIS2_VW_DEVICE.DEVID AND BIS2Data.dbo.BIS2_VW_DAILYDEVSTAT.DATEINSERTED >= BIS2Data.dbo.BIS2_VW_DEVICE.Start_date AND BIS2Data.dbo.BIS2_VW_DAILYDEVSTAT.DATEINSERTED < BIS2Data.dbo.BIS2_VW_DEVICE.end_date AND BIS2Data.dbo.BIS2_VW_DAILYDEVSTAT.SiteID = BIS2Data.dbo.BIS2_VW_DEVICE.SiteID) WHERE ((BIS2Data.dbo.BIS2_VW_DAILYDEVSTAT.DATEINSERTED >= '20160101 00:00:00') AND (BIS2Data.dbo.BIS2_VW_DAILYDEVSTAT.DATEINSERTED < '20160401 00:00:00') AND (BIS2Data.dbo.BIS2_VW_Site.CasinoCode = 'OKE')) GROUP BY BIS2Data.dbo.BIS2_VW_DEVICE.DEVID,BIS2Data.dbo.BIS2_VW_DAILYDEVSTAT.SiteID,BIS2Data.dbo.BIS2_VW_DEVICE.StandID,BIS2Data.dbo.BIS2_VW_DEVICE.Start_date/* End: BIS2_SQLTC_UnRatedMetrics*/) AS BIS2_SQLTC_UnRatedMetrics LEFT HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_RatedMetrics*/SELECT BIS2Data.dbo.BIS2_VW_DEVICE.DEVID AS DEVID,BIS2Data.dbo.BIS2_VW_DAILYPTNRTG.SiteID AS SiteID,BIS2Data.dbo.BIS2_VW_DEVICE.StandID AS StandID,BIS2Data.dbo.BIS2_VW_DEVICE.Start_date AS StartDate,CASE WHEN SUM(BIS2_VW_DAILYPTNRTG.TIMEONDEVSEC) <> 0 THEN SUM(BIS2_VW_DAILYPTNRTG.TOTBUYIN) /\n\t(SUM(BIS2_VW_DAILYPTNRTG.TIMEONDEVSEC)/3600.00) ELSE 0 END AS CoinInperHour,CASE WHEN SUM(BIS2_VW_DAILYPTNRTG.TIMEONDEVSEC) <> 0 THEN SUM(BIS2_VW_DAILYPTNRTG.GAMESPLAYED) /\n\t(SUM(BIS2_VW_DAILYPTNRTG.TIMEONDEVSEC)/3600.00) ELSE 0 END AS GamesPlayedPerHour,CASE WHEN SUM(BIS2_VW_DAILYPTNRTG.TIMEONDEVSEC) <> 0 THEN SUM(BIS2_VW_DAILYPTNRTG.GAMESPLAYED) /\n\t(SUM(BIS2_VW_DAILYPTNRTG.TIMEONDEVSEC)/60.0) ELSE 0 END AS GamesPlayedPerMinute,count(distinct BIS2_VW_DAILYPTNRTG.PTNID) AS PlayerCount,CASE WHEN SUM(BIS2_VW_DAILYPTNRTG.TIMEONDEVSEC) <> 0 THEN SUM(BIS2_VW_DAILYPTNRTG.TheoWin) /\n\t(SUM(BIS2_VW_DAILYPTNRTG.TIMEONDEVSEC)/3600.00) ELSE 0 END AS TheoWinperHour FROM BIS2Data.dbo.BIS2_VW_DAILYPTNRTG INNER JOIN BIS2Data.dbo.BIS2_VW_Site ON BIS2Data.dbo.BIS2_VW_DAILYPTNRTG.SiteID = BIS2Data.dbo.BIS2_VW_Site.SiteID INNER HASH JOIN BIS2Data.dbo.BIS2_VW_DEVICE ON (BIS2Data.dbo.BIS2_VW_DAILYPTNRTG.DEVID = BIS2Data.dbo.BIS2_VW_DEVICE.DEVID AND BIS2Data.dbo.BIS2_VW_DAILYPTNRTG.DATEINSERTED >= BIS2Data.dbo.BIS2_VW_DEVICE.Start_date AND BIS2Data.dbo.BIS2_VW_DAILYPTNRTG.DATEINSERTED < BIS2Data.dbo.BIS2_VW_DEVICE.end_date) WHERE ((BIS2Data.dbo.BIS2_VW_DAILYPTNRTG.DATEINSERTED >= '20160101 00:00:00') AND (BIS2Data.dbo.BIS2_VW_DAILYPTNRTG.DATEINSERTED < '20160401 00:00:00') AND (BIS2Data.dbo.BIS2_VW_Site.CasinoCode = 'OKE')) GROUP BY BIS2Data.dbo.BIS2_VW_DEVICE.DEVID,BIS2Data.dbo.BIS2_VW_DAILYPTNRTG.SiteID,BIS2Data.dbo.BIS2_VW_DEVICE.StandID,BIS2Data.dbo.BIS2_VW_DEVICE.Start_date/* End: BIS2_SQLTC_RatedMetrics*/) AS BIS2_SQLTC_RatedMetrics ON (BIS2_SQLTC_UnRatedMetrics.StandID = BIS2_SQLTC_RatedMetrics.StandID AND BIS2_SQLTC_UnRatedMetrics.StartDate = BIS2_SQLTC_RatedMetrics.StartDate AND BIS2_SQLTC_UnRatedMetrics.DEVID = BIS2_SQLTC_RatedMetrics.DEVID AND BIS2_SQLTC_UnRatedMetrics.SiteID = BIS2_SQLTC_RatedMetrics.SiteID) GROUP BY BIS2_SQLTC_UnRatedMetrics.DEVID,BIS2_SQLTC_UnRatedMetrics.SiteID,BIS2_SQLTC_UnRatedMetrics.StandID,BIS2_SQLTC_UnRatedMetrics.StartDate/* End: BIS2_SQLTC_OccupancyCalc*/) AS BIS2_SQLTC_OccupancyCalc ON (BIS2Data.dbo.BIS2_VW_DEVICE.StandID = BIS2_SQLTC_OccupancyCalc.StandID AND BIS2Data.dbo.BIS2_VW_DEVICE.DEVID = BIS2_SQLTC_OccupancyCalc.DEVID AND BIS2Data.dbo.BIS2_VW_DEVICE.Start_date = BIS2_SQLTC_OccupancyCalc.StartDate AND BIS2Data.dbo.BIS2_VW_DEVICE.SiteID = BIS2_SQLTC_OccupancyCalc.SiteID) "]