2016-08-30 09:54:13.468004: Successfully stripped the joins: ['FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail ', 'INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID ', 'INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) ', 'INNER JOIN CRMDemo_US.dbo.BIS2_VW_Slot_Names ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo_US.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID) ', "INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DenomAvg*/SELECT CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom AS Denom,CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID AS SiteID,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS DenomAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS DenomAvgTheoWin FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Slot_Names ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum = CRMDemo_US.dbo.BIS2_VW_Slot_Names.mnum AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID) WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteID = 5)) GROUP BY CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom,CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID/* End: BIS2_SQLTC_DenomAvg*/) AS BIS2_SQLTC_DenomAvg ON (CRMDemo_US.dbo.BIS2_VW_Slot_Names.SiteID = BIS2_SQLTC_DenomAvg.SiteID AND CRMDemo_US.dbo.BIS2_VW_Slot_Names.Denom = BIS2_SQLTC_DenomAvg.Denom) ", 'INNER JOIN CRMDemo_US.dbo.BIS2_GEO_chairs ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid = CRMDemo_US.dbo.BIS2_GEO_chairs.standid AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = CRMDemo_US.dbo.BIS2_GEO_chairs.casinoid) ', "INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_SectionAvg*/SELECT CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Section AS Section,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AS siteid,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS SectionAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS SectionAvgTheoWin FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteID = 5)) GROUP BY CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Section,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid/* End: BIS2_SQLTC_SectionAvg*/) AS BIS2_SQLTC_SectionAvg ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = BIS2_SQLTC_SectionAvg.siteid AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Section = BIS2_SQLTC_SectionAvg.Section) ", "INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_Occupancy*/SELECT BIS2_SQLTC_RatedMetrics.Mnum AS Mnum,BIS2_SQLTC_UnratedMetrics.Mnum_Location AS Mnum_Location,BIS2_SQLTC_RatedMetrics.SiteID AS SiteID,BIS2_SQLTC_RatedMetrics.StandID AS StandID,BIS2_SQLTC_RatedMetrics.startdate AS startdate,SUM(BIS2_SQLTC_RatedMetrics.GamesPlayedPerMinute) AS GamesPlayedPerMinute,SUM(CASE WHEN BIS2_SQLTC_RatedMetrics.GamesPlayedperHour/24.0 <> 0 THEN\n\t100.0*BIS2_SQLTC_UnRatedMetrics.GamesPlayedperDay/BIS2_SQLTC_RatedMetrics.GamesPlayedperHour/24.0 ELSE 0 END) AS Occupancy,SUM(BIS2_SQLTC_RatedMetrics.TheoWinperHour) AS TheoWinperHour FROM (/* SqlTableCalculator: BIS2_SQLTC_RatedMetrics*/SELECT CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AS Mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AS SiteID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid AS StandID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AS startdate,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0) <> 0 THEN \tSUM(BIS2_VW_PlayerSession.Games)/(SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0)) ELSE 0 END AS GamesPlayedPerHour,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed/60.0) <> 0 THEN \tSUM(BIS2_VW_PlayerSession.Games)/(SUM(BIS2_VW_PlayerSession.TimePlayed/60.0)) ELSE 0 END AS GamesPlayedPerMinute,COUNT(DISTINCT BIS2_VW_PlayerSession.PlayerID) AS PlayerCount,CASE WHEN SUM(BIS2_VW_PlayerSession.TimePlayed) <> 0 THEN SUM(BIS2_VW_PlayerSession.TheoWin) /\n\t(SUM(BIS2_VW_PlayerSession.TimePlayed)/3600.00) ELSE 0 END AS TheoWinperHour FROM CRMDemo_US.dbo.BIS2_VW_PlayerSession INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PlayerSession.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PlayerSession.MNUM = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PlayerSession.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') AND (CRMDemo_US.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') AND (CRMDemo_US.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') AND (CRMDemo_US.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteID = 5)) GROUP BY CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate/* End: BIS2_SQLTC_RatedMetrics*/) AS BIS2_SQLTC_RatedMetrics INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_UnratedMetrics*/SELECT CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AS Mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Mnum_Location AS Mnum_Location,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AS SiteID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid AS StandID,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AS startdate,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrGames)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS GamesPlayedperDay FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD ON (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Mnum = CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate AND CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.enddate) INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteID = 5)) GROUP BY CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.Mnum_Location,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid,CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate/* End: BIS2_SQLTC_UnratedMetrics*/) AS BIS2_SQLTC_UnratedMetrics ON (BIS2_SQLTC_RatedMetrics.SiteID = BIS2_SQLTC_UnratedMetrics.SiteID AND BIS2_SQLTC_RatedMetrics.Mnum = BIS2_SQLTC_UnratedMetrics.Mnum AND BIS2_SQLTC_RatedMetrics.StandID = BIS2_SQLTC_UnratedMetrics.StandID AND BIS2_SQLTC_RatedMetrics.startdate = BIS2_SQLTC_UnratedMetrics.startdate) GROUP BY BIS2_SQLTC_RatedMetrics.Mnum,BIS2_SQLTC_UnratedMetrics.Mnum_Location,BIS2_SQLTC_RatedMetrics.SiteID,BIS2_SQLTC_RatedMetrics.StandID,BIS2_SQLTC_RatedMetrics.startdate/* End: BIS2_SQLTC_Occupancy*/) AS BIS2_SQLTC_Occupancy ON (CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.siteid = BIS2_SQLTC_Occupancy.SiteID AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.mnum = BIS2_SQLTC_Occupancy.Mnum AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.standid = BIS2_SQLTC_Occupancy.StandID AND CRMDemo_US.dbo.BIS2_V_Slot_Location_SCD.startdate = BIS2_SQLTC_Occupancy.startdate) ", "INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_FloorAvg*/SELECT CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID AS SiteID,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS FloorAvgActualWin,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrCoinIn)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar)) else 0 END AS FloorAvgCoinIn,case when count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))<>0 then sum(BIS2_VW_PeriodDetail.MtrTheoWin)/count(distinct cast(bis2_vw_perioddetail.standid as varchar)+cast( dbo.BIS2_VW_PeriodDetail.date as varchar))else 0 END AS FloorAvgTheoWin FROM CRMDemo_US.dbo.BIS2_VW_PeriodDetail INNER JOIN CRMDemo_US.dbo.BIS2_VW_Site ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = CRMDemo_US.dbo.BIS2_VW_Site.SiteID WHERE ((CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date >= '20130201') AND (CRMDemo_US.dbo.BIS2_VW_PeriodDetail.Date < '20130501') AND (CRMDemo_US.dbo.BIS2_VW_Site.SiteID = 5)) GROUP BY CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID/* End: BIS2_SQLTC_FloorAvg*/) AS BIS2_SQLTC_FloorAvg ON CRMDemo_US.dbo.BIS2_VW_PeriodDetail.SiteID = BIS2_SQLTC_FloorAvg.SiteID "]