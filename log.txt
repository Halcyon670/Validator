
2016-10-01 10:18:40.408222: Successfully purged prior log and started a new one.
2016-10-01 10:18:53.396486: Moving forward with the following docs: ['32a970f6e-14d6ebf9480']
2016-10-01 10:18:53.505078: Checking 32a970f6e-14d6ebf9480 (Avg Monthly Visits vs Days Since Last Trip, AV_Q01):
	Query: SELECT CRMDemo.dbo.cqa.cell_index AS CellIndex,'Q' + substring(cqa.cell_index,1,1) AS QL1,'Q' + substring(cqa.cell_index,1,2) AS QL2,'Q' + substring(cqa.cell_index,1,3) AS QL3,'Q' + substring(cqa.cell_index,1,4) AS QL4,case when SUM(BIS2_VW_PlayerSession.coinin) <> 0 then (SUM(BIS2_VW_PlayerSession.win)/SUM(BIS2_VW_PlayerSession.coinin))*100.0 else 0 end AS ActualHold,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin,Case WHEN count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) <> 0 THEN  sum(BIS2_VW_PlayerSession.TheoWin)/count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) ELSE 0 END AS ADT,case when SUM(BIS2_VW_PlayerSession.Games)<>0 THEN SUM(BIS2_VW_PlayerSession.Coinin)/SUM(BIS2_VW_PlayerSession.Games) ELSE 0 END AS AvgBet,Sum(BIS2_VW_PlayerSession.TheoWin)/cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS AvgMonthlyTheo,cast(count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) as decimal(10,4))/cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS AvgMonthlyVisits,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.CoinIn) AS CoinIn,AVG(BIS2_SQLTC_PlayerSummary.DaysSinceLastTrip) AS DaysSinceLastTrip,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.FreePlay) AS Freeplay,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Games) AS GamesPlayed,SUM(BIS2_VW_PlayerSession.TimePlayed / 3600.0) AS HoursPlayed,CASE when count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar))<>0 THEN SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0)/count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) ELSE 0 END AS HoursPlayedPerVisit,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Jackpot) AS Jackpot,MAX(BIS2_SQLTC_PlayerSummary.AMV) AS MaxAMV,MAX(BIS2_SQLTC_PlayerSummary.DaysSinceLastTrip) AS MaxDaysSinceLastTrip,cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS MonthswithPlay,COUNT(DISTINCT BIS2_VW_PlayerSession.PlayerID) AS Player_Count,case when SUM(BIS2_VW_PlayerSession.coinin) <> 0 then (SUM(BIS2_VW_PlayerSession.theowin)/SUM(BIS2_VW_PlayerSession.coinin))*100.0 else 0 end AS TheoHold,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.TheoWin) AS TheoWin,count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) AS Visits,CASE WHEN COUNT(DISTINCT BIS2_VW_PlayerSession.PlayerID)<>0 THEN cast(count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) as decimal(10,2))/COUNT(DISTINCT BIS2_VW_PlayerSession.PlayerID) ELSE 0 END AS VisitsperPlayer FROM CRMDemo.dbo.BIS2_VW_PlayerSession INNER JOIN CRMDemo.dbo.cqa ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = CRMDemo.dbo.cqa.pk INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_PlayerSummary*/SELECT MAX(BIS2_VW_PlayerSession.GamingDate) AS LastDaywithPlay,CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID AS PlayerID,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin,CASE WHEN SUM(BIS2_VW_PlayerSession.TheoWin)<>0 THEN 100.0*SUM(BIS2_VW_PlayerSession.Win)/SUM(BIS2_VW_PlayerSession.TheoWin) ELSE 0 END AS ActualWinTheoWinRatio,Case WHEN count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) <> 0 THEN  sum(BIS2_VW_PlayerSession.TheoWin)/count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) ELSE 0 END AS ADT,Sum(BIS2_VW_PlayerSession.TheoWin)/cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS AMT,cast(count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) as decimal(10,4))/cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS AMV,datediff(dd,max(cast(BIS2_VW_PlayerSession.GamingDate as varchar)),MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,CASE WHEN SUM(BIS2_VW_PlayerSession.TheoWin)<>0 THEN (SUM(BIS2_VW_PlayerSession.Freeplay)*100.0)/SUM(BIS2_VW_PlayerSession.TheoWin) ELSE 0 END AS FreeplayReinvestmentPct,CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then  datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end AS MeanTimeBetweenTrips,CASE WHEN SUM(case when GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)<>0 THEN (100.0*(SUM(case when   GamingDate>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)-SUM(case when   GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)))/SUM(case when   GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END) ELSE 0 END AS PercentChangeTheoWin,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END) ELSE 0 END AS PercentChangeVisits,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.TheoWin) AS TheoWin,CASE WHEN CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then   datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end <>0 THEN  datediff(dd,  max(cast(BIS2_VW_PlayerSession.GamingDate as varchar)),  MAX(BIS2_FN_SGStartEndDate.SGEndDate))/CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then   datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end ELSE 0 END AS TripsOwed,case when cast(DATEDIFF(dd,max(BIS2_VW_PlayerSession.GamingDate),min(BIS2_VW_PlayerSession.GamingDate)) as decimal(15,2)) <> 0 then  (count(distinct BIS2_VW_PlayerSession.GamingDate)-1)/cast(DATEDIFF(dd,min(BIS2_VW_PlayerSession.GamingDate),max(dbo.BIS2_VW_PlayerSession.GamingDate)) as decimal(15,2))  ELSE 0 END AS VisitDensity,count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) AS Visits FROM CRMDemo.dbo.BIS2_VW_PlayerSession INNER HASH JOIN CRMDemo.dbo.BIS2_FN_SGStartEndDate('20130201 00:00:00','20130501 00:00:00') AS BIS2_FN_SGStartEndDate ON CRMDemo.dbo.BIS2_VW_PlayerSession.hackjoin = BIS2_FN_SGStartEndDate.HackJoin INNER JOIN CRMDemo.dbo.cqa ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = CRMDemo.dbo.cqa.pk WHERE ((CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') AND (CRMDemo.dbo.cqa.allocation_id = '32a975063-14d6ec23654')) GROUP BY CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID/* End: BIS2_SQLTC_PlayerSummary*/) AS BIS2_SQLTC_PlayerSummary ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = BIS2_SQLTC_PlayerSummary.PlayerID WHERE ((CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') AND (CRMDemo.dbo.cqa.allocation_id = '32a975063-14d6ec23654')) GROUP BY CRMDemo.dbo.cqa.cell_index,'Q' + substring(cqa.cell_index,1,1),'Q' + substring(cqa.cell_index,1,2),'Q' + substring(cqa.cell_index,1,3),'Q' + substring(cqa.cell_index,1,4)
	DocAggs: ['ActualHold', 'ActualWin', 'AvgBet', 'CoinIn', 'Freeplay', 'GamesPlayed', 'HoursPlayed', 'HoursPlayedPerVisit', 'Jackpot', 'Player_Count', 'TheoHold', 'TheoWin']
	DocAggDict: {'ActualHold': 'SUM(BIS2_VW_PlayerSession.coinin) <> 0 then (SUM(BIS2_VW_PlayerSession.win)/SUM(BIS2_VW_PlayerSession.coinin))*100.0 else 0 end AS ActualHold', 'ActualWin': 'SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin', 'CoinIn': 'SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.CoinIn) AS CoinIn', 'AvgBet': 'SUM(BIS2_VW_PlayerSession.Games)<>0 THEN SUM(BIS2_VW_PlayerSession.Coinin)/SUM(BIS2_VW_PlayerSession.Games) ELSE 0 END AS AvgBet', 'HoursPlayed': 'SUM(BIS2_VW_PlayerSession.TimePlayed / 3600.0) AS HoursPlayed', 'GamesPlayed': 'SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Games) AS GamesPlayed', 'Jackpot': 'SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Jackpot) AS Jackpot', 'Freeplay': 'SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.FreePlay) AS Freeplay', 'Player_Count': 'COUNT(DISTINCT BIS2_VW_PlayerSession.PlayerID) AS Player_Count', 'HoursPlayedPerVisit': 'SUM(BIS2_VW_PlayerSession.TimePlayed/3600.0)/count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) ELSE 0 END AS HoursPlayedPerVisit', 'TheoWin': 'SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.TheoWin) AS TheoWin', 'TheoHold': 'SUM(BIS2_VW_PlayerSession.coinin) <> 0 then (SUM(BIS2_VW_PlayerSession.theowin)/SUM(BIS2_VW_PlayerSession.coinin))*100.0 else 0 end AS TheoHold'}
	DocJoins: ['CRMDemo.dbo.BIS2_VW_PlayerSession', 'CRMDemo.dbo.cqa', 'BIS2_SQLTC_PlayerSummary']DocJoinDict: {'CRMDemo.dbo.BIS2_VW_PlayerSession': 'FROM CRMDemo.dbo.BIS2_VW_PlayerSession ', 'BIS2_SQLTC_PlayerSummary': "INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_PlayerSummary*/SELECT MAX(BIS2_VW_PlayerSession.GamingDate) AS LastDaywithPlay,CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID AS PlayerID,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin,CASE WHEN SUM(BIS2_VW_PlayerSession.TheoWin)<>0 THEN 100.0*SUM(BIS2_VW_PlayerSession.Win)/SUM(BIS2_VW_PlayerSession.TheoWin) ELSE 0 END AS ActualWinTheoWinRatio,Case WHEN count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) <> 0 THEN  sum(BIS2_VW_PlayerSession.TheoWin)/count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) ELSE 0 END AS ADT,Sum(BIS2_VW_PlayerSession.TheoWin)/cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS AMT,cast(count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) as decimal(10,4))/cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS AMV,datediff(dd,max(cast(BIS2_VW_PlayerSession.GamingDate as varchar)),MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,CASE WHEN SUM(BIS2_VW_PlayerSession.TheoWin)<>0 THEN (SUM(BIS2_VW_PlayerSession.Freeplay)*100.0)/SUM(BIS2_VW_PlayerSession.TheoWin) ELSE 0 END AS FreeplayReinvestmentPct,CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then  datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end AS MeanTimeBetweenTrips,CASE WHEN SUM(case when GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)<>0 THEN (100.0*(SUM(case when   GamingDate>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)-SUM(case when   GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)))/SUM(case when   GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END) ELSE 0 END AS PercentChangeTheoWin,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END) ELSE 0 END AS PercentChangeVisits,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.TheoWin) AS TheoWin,CASE WHEN CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then   datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end <>0 THEN  datediff(dd,  max(cast(BIS2_VW_PlayerSession.GamingDate as varchar)),  MAX(BIS2_FN_SGStartEndDate.SGEndDate))/CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then   datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end ELSE 0 END AS TripsOwed,case when cast(DATEDIFF(dd,max(BIS2_VW_PlayerSession.GamingDate),min(BIS2_VW_PlayerSession.GamingDate)) as decimal(15,2)) <> 0 then  (count(distinct BIS2_VW_PlayerSession.GamingDate)-1)/cast(DATEDIFF(dd,min(BIS2_VW_PlayerSession.GamingDate),max(dbo.BIS2_VW_PlayerSession.GamingDate)) as decimal(15,2))  ELSE 0 END AS VisitDensity,count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) AS Visits FROM CRMDemo.dbo.BIS2_VW_PlayerSession INNER HASH JOIN CRMDemo.dbo.BIS2_FN_SGStartEndDate('20130201 00:00:00','20130501 00:00:00') AS BIS2_FN_SGStartEndDate ON CRMDemo.dbo.BIS2_VW_PlayerSession.hackjoin = BIS2_FN_SGStartEndDate.HackJoin INNER JOIN CRMDemo.dbo.cqa ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = CRMDemo.dbo.cqa.pk WHERE ((CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') AND (CRMDemo.dbo.cqa.allocation_id = '32a975063-14d6ec23654')) GROUP BY CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID/* End: BIS2_SQLTC_PlayerSummary*/) AS BIS2_SQLTC_PlayerSummary ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = BIS2_SQLTC_PlayerSummary.PlayerID ", 'CRMDemo.dbo.cqa': 'INNER JOIN CRMDemo.dbo.cqa ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = CRMDemo.dbo.cqa.pk '}
	DocWhere: ["(CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') ", "(CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') ", "(CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') ", "(CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') ", "(CRMDemo.dbo.cqa.allocation_id = '32a975063-14d6ec23654')"]
	DocWhereAnd: {"(CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') ": 'AND ', "(CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') ": 'AND ', "(CRMDemo.dbo.cqa.allocation_id = '32a975063-14d6ec23654')": 'AND ', "(CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') ": 'start', "(CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') ": 'AND '}
2016-10-01 10:19:01.646299: Final data about 32a970f6e-14d6ebf9480:
	UserAggList: ['ActualWin', 'CoinIn']
	UserRestrictList: ["(CRMDemo.dbo.cqa.allocation_id = '32a975063-14d6ec23654')"]
	FinalQuery: SELECT 'Step 1' AS Step, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.CoinIn) AS CoinIn, 'CRMDemo.dbo.BIS2_VW_PlayerSession' AS StepInfo FROM CRMDemo.dbo.BIS2_VW_PlayerSession WHERE (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502')  UNION ALL SELECT 'Step 2' AS Step, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.CoinIn) AS CoinIn, 'CRMDemo.dbo.cqa' AS StepInfo FROM CRMDemo.dbo.BIS2_VW_PlayerSession INNER JOIN CRMDemo.dbo.cqa ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = CRMDemo.dbo.cqa.pk WHERE (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502')  AND (CRMDemo.dbo.cqa.allocation_id = '32a975063-14d6ec23654') UNION ALL SELECT 'Step 3' AS Step, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin, SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.CoinIn) AS CoinIn, 'BIS2_SQLTC_PlayerSummary' AS StepInfo FROM CRMDemo.dbo.BIS2_VW_PlayerSession INNER JOIN CRMDemo.dbo.cqa ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = CRMDemo.dbo.cqa.pk INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_PlayerSummary*/SELECT MAX(BIS2_VW_PlayerSession.GamingDate) AS LastDaywithPlay,CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID AS PlayerID,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.Win) AS ActualWin,CASE WHEN SUM(BIS2_VW_PlayerSession.TheoWin)<>0 THEN 100.0*SUM(BIS2_VW_PlayerSession.Win)/SUM(BIS2_VW_PlayerSession.TheoWin) ELSE 0 END AS ActualWinTheoWinRatio,Case WHEN count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) <> 0 THEN  sum(BIS2_VW_PlayerSession.TheoWin)/count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) ELSE 0 END AS ADT,Sum(BIS2_VW_PlayerSession.TheoWin)/cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS AMT,cast(count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) as decimal(10,4))/cast(Count(distinct cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(datepart(mm, BIS2_VW_PlayerSession.GamingDate) AS varchar(2)) + cast(datepart(yy, BIS2_VW_PlayerSession.GamingDate) AS varchar(2))) as decimal(10,2)) AS AMV,datediff(dd,max(cast(BIS2_VW_PlayerSession.GamingDate as varchar)),MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,CASE WHEN SUM(BIS2_VW_PlayerSession.TheoWin)<>0 THEN (SUM(BIS2_VW_PlayerSession.Freeplay)*100.0)/SUM(BIS2_VW_PlayerSession.TheoWin) ELSE 0 END AS FreeplayReinvestmentPct,CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then  datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end AS MeanTimeBetweenTrips,CASE WHEN SUM(case when GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)<>0 THEN (100.0*(SUM(case when   GamingDate>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)-SUM(case when   GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END)))/SUM(case when   GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.TheoWin ELSE 0 END) ELSE 0 END AS PercentChangeTheoWin,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID as varchar)+CASE WHEN GamingDate<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(BIS2_VW_PlayerSession.GamingDate as varchar) ELSE NULL END) ELSE 0 END AS PercentChangeVisits,SUM(CRMDemo.dbo.BIS2_VW_PlayerSession.TheoWin) AS TheoWin,CASE WHEN CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then   datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end <>0 THEN  datediff(dd,  max(cast(BIS2_VW_PlayerSession.GamingDate as varchar)),  MAX(BIS2_FN_SGStartEndDate.SGEndDate))/CASE when count(distinct BIS2_VW_PlayerSession.GamingDate)-1 <> 0 then   datediff(dd,min(BIS2_VW_PlayerSession.GamingDate), max(BIS2_VW_PlayerSession.GamingDate))/cast((count(distinct BIS2_VW_PlayerSession.GamingDate))-1 as decimal(15,2)) ELSE 0 end ELSE 0 END AS TripsOwed,case when cast(DATEDIFF(dd,max(BIS2_VW_PlayerSession.GamingDate),min(BIS2_VW_PlayerSession.GamingDate)) as decimal(15,2)) <> 0 then  (count(distinct BIS2_VW_PlayerSession.GamingDate)-1)/cast(DATEDIFF(dd,min(BIS2_VW_PlayerSession.GamingDate),max(dbo.BIS2_VW_PlayerSession.GamingDate)) as decimal(15,2))  ELSE 0 END AS VisitDensity,count(DISTINCT cast(BIS2_VW_PlayerSession.PlayerID AS varchar)+cast(BIS2_VW_PlayerSession.GamingDate as varchar)) AS Visits FROM CRMDemo.dbo.BIS2_VW_PlayerSession INNER HASH JOIN CRMDemo.dbo.BIS2_FN_SGStartEndDate('20130201 00:00:00','20130501 00:00:00') AS BIS2_FN_SGStartEndDate ON CRMDemo.dbo.BIS2_VW_PlayerSession.hackjoin = BIS2_FN_SGStartEndDate.HackJoin INNER JOIN CRMDemo.dbo.cqa ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = CRMDemo.dbo.cqa.pk WHERE ((CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131') AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502') AND (CRMDemo.dbo.cqa.allocation_id = '32a975063-14d6ec23654')) GROUP BY CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID/* End: BIS2_SQLTC_PlayerSummary*/) AS BIS2_SQLTC_PlayerSummary ON CRMDemo.dbo.BIS2_VW_PlayerSession.PlayerID = BIS2_SQLTC_PlayerSummary.PlayerID WHERE (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime >= '20130201 00:00:00')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate >= '20130131')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.EndTime < '20130501 00:00:00')  AND (CRMDemo.dbo.BIS2_VW_PlayerSession.GamingDate < '20130502')  AND (CRMDemo.dbo.cqa.allocation_id = '32a975063-14d6ec23654')
2016-10-01 10:19:01.662310: Now attempting to run the query for 32a970f6e-14d6ebf9480:
2016-10-01 10:19:01.673846: Attempting to connect to the database:
2016-10-01 10:19:06.775034: Database connection successful.