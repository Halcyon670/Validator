
2016-10-04 10:30:09.934984: Successfully purged prior log and started a new one.
2016-10-04 10:31:41.108202: Moving forward with the following docs: ['34cdb4f78-1572bb96312', '35054c327-14d4e2e337d', '34cf66448-1578c063b6b', '34e3597c2-15387972e80', '35153dd0a-14dde9b7dd0', '34cd37a43-1570fdd5aa3', '30dbbbacd-14cfdb3fe11', '35f1f66bd-14be1028139', '30db00c98-14cfc70d581', '350350359-14d113d69e1', '34cc52c7e-1525d161787', '34e3bed48-1539eb8644e', '34f311442-154badd3d4a', '34c682578-152570abfe9', '3502f802c-15679da5643']
2016-10-04 10:31:41.133217: Checking 34cdb4f78-1572bb96312 (Campaign Document, AV_C01):
	Query: SELECT sign(datepart(dd,BIS2_FN_Loyalty.Norm)) AS VBB2__NORM_FIELD,dbo.BIS2_VW_Patron.Account_Number AS AccNum,dbo.BIS2_VW_Patron.Residential_Address_2 AS Address2,dbo.BIS2_VW_Patron.Residential_Address_1 AS Address_1,dbo.BIS2_VW_Patron.Age AS Age,dbo.BIS2_VW_Patron.Birth_Date AS BirthDate,BIS2_FN_Loyalty.Birthday AS BirthdaySegment,isnull(DATENAME(mm,(BIS2_VW_Patron.birth_date)),'NA') AS BirthMonth,dbo.BIS2_VW_Card_Levels.Card_Type_White_Gold AS CardLevel,dbo.BIS2_VW_Cell.Phone_Fax_Email AS CellPhoneNum,dbo.BIS2_VW_Patron.Residential_City AS City,dbo.BIS2_Patron_Profile.EnrolledDate AS DateEnrolled,dbo.BIS2_VW_EMAIL.Phone_Fax_Email AS Email,dbo.BIS2_VW_Patron.Patron_First_Name AS FName,BIS2_FN_Loyalty.GamePreference AS GamePreference,dbo.BIS2_VW_Patron.Applicant_Sex AS Gender,dbo.BIS2_VW_Host_Master.HostName AS HostName,BIS2_FN_Loyalty.Inactive AS Inactive,BIS2_FN_Loyalty.LastTrip AS LastTrip,dbo.BIS2_VW_Patron.Patron_Last_Name AS LName,dbo.BIS2_VW_Patron.Mail_To_Code AS Mail_To,BIS2_FN_Loyalty.NewMember AS NewMember,BIS2_FN_Loyalty.Reactive AS Reactive,BIS2_FN_Loyalty.Segment AS Segment,dbo.BIS2_VW_Patron.Residential_State AS State,dbo.BIS2_VW_Patron.Zip3 AS Zip3,dbo.BIS2_VW_Patron.Zip5 AS Zip5,SUM(BIS2_FN_Loyalty.ActualHoldPCT) AS ActualHoldPCT,SUM(BIS2_FN_Loyalty.ActualWin) AS ActualWin,SUM(BIS2_FN_Loyalty.ADT) AS ADT,SUM(BIS2_FN_Loyalty.AMT) AS AMT,SUM(BIS2_FN_Loyalty.AMV) AS AMV,SUM(BIS2_FN_Loyalty.AvgBet) AS AvgBet,SUM(BIS2_FN_Loyalty.CoinIn) AS CoinIn,SUM(BIS2_FN_Loyalty.DaysSinceLastTrip) AS DaysSinceLastTrip,SUM(BIS2_FN_Loyalty.FirstPeriodTheoWin) AS FirstPeriodTheoWin,SUM(BIS2_FN_Loyalty.Freeplay) AS Freeplay,SUM(BIS2_FN_Loyalty.GamesPlayed) AS GamesPlayed,SUM(BIS2_FN_Loyalty.HoursPlayed) AS HoursPlayed,SUM(BIS2_FN_Loyalty.HoursPlayedperVisit) AS HoursPlayedperVisit,SUM(BIS2_FN_Loyalty.Jackpot) AS Jackpot,SUM(BIS2_FN_Loyalty.L6MADT) AS L6MADT,SUM(BIS2_FN_Loyalty.MeanTimeBetweenTrips) AS MeanTimeBetweenTrips,SUM(BIS2_FN_Loyalty.MonthswithPlay) AS MonthswithPlay,SUM(BIS2_FN_Loyalty.PlayerCount) AS PlayerCount,SUM(BIS2_FN_Loyalty.SecondPeriodTheoWin) AS SecondPeriodTheoWin,SUM(BIS2_FN_Loyalty.SlotTheoWin) AS SlotTheoWin,SUM(BIS2_FN_Loyalty.TableTheoWin) AS TableTheoWin,SUM(BIS2_FN_Loyalty.TheoHoldPCT) AS TheoHoldPCT,SUM(BIS2_FN_Loyalty.TheoWin) AS TheoWin,SUM(BIS2_FN_Loyalty.TheoWinperHour) AS TheoWinperHour,SUM(BIS2_FN_Loyalty.TripsOwed) AS TripsOwed,SUM(BIS2_FN_Loyalty.Visits) AS Visits FROM dbo.BIS2_FN_Loyalty('20160901 00:00:00','20160902 00:00:00') AS BIS2_FN_Loyalty INNER JOIN dbo.BIS2_VW_Patron ON BIS2_FN_Loyalty.PlayerID = dbo.BIS2_VW_Patron.Account_Number LEFT JOIN dbo.BIS2_VW_EMAIL ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_EMAIL.Account_Number LEFT JOIN dbo.BIS2_VW_Card_Levels ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Card_Levels.Account_Number LEFT JOIN dbo.BIS2_VW_Host_Patron ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Host_Patron.account_number LEFT JOIN dbo.BIS2_VW_Host_Master ON dbo.BIS2_VW_Host_Patron.rep_code = dbo.BIS2_VW_Host_Master.Rep_Code LEFT JOIN dbo.BIS2_VW_Cell ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Cell.Account_Number LEFT JOIN dbo.BIS2_Patron_Profile ON BIS2_FN_Loyalty.PlayerID = dbo.BIS2_Patron_Profile.AccountNumber GROUP BY sign(datepart(dd,BIS2_FN_Loyalty.Norm)),dbo.BIS2_VW_Patron.Account_Number,dbo.BIS2_VW_Patron.Residential_Address_2,dbo.BIS2_VW_Patron.Residential_Address_1,dbo.BIS2_VW_Patron.Age,dbo.BIS2_VW_Patron.Birth_Date,BIS2_FN_Loyalty.Birthday,isnull(DATENAME(mm,(BIS2_VW_Patron.birth_date)),'NA'),dbo.BIS2_VW_Card_Levels.Card_Type_White_Gold,dbo.BIS2_VW_Cell.Phone_Fax_Email,dbo.BIS2_VW_Patron.Residential_City,dbo.BIS2_Patron_Profile.EnrolledDate,dbo.BIS2_VW_EMAIL.Phone_Fax_Email,dbo.BIS2_VW_Patron.Patron_First_Name,BIS2_FN_Loyalty.GamePreference,dbo.BIS2_VW_Patron.Applicant_Sex,dbo.BIS2_VW_Host_Master.HostName,BIS2_FN_Loyalty.Inactive,BIS2_FN_Loyalty.LastTrip,dbo.BIS2_VW_Patron.Patron_Last_Name,dbo.BIS2_VW_Patron.Mail_To_Code,BIS2_FN_Loyalty.NewMember,BIS2_FN_Loyalty.Reactive,BIS2_FN_Loyalty.Segment,dbo.BIS2_VW_Patron.Residential_State,dbo.BIS2_VW_Patron.Zip3,dbo.BIS2_VW_Patron.Zip5
	DocAggs: ['ActualHoldPCT', 'ActualWin', 'ADT', 'AMT', 'AMV', 'AvgBet', 'CoinIn', 'DaysSinceLastTrip', 'FirstPeriodTheoWin', 'Freeplay', 'GamesPlayed', 'HoursPlayed', 'HoursPlayedperVisit', 'Jackpot', 'L6MADT', 'MeanTimeBetweenTrips', 'MonthswithPlay', 'PlayerCount', 'SecondPeriodTheoWin', 'SlotTheoWin', 'TableTheoWin', 'TheoHoldPCT', 'TheoWin', 'TheoWinperHour', 'TripsOwed']
	DocAggDict: {'FirstPeriodTheoWin': 'SUM(BIS2_FN_Loyalty.FirstPeriodTheoWin) AS FirstPeriodTheoWin', 'ActualWin': 'SUM(BIS2_FN_Loyalty.ActualWin) AS ActualWin', 'TheoWinperHour': 'SUM(BIS2_FN_Loyalty.TheoWinperHour) AS TheoWinperHour', 'SecondPeriodTheoWin': 'SUM(BIS2_FN_Loyalty.SecondPeriodTheoWin) AS SecondPeriodTheoWin', 'CoinIn': 'SUM(BIS2_FN_Loyalty.CoinIn) AS CoinIn', 'AMT': 'SUM(BIS2_FN_Loyalty.AMT) AS AMT', 'AMV': 'SUM(BIS2_FN_Loyalty.AMV) AS AMV', 'HoursPlayedperVisit': 'SUM(BIS2_FN_Loyalty.HoursPlayedperVisit) AS HoursPlayedperVisit', 'MonthswithPlay': 'SUM(BIS2_FN_Loyalty.MonthswithPlay) AS MonthswithPlay', 'TableTheoWin': 'SUM(BIS2_FN_Loyalty.TableTheoWin) AS TableTheoWin', 'Jackpot': 'SUM(BIS2_FN_Loyalty.Jackpot) AS Jackpot', 'HoursPlayed': 'SUM(BIS2_FN_Loyalty.HoursPlayed) AS HoursPlayed', 'SlotTheoWin': 'SUM(BIS2_FN_Loyalty.SlotTheoWin) AS SlotTheoWin', 'Freeplay': 'SUM(BIS2_FN_Loyalty.Freeplay) AS Freeplay', 'ActualHoldPCT': 'SUM(BIS2_FN_Loyalty.ActualHoldPCT) AS ActualHoldPCT', 'TripsOwed': 'SUM(BIS2_FN_Loyalty.TripsOwed) AS TripsOwed', 'AvgBet': 'SUM(BIS2_FN_Loyalty.AvgBet) AS AvgBet', 'GamesPlayed': 'SUM(BIS2_FN_Loyalty.GamesPlayed) AS GamesPlayed', 'TheoHoldPCT': 'SUM(BIS2_FN_Loyalty.TheoHoldPCT) AS TheoHoldPCT', 'PlayerCount': 'SUM(BIS2_FN_Loyalty.PlayerCount) AS PlayerCount', 'DaysSinceLastTrip': 'SUM(BIS2_FN_Loyalty.DaysSinceLastTrip) AS DaysSinceLastTrip', 'ADT': 'SUM(BIS2_FN_Loyalty.ADT) AS ADT', 'MeanTimeBetweenTrips': 'SUM(BIS2_FN_Loyalty.MeanTimeBetweenTrips) AS MeanTimeBetweenTrips', 'TheoWin': 'SUM(BIS2_FN_Loyalty.TheoWin) AS TheoWin', 'L6MADT': 'SUM(BIS2_FN_Loyalty.L6MADT) AS L6MADT'}
	DocJoins: ["dbo.BIS2_FN_Loyalty('20160901", 'dbo.BIS2_VW_Patron', 'dbo.BIS2_VW_EMAIL', 'dbo.BIS2_VW_Card_Levels', 'dbo.BIS2_VW_Host_Patron', 'dbo.BIS2_VW_Host_Master', 'dbo.BIS2_VW_Cell', 'dbo.BIS2_Patron_Profile']DocJoinDict: {"dbo.BIS2_FN_Loyalty('20160901": "FROM dbo.BIS2_FN_Loyalty('20160901 00:00:00','20160902 00:00:00') AS BIS2_FN_Loyalty ", 'dbo.BIS2_Patron_Profile': 'LEFT JOIN dbo.BIS2_Patron_Profile ON BIS2_FN_Loyalty.PlayerID = dbo.BIS2_Patron_Profile.AccountNumber ', 'dbo.BIS2_VW_Host_Master': 'LEFT JOIN dbo.BIS2_VW_Host_Master ON dbo.BIS2_VW_Host_Patron.rep_code = dbo.BIS2_VW_Host_Master.Rep_Code ', 'dbo.BIS2_VW_Host_Patron': 'LEFT JOIN dbo.BIS2_VW_Host_Patron ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Host_Patron.account_number ', 'dbo.BIS2_VW_Cell': 'LEFT JOIN dbo.BIS2_VW_Cell ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Cell.Account_Number ', 'dbo.BIS2_VW_Patron': 'INNER JOIN dbo.BIS2_VW_Patron ON BIS2_FN_Loyalty.PlayerID = dbo.BIS2_VW_Patron.Account_Number ', 'dbo.BIS2_VW_Card_Levels': 'LEFT JOIN dbo.BIS2_VW_Card_Levels ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Card_Levels.Account_Number ', 'dbo.BIS2_VW_EMAIL': 'LEFT JOIN dbo.BIS2_VW_EMAIL ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_EMAIL.Account_Number '}
	DocWhere: []
	DocWhereAnd: {}
2016-10-04 10:31:54.302119: Final data about 34cdb4f78-1572bb96312:
	UserAggList: ['ActualWin', 'CoinIn', 'Freeplay', 'GamesPlayed', 'TheoWin']
	UserRestrictList: []
	FinalQuery: SELECT 'Step 1' AS Step, SUM(BIS2_FN_Loyalty.ActualWin) AS ActualWin, SUM(BIS2_FN_Loyalty.CoinIn) AS CoinIn, SUM(BIS2_FN_Loyalty.Freeplay) AS Freeplay, SUM(BIS2_FN_Loyalty.GamesPlayed) AS GamesPlayed, SUM(BIS2_FN_Loyalty.TheoWin) AS TheoWin, 'dbo.BIS2_FN_Loyalty' AS StepInfo FROM dbo.BIS2_FN_Loyalty('20160901 00:00:00','20160902 00:00:00') AS BIS2_FN_Loyalty  UNION ALL SELECT 'Step 2' AS Step, SUM(BIS2_FN_Loyalty.ActualWin) AS ActualWin, SUM(BIS2_FN_Loyalty.CoinIn) AS CoinIn, SUM(BIS2_FN_Loyalty.Freeplay) AS Freeplay, SUM(BIS2_FN_Loyalty.GamesPlayed) AS GamesPlayed, SUM(BIS2_FN_Loyalty.TheoWin) AS TheoWin, 'dbo.BIS2_VW_Patron' AS StepInfo FROM dbo.BIS2_FN_Loyalty('20160901 00:00:00','20160902 00:00:00') AS BIS2_FN_Loyalty INNER JOIN dbo.BIS2_VW_Patron ON BIS2_FN_Loyalty.PlayerID = dbo.BIS2_VW_Patron.Account_Number  UNION ALL SELECT 'Step 3' AS Step, SUM(BIS2_FN_Loyalty.ActualWin) AS ActualWin, SUM(BIS2_FN_Loyalty.CoinIn) AS CoinIn, SUM(BIS2_FN_Loyalty.Freeplay) AS Freeplay, SUM(BIS2_FN_Loyalty.GamesPlayed) AS GamesPlayed, SUM(BIS2_FN_Loyalty.TheoWin) AS TheoWin, 'dbo.BIS2_VW_EMAIL' AS StepInfo FROM dbo.BIS2_FN_Loyalty('20160901 00:00:00','20160902 00:00:00') AS BIS2_FN_Loyalty INNER JOIN dbo.BIS2_VW_Patron ON BIS2_FN_Loyalty.PlayerID = dbo.BIS2_VW_Patron.Account_Number LEFT JOIN dbo.BIS2_VW_EMAIL ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_EMAIL.Account_Number  UNION ALL SELECT 'Step 4' AS Step, SUM(BIS2_FN_Loyalty.ActualWin) AS ActualWin, SUM(BIS2_FN_Loyalty.CoinIn) AS CoinIn, SUM(BIS2_FN_Loyalty.Freeplay) AS Freeplay, SUM(BIS2_FN_Loyalty.GamesPlayed) AS GamesPlayed, SUM(BIS2_FN_Loyalty.TheoWin) AS TheoWin, 'dbo.BIS2_VW_Card_Levels' AS StepInfo FROM dbo.BIS2_FN_Loyalty('20160901 00:00:00','20160902 00:00:00') AS BIS2_FN_Loyalty INNER JOIN dbo.BIS2_VW_Patron ON BIS2_FN_Loyalty.PlayerID = dbo.BIS2_VW_Patron.Account_Number LEFT JOIN dbo.BIS2_VW_EMAIL ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_EMAIL.Account_Number LEFT JOIN dbo.BIS2_VW_Card_Levels ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Card_Levels.Account_Number  UNION ALL SELECT 'Step 5' AS Step, SUM(BIS2_FN_Loyalty.ActualWin) AS ActualWin, SUM(BIS2_FN_Loyalty.CoinIn) AS CoinIn, SUM(BIS2_FN_Loyalty.Freeplay) AS Freeplay, SUM(BIS2_FN_Loyalty.GamesPlayed) AS GamesPlayed, SUM(BIS2_FN_Loyalty.TheoWin) AS TheoWin, 'dbo.BIS2_VW_Host_Patron' AS StepInfo FROM dbo.BIS2_FN_Loyalty('20160901 00:00:00','20160902 00:00:00') AS BIS2_FN_Loyalty INNER JOIN dbo.BIS2_VW_Patron ON BIS2_FN_Loyalty.PlayerID = dbo.BIS2_VW_Patron.Account_Number LEFT JOIN dbo.BIS2_VW_EMAIL ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_EMAIL.Account_Number LEFT JOIN dbo.BIS2_VW_Card_Levels ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Card_Levels.Account_Number LEFT JOIN dbo.BIS2_VW_Host_Patron ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Host_Patron.account_number  UNION ALL SELECT 'Step 6' AS Step, SUM(BIS2_FN_Loyalty.ActualWin) AS ActualWin, SUM(BIS2_FN_Loyalty.CoinIn) AS CoinIn, SUM(BIS2_FN_Loyalty.Freeplay) AS Freeplay, SUM(BIS2_FN_Loyalty.GamesPlayed) AS GamesPlayed, SUM(BIS2_FN_Loyalty.TheoWin) AS TheoWin, 'dbo.BIS2_VW_Host_Master' AS StepInfo FROM dbo.BIS2_FN_Loyalty('20160901 00:00:00','20160902 00:00:00') AS BIS2_FN_Loyalty INNER JOIN dbo.BIS2_VW_Patron ON BIS2_FN_Loyalty.PlayerID = dbo.BIS2_VW_Patron.Account_Number LEFT JOIN dbo.BIS2_VW_EMAIL ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_EMAIL.Account_Number LEFT JOIN dbo.BIS2_VW_Card_Levels ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Card_Levels.Account_Number LEFT JOIN dbo.BIS2_VW_Host_Patron ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Host_Patron.account_number LEFT JOIN dbo.BIS2_VW_Host_Master ON dbo.BIS2_VW_Host_Patron.rep_code = dbo.BIS2_VW_Host_Master.Rep_Code  UNION ALL SELECT 'Step 7' AS Step, SUM(BIS2_FN_Loyalty.ActualWin) AS ActualWin, SUM(BIS2_FN_Loyalty.CoinIn) AS CoinIn, SUM(BIS2_FN_Loyalty.Freeplay) AS Freeplay, SUM(BIS2_FN_Loyalty.GamesPlayed) AS GamesPlayed, SUM(BIS2_FN_Loyalty.TheoWin) AS TheoWin, 'dbo.BIS2_VW_Cell' AS StepInfo FROM dbo.BIS2_FN_Loyalty('20160901 00:00:00','20160902 00:00:00') AS BIS2_FN_Loyalty INNER JOIN dbo.BIS2_VW_Patron ON BIS2_FN_Loyalty.PlayerID = dbo.BIS2_VW_Patron.Account_Number LEFT JOIN dbo.BIS2_VW_EMAIL ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_EMAIL.Account_Number LEFT JOIN dbo.BIS2_VW_Card_Levels ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Card_Levels.Account_Number LEFT JOIN dbo.BIS2_VW_Host_Patron ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Host_Patron.account_number LEFT JOIN dbo.BIS2_VW_Host_Master ON dbo.BIS2_VW_Host_Patron.rep_code = dbo.BIS2_VW_Host_Master.Rep_Code LEFT JOIN dbo.BIS2_VW_Cell ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Cell.Account_Number  UNION ALL SELECT 'Step 8' AS Step, SUM(BIS2_FN_Loyalty.ActualWin) AS ActualWin, SUM(BIS2_FN_Loyalty.CoinIn) AS CoinIn, SUM(BIS2_FN_Loyalty.Freeplay) AS Freeplay, SUM(BIS2_FN_Loyalty.GamesPlayed) AS GamesPlayed, SUM(BIS2_FN_Loyalty.TheoWin) AS TheoWin, 'dbo.BIS2_Patron_Profile' AS StepInfo FROM dbo.BIS2_FN_Loyalty('20160901 00:00:00','20160902 00:00:00') AS BIS2_FN_Loyalty INNER JOIN dbo.BIS2_VW_Patron ON BIS2_FN_Loyalty.PlayerID = dbo.BIS2_VW_Patron.Account_Number LEFT JOIN dbo.BIS2_VW_EMAIL ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_EMAIL.Account_Number LEFT JOIN dbo.BIS2_VW_Card_Levels ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Card_Levels.Account_Number LEFT JOIN dbo.BIS2_VW_Host_Patron ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Host_Patron.account_number LEFT JOIN dbo.BIS2_VW_Host_Master ON dbo.BIS2_VW_Host_Patron.rep_code = dbo.BIS2_VW_Host_Master.Rep_Code LEFT JOIN dbo.BIS2_VW_Cell ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Cell.Account_Number LEFT JOIN dbo.BIS2_Patron_Profile ON BIS2_FN_Loyalty.PlayerID = dbo.BIS2_Patron_Profile.AccountNumber 
2016-10-04 10:31:54.462731: Checking 35054c327-14d4e2e337d (Player Count by Hour over Week, AV_T01):
	Query: SELECT datepart(yyyy,dbo.BIS2_VW_PlayerSession.Time_Started)*1000000 + datepart(mm,dbo.BIS2_VW_PlayerSession.Time_Started)*10000 + datepart(dd,dbo.BIS2_VW_PlayerSession.Time_Started)*100 + datepart(hh,dbo.BIS2_VW_PlayerSession.Time_Started) AS VBB2__NORM_FIELD,substring(datename(weekday, BIS2_VW_PlayerSession.Time_Started),1,3) AS DayofWeek,RIGHT('00' + RTRIM(datepart(dd,BIS2_VW_PlayerSession.Time_Started)), 2) AS Day_,RIGHT('00' + RTRIM(datepart(hh,BIS2_VW_PlayerSession.Time_Started)), 2) AS Hour_,substring(DATENAME(month, BIS2_VW_PlayerSession.Time_Started),1,3) AS MonthName,DATEPART(yyyy, BIS2_VW_PlayerSession.Time_Started)*1000000 + DATEPART(mm, BIS2_VW_PlayerSession.Time_Started)*10000 + DATEPART(dd, BIS2_VW_PlayerSession.Time_Started)*100 + DATEPART(hh, BIS2_VW_PlayerSession.Time_Started) AS NormHour,DATEPART(year,BIS2_VW_PlayerSession.Time_Started) AS Year_,SUM(dbo.BIS2_VW_PlayerSession.ActualWin) AS ActualWin,SUM(dbo.BIS2_VW_PlayerSession.coin_in_dollars_cents) AS CoinIn,SUM(dbo.BIS2_VW_PlayerSession.Handle_Pulls_Meter) AS GamesPlayed,SUM(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) AS HoursPlayed,SUM(dbo.BIS2_VW_PlayerSession.irs_jackpot_dol) AS Jackpot,count(distinct dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big) AS PlayerCount,SUM(ISNULL(dbo.BIS2_VW_PlayerSession.theo_loss_dol,0)) AS TheoWin FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID INNER HASH JOIN (/* SqlTableCalculator: PrefByDayOfWeek*/SELECT dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS AccountNum,substring(datename(weekday, BIS2_VW_PlayerSession.Time_Started),1,3) AS DayOfWeek,RIGHT('00' + RTRIM(datepart(hh,BIS2_VW_PlayerSession.Time_Started)), 2) AS Hour_,CASE WHEN MAX(VBB2__subQuery1.VBB2__PreferenceDenominator) <> 0 THEN (SUM(dbo.BIS2_VW_PlayerSession.theo_loss_dol) / MAX(VBB2__subQuery1.VBB2__PreferenceDenominator))* 100.0 ELSE 0 END AS VBB2__PreferencePercent FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_PlayerSummary*/SELECT MAX(BIS2_VW_PlayerSession.GamingDate) AS LastDaywithPlay,dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS PatronID,CASE WHEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) <> 0 THEN SUM(BIS2_VW_PlayerSession.ActualWin)/SUM(BIS2_VW_PlayerSession.theo_loss_dol) ELSE 0 END AS ActualWinTheoWinRatio,CASE WHEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) ELSE 0 END AS ADT,CASE WHEN CAST(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / CAST(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) ELSE 0 END AS AMT,CASE WHEN COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) <> 0 THEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal)/ COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) ELSE 0 END AS AMV,DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,SUM(dbo.BIS2_VW_PlayerSession.coin_out) AS FreeplayReinvestmentPCTDummy,CASE WHEN SUM(case when cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)<>0 THEN (100.0*(SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)-SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)))/SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END) ELSE 0 END AS PercentChangeTheoWin,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END) ELSE 0 END AS PercentChangeVisits,CASE WHEN (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END) <> 0 THEN DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate))/( (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END)) ELSE 0 END AS TripsOwed,SUM(dbo.BIS2_VW_PlayerSession.coin_in) AS VisitDensity,cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) AS Visits FROM dbo.BIS2_VW_PlayerSession INNER HASH JOIN dbo.BIS2_FN_SGStartEndDate('20140601 07:00:00','20150101 06:59:00') AS BIS2_FN_SGStartEndDate ON dbo.BIS2_VW_PlayerSession.hackjoin = BIS2_FN_SGStartEndDate.HackJoin INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102') AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf')) GROUP BY dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big/* End: BIS2_SQLTC_PlayerSummary*/) AS BIS2_SQLTC_PlayerSummary ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = BIS2_SQLTC_PlayerSummary.PatronID INNER JOIN (SELECT dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS AccountNum,CAST(SUM(dbo.BIS2_VW_PlayerSession.theo_loss_dol) AS DECIMAL (15,2)) AS VBB2__PreferenceDenominator FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_PlayerSummary*/SELECT MAX(BIS2_VW_PlayerSession.GamingDate) AS LastDaywithPlay,dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS PatronID,CASE WHEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) <> 0 THEN SUM(BIS2_VW_PlayerSession.ActualWin)/SUM(BIS2_VW_PlayerSession.theo_loss_dol) ELSE 0 END AS ActualWinTheoWinRatio,CASE WHEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) ELSE 0 END AS ADT,CASE WHEN CAST(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / CAST(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) ELSE 0 END AS AMT,CASE WHEN COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) <> 0 THEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal)/ COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) ELSE 0 END AS AMV,DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,SUM(dbo.BIS2_VW_PlayerSession.coin_out) AS FreeplayReinvestmentPCTDummy,CASE WHEN SUM(case when cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)<>0 THEN (100.0*(SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)-SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)))/SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END) ELSE 0 END AS PercentChangeTheoWin,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END) ELSE 0 END AS PercentChangeVisits,CASE WHEN (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END) <> 0 THEN DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate))/( (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END)) ELSE 0 END AS TripsOwed,SUM(dbo.BIS2_VW_PlayerSession.coin_in) AS VisitDensity,cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) AS Visits FROM dbo.BIS2_VW_PlayerSession INNER HASH JOIN dbo.BIS2_FN_SGStartEndDate('20140601 07:00:00','20150101 06:59:00') AS BIS2_FN_SGStartEndDate ON dbo.BIS2_VW_PlayerSession.hackjoin = BIS2_FN_SGStartEndDate.HackJoin INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102') AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf')) GROUP BY dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big/* End: BIS2_SQLTC_PlayerSummary*/) AS BIS2_SQLTC_PlayerSummary ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = BIS2_SQLTC_PlayerSummary.PatronID WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102') AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf') AND (BIS2_SQLTC_PlayerSummary.ADT >= 300.00)) GROUP BY dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big)  AS  VBB2__subQuery1 ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = VBB2__subQuery1.AccountNum WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102') AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf') AND (BIS2_SQLTC_PlayerSummary.ADT >= 300.00)) GROUP BY dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big,substring(datename(weekday, BIS2_VW_PlayerSession.Time_Started),1,3),RIGHT('00' + RTRIM(datepart(hh,BIS2_VW_PlayerSession.Time_Started)), 2) HAVING CASE WHEN MAX(VBB2__subQuery1.VBB2__PreferenceDenominator) <> 0 THEN (SUM(dbo.BIS2_VW_PlayerSession.theo_loss_dol) / MAX(VBB2__subQuery1.VBB2__PreferenceDenominator))* 100.0 ELSE 0 END >= 3/* End: PrefByDayOfWeek*/) AS PrefByDayOfWeek ON (dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = PrefByDayOfWeek.AccountNum AND dbo.BIS2_VW_PlayerSession.DayOfWeek = PrefByDayOfWeek.DayOfWeek AND dbo.BIS2_VW_PlayerSession.Hour_ = PrefByDayOfWeek.Hour_) INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_PlayerSummary*/SELECT MAX(BIS2_VW_PlayerSession.GamingDate) AS LastDaywithPlay,dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS PatronID,CASE WHEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) <> 0 THEN SUM(BIS2_VW_PlayerSession.ActualWin)/SUM(BIS2_VW_PlayerSession.theo_loss_dol) ELSE 0 END AS ActualWinTheoWinRatio,CASE WHEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) ELSE 0 END AS ADT,CASE WHEN CAST(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / CAST(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) ELSE 0 END AS AMT,CASE WHEN COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) <> 0 THEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal)/ COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) ELSE 0 END AS AMV,DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,SUM(dbo.BIS2_VW_PlayerSession.coin_out) AS FreeplayReinvestmentPCTDummy,CASE WHEN SUM(case when cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)<>0 THEN (100.0*(SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)-SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)))/SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END) ELSE 0 END AS PercentChangeTheoWin,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END) ELSE 0 END AS PercentChangeVisits,CASE WHEN (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END) <> 0 THEN DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate))/( (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END)) ELSE 0 END AS TripsOwed,SUM(dbo.BIS2_VW_PlayerSession.coin_in) AS VisitDensity,cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) AS Visits FROM dbo.BIS2_VW_PlayerSession INNER HASH JOIN dbo.BIS2_FN_SGStartEndDate('20140601 07:00:00','20150101 06:59:00') AS BIS2_FN_SGStartEndDate ON dbo.BIS2_VW_PlayerSession.hackjoin = BIS2_FN_SGStartEndDate.HackJoin INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102') AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf')) GROUP BY dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big/* End: BIS2_SQLTC_PlayerSummary*/) AS BIS2_SQLTC_PlayerSummary ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = BIS2_SQLTC_PlayerSummary.PatronID WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102') AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf') AND (BIS2_SQLTC_PlayerSummary.ADT >= 300.00)) GROUP BY datepart(yyyy,dbo.BIS2_VW_PlayerSession.Time_Started)*1000000 + datepart(mm,dbo.BIS2_VW_PlayerSession.Time_Started)*10000 + datepart(dd,dbo.BIS2_VW_PlayerSession.Time_Started)*100 + datepart(hh,dbo.BIS2_VW_PlayerSession.Time_Started),substring(datename(weekday, BIS2_VW_PlayerSession.Time_Started),1,3),RIGHT('00' + RTRIM(datepart(dd,BIS2_VW_PlayerSession.Time_Started)), 2),RIGHT('00' + RTRIM(datepart(hh,BIS2_VW_PlayerSession.Time_Started)), 2),substring(DATENAME(month, BIS2_VW_PlayerSession.Time_Started),1,3),DATEPART(yyyy, BIS2_VW_PlayerSession.Time_Started)*1000000 + DATEPART(mm, BIS2_VW_PlayerSession.Time_Started)*10000 + DATEPART(dd, BIS2_VW_PlayerSession.Time_Started)*100 + DATEPART(hh, BIS2_VW_PlayerSession.Time_Started),DATEPART(year,BIS2_VW_PlayerSession.Time_Started)
	DocAggs: ['ActualWin', 'CoinIn', 'GamesPlayed', 'HoursPlayed', 'Jackpot']
	DocAggDict: {'HoursPlayed': 'SUM(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) AS HoursPlayed', 'ActualWin': 'SUM(dbo.BIS2_VW_PlayerSession.ActualWin) AS ActualWin', 'Jackpot': 'SUM(dbo.BIS2_VW_PlayerSession.irs_jackpot_dol) AS Jackpot', 'CoinIn': 'SUM(dbo.BIS2_VW_PlayerSession.coin_in_dollars_cents) AS CoinIn', 'GamesPlayed': 'SUM(dbo.BIS2_VW_PlayerSession.Handle_Pulls_Meter) AS GamesPlayed'}
	DocJoins: ['dbo.BIS2_VW_PlayerSession', 'dbo.BIS2_VW_Patron', 'dbo.SelectionList', 'PrefByDayOfWeek', 'BIS2_SQLTC_PlayerSummary']DocJoinDict: {'dbo.BIS2_VW_Patron': 'INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number ', 'PrefByDayOfWeek': "INNER HASH JOIN (/* SqlTableCalculator: PrefByDayOfWeek*/SELECT dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS AccountNum,substring(datename(weekday, BIS2_VW_PlayerSession.Time_Started),1,3) AS DayOfWeek,RIGHT('00' + RTRIM(datepart(hh,BIS2_VW_PlayerSession.Time_Started)), 2) AS Hour_,CASE WHEN MAX(VBB2__subQuery1.VBB2__PreferenceDenominator) <> 0 THEN (SUM(dbo.BIS2_VW_PlayerSession.theo_loss_dol) / MAX(VBB2__subQuery1.VBB2__PreferenceDenominator))* 100.0 ELSE 0 END AS VBB2__PreferencePercent FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_PlayerSummary*/SELECT MAX(BIS2_VW_PlayerSession.GamingDate) AS LastDaywithPlay,dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS PatronID,CASE WHEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) <> 0 THEN SUM(BIS2_VW_PlayerSession.ActualWin)/SUM(BIS2_VW_PlayerSession.theo_loss_dol) ELSE 0 END AS ActualWinTheoWinRatio,CASE WHEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) ELSE 0 END AS ADT,CASE WHEN CAST(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / CAST(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) ELSE 0 END AS AMT,CASE WHEN COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) <> 0 THEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal)/ COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) ELSE 0 END AS AMV,DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,SUM(dbo.BIS2_VW_PlayerSession.coin_out) AS FreeplayReinvestmentPCTDummy,CASE WHEN SUM(case when cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)<>0 THEN (100.0*(SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)-SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)))/SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END) ELSE 0 END AS PercentChangeTheoWin,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END) ELSE 0 END AS PercentChangeVisits,CASE WHEN (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END) <> 0 THEN DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate))/( (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END)) ELSE 0 END AS TripsOwed,SUM(dbo.BIS2_VW_PlayerSession.coin_in) AS VisitDensity,cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) AS Visits FROM dbo.BIS2_VW_PlayerSession INNER HASH JOIN dbo.BIS2_FN_SGStartEndDate('20140601 07:00:00','20150101 06:59:00') AS BIS2_FN_SGStartEndDate ON dbo.BIS2_VW_PlayerSession.hackjoin = BIS2_FN_SGStartEndDate.HackJoin INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102') AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf')) GROUP BY dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big/* End: BIS2_SQLTC_PlayerSummary*/) AS BIS2_SQLTC_PlayerSummary ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = BIS2_SQLTC_PlayerSummary.PatronID INNER JOIN (SELECT dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS AccountNum,CAST(SUM(dbo.BIS2_VW_PlayerSession.theo_loss_dol) AS DECIMAL (15,2)) AS VBB2__PreferenceDenominator FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_PlayerSummary*/SELECT MAX(BIS2_VW_PlayerSession.GamingDate) AS LastDaywithPlay,dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS PatronID,CASE WHEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) <> 0 THEN SUM(BIS2_VW_PlayerSession.ActualWin)/SUM(BIS2_VW_PlayerSession.theo_loss_dol) ELSE 0 END AS ActualWinTheoWinRatio,CASE WHEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) ELSE 0 END AS ADT,CASE WHEN CAST(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / CAST(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) ELSE 0 END AS AMT,CASE WHEN COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) <> 0 THEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal)/ COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) ELSE 0 END AS AMV,DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,SUM(dbo.BIS2_VW_PlayerSession.coin_out) AS FreeplayReinvestmentPCTDummy,CASE WHEN SUM(case when cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)<>0 THEN (100.0*(SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)-SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)))/SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END) ELSE 0 END AS PercentChangeTheoWin,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END) ELSE 0 END AS PercentChangeVisits,CASE WHEN (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END) <> 0 THEN DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate))/( (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END)) ELSE 0 END AS TripsOwed,SUM(dbo.BIS2_VW_PlayerSession.coin_in) AS VisitDensity,cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) AS Visits FROM dbo.BIS2_VW_PlayerSession INNER HASH JOIN dbo.BIS2_FN_SGStartEndDate('20140601 07:00:00','20150101 06:59:00') AS BIS2_FN_SGStartEndDate ON dbo.BIS2_VW_PlayerSession.hackjoin = BIS2_FN_SGStartEndDate.HackJoin INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102') AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf')) GROUP BY dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big/* End: BIS2_SQLTC_PlayerSummary*/) AS BIS2_SQLTC_PlayerSummary ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = BIS2_SQLTC_PlayerSummary.PatronID WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102') AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf') AND (BIS2_SQLTC_PlayerSummary.ADT >= 300.00)) GROUP BY dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big)  AS  VBB2__subQuery1 ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = VBB2__subQuery1.AccountNum WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102') AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf') AND (BIS2_SQLTC_PlayerSummary.ADT >= 300.00)) GROUP BY dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big,substring(datename(weekday, BIS2_VW_PlayerSession.Time_Started),1,3),RIGHT('00' + RTRIM(datepart(hh,BIS2_VW_PlayerSession.Time_Started)), 2) HAVING CASE WHEN MAX(VBB2__subQuery1.VBB2__PreferenceDenominator) <> 0 THEN (SUM(dbo.BIS2_VW_PlayerSession.theo_loss_dol) / MAX(VBB2__subQuery1.VBB2__PreferenceDenominator))* 100.0 ELSE 0 END >= 3/* End: PrefByDayOfWeek*/) AS PrefByDayOfWeek ON (dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = PrefByDayOfWeek.AccountNum AND dbo.BIS2_VW_PlayerSession.DayOfWeek = PrefByDayOfWeek.DayOfWeek AND dbo.BIS2_VW_PlayerSession.Hour_ = PrefByDayOfWeek.Hour_) ", 'dbo.SelectionList': 'INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID ', 'dbo.BIS2_VW_PlayerSession': 'FROM dbo.BIS2_VW_PlayerSession ', 'BIS2_SQLTC_PlayerSummary': "INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_PlayerSummary*/SELECT MAX(BIS2_VW_PlayerSession.GamingDate) AS LastDaywithPlay,dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS PatronID,CASE WHEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) <> 0 THEN SUM(BIS2_VW_PlayerSession.ActualWin)/SUM(BIS2_VW_PlayerSession.theo_loss_dol) ELSE 0 END AS ActualWinTheoWinRatio,CASE WHEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) ELSE 0 END AS ADT,CASE WHEN CAST(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / CAST(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) ELSE 0 END AS AMT,CASE WHEN COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) <> 0 THEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal)/ COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) ELSE 0 END AS AMV,DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,SUM(dbo.BIS2_VW_PlayerSession.coin_out) AS FreeplayReinvestmentPCTDummy,CASE WHEN SUM(case when cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)<>0 THEN (100.0*(SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)-SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)))/SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END) ELSE 0 END AS PercentChangeTheoWin,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END) ELSE 0 END AS PercentChangeVisits,CASE WHEN (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END) <> 0 THEN DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate))/( (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END)) ELSE 0 END AS TripsOwed,SUM(dbo.BIS2_VW_PlayerSession.coin_in) AS VisitDensity,cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) AS Visits FROM dbo.BIS2_VW_PlayerSession INNER HASH JOIN dbo.BIS2_FN_SGStartEndDate('20140601 07:00:00','20150101 06:59:00') AS BIS2_FN_SGStartEndDate ON dbo.BIS2_VW_PlayerSession.hackjoin = BIS2_FN_SGStartEndDate.HackJoin INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102') AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf')) GROUP BY dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big/* End: BIS2_SQLTC_PlayerSummary*/) AS BIS2_SQLTC_PlayerSummary ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = BIS2_SQLTC_PlayerSummary.PatronID "}
	DocWhere: ["(dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00') ", "(dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00') ", "(dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531') ", "(dbo.BIS2_VW_PlayerSession.GamingDate < '20150102') ", "(dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf') ", '(BIS2_SQLTC_PlayerSummary.ADT >= 300.00)']
	DocWhereAnd: {'(BIS2_SQLTC_PlayerSummary.ADT >= 300.00)': 'AND ', "(dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00') ": 'AND ', "(dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531') ": 'AND ', "(dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf') ": 'AND ', "(dbo.BIS2_VW_PlayerSession.GamingDate < '20150102') ": 'AND ', "(dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00') ": 'start'}
2016-10-04 10:32:03.737363: Final data about 35054c327-14d4e2e337d:
	UserAggList: ['ActualWin', 'CoinIn', 'GamesPlayed', 'HoursPlayed', 'Jackpot']
	UserRestrictList: ["(dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf') ", '(BIS2_SQLTC_PlayerSummary.ADT >= 300.00)']
	FinalQuery: SELECT 'Step 1' AS Step, SUM(dbo.BIS2_VW_PlayerSession.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_PlayerSession.coin_in_dollars_cents) AS CoinIn, SUM(dbo.BIS2_VW_PlayerSession.Handle_Pulls_Meter) AS GamesPlayed, SUM(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) AS HoursPlayed, SUM(dbo.BIS2_VW_PlayerSession.irs_jackpot_dol) AS Jackpot, 'dbo.BIS2_VW_PlayerSession' AS StepInfo FROM dbo.BIS2_VW_PlayerSession WHERE (dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00')  AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531')  AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00')  AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102')  UNION ALL SELECT 'Step 2' AS Step, SUM(dbo.BIS2_VW_PlayerSession.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_PlayerSession.coin_in_dollars_cents) AS CoinIn, SUM(dbo.BIS2_VW_PlayerSession.Handle_Pulls_Meter) AS GamesPlayed, SUM(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) AS HoursPlayed, SUM(dbo.BIS2_VW_PlayerSession.irs_jackpot_dol) AS Jackpot, 'dbo.BIS2_VW_Patron' AS StepInfo FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number WHERE (dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00')  AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531')  AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00')  AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102')  UNION ALL SELECT 'Step 3' AS Step, SUM(dbo.BIS2_VW_PlayerSession.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_PlayerSession.coin_in_dollars_cents) AS CoinIn, SUM(dbo.BIS2_VW_PlayerSession.Handle_Pulls_Meter) AS GamesPlayed, SUM(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) AS HoursPlayed, SUM(dbo.BIS2_VW_PlayerSession.irs_jackpot_dol) AS Jackpot, 'dbo.SelectionList' AS StepInfo FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID WHERE (dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00')  AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531')  AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00')  AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102')  UNION ALL SELECT 'Step 3B' AS Step, SUM(dbo.BIS2_VW_PlayerSession.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_PlayerSession.coin_in_dollars_cents) AS CoinIn, SUM(dbo.BIS2_VW_PlayerSession.Handle_Pulls_Meter) AS GamesPlayed, SUM(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) AS HoursPlayed, SUM(dbo.BIS2_VW_PlayerSession.irs_jackpot_dol) AS Jackpot, 'dbo.SelectionList (Restriction)' AS StepInfo FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID WHERE (dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00')  AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531')  AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00')  AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102')  AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf')  UNION ALL SELECT 'Step 4' AS Step, SUM(dbo.BIS2_VW_PlayerSession.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_PlayerSession.coin_in_dollars_cents) AS CoinIn, SUM(dbo.BIS2_VW_PlayerSession.Handle_Pulls_Meter) AS GamesPlayed, SUM(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) AS HoursPlayed, SUM(dbo.BIS2_VW_PlayerSession.irs_jackpot_dol) AS Jackpot, 'PrefByDayOfWeek' AS StepInfo FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID INNER HASH JOIN (/* SqlTableCalculator: PrefByDayOfWeek*/SELECT dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS AccountNum,substring(datename(weekday, BIS2_VW_PlayerSession.Time_Started),1,3) AS DayOfWeek,RIGHT('00' + RTRIM(datepart(hh,BIS2_VW_PlayerSession.Time_Started)), 2) AS Hour_,CASE WHEN MAX(VBB2__subQuery1.VBB2__PreferenceDenominator) <> 0 THEN (SUM(dbo.BIS2_VW_PlayerSession.theo_loss_dol) / MAX(VBB2__subQuery1.VBB2__PreferenceDenominator))* 100.0 ELSE 0 END AS VBB2__PreferencePercent FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_PlayerSummary*/SELECT MAX(BIS2_VW_PlayerSession.GamingDate) AS LastDaywithPlay,dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS PatronID,CASE WHEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) <> 0 THEN SUM(BIS2_VW_PlayerSession.ActualWin)/SUM(BIS2_VW_PlayerSession.theo_loss_dol) ELSE 0 END AS ActualWinTheoWinRatio,CASE WHEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) ELSE 0 END AS ADT,CASE WHEN CAST(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / CAST(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) ELSE 0 END AS AMT,CASE WHEN COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) <> 0 THEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal)/ COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) ELSE 0 END AS AMV,DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,SUM(dbo.BIS2_VW_PlayerSession.coin_out) AS FreeplayReinvestmentPCTDummy,CASE WHEN SUM(case when cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)<>0 THEN (100.0*(SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)-SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)))/SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END) ELSE 0 END AS PercentChangeTheoWin,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END) ELSE 0 END AS PercentChangeVisits,CASE WHEN (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END) <> 0 THEN DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate))/( (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END)) ELSE 0 END AS TripsOwed,SUM(dbo.BIS2_VW_PlayerSession.coin_in) AS VisitDensity,cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) AS Visits FROM dbo.BIS2_VW_PlayerSession INNER HASH JOIN dbo.BIS2_FN_SGStartEndDate('20140601 07:00:00','20150101 06:59:00') AS BIS2_FN_SGStartEndDate ON dbo.BIS2_VW_PlayerSession.hackjoin = BIS2_FN_SGStartEndDate.HackJoin INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102') AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf')) GROUP BY dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big/* End: BIS2_SQLTC_PlayerSummary*/) AS BIS2_SQLTC_PlayerSummary ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = BIS2_SQLTC_PlayerSummary.PatronID INNER JOIN (SELECT dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS AccountNum,CAST(SUM(dbo.BIS2_VW_PlayerSession.theo_loss_dol) AS DECIMAL (15,2)) AS VBB2__PreferenceDenominator FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_PlayerSummary*/SELECT MAX(BIS2_VW_PlayerSession.GamingDate) AS LastDaywithPlay,dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS PatronID,CASE WHEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) <> 0 THEN SUM(BIS2_VW_PlayerSession.ActualWin)/SUM(BIS2_VW_PlayerSession.theo_loss_dol) ELSE 0 END AS ActualWinTheoWinRatio,CASE WHEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) ELSE 0 END AS ADT,CASE WHEN CAST(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / CAST(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) ELSE 0 END AS AMT,CASE WHEN COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) <> 0 THEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal)/ COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) ELSE 0 END AS AMV,DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,SUM(dbo.BIS2_VW_PlayerSession.coin_out) AS FreeplayReinvestmentPCTDummy,CASE WHEN SUM(case when cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)<>0 THEN (100.0*(SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)-SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)))/SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END) ELSE 0 END AS PercentChangeTheoWin,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END) ELSE 0 END AS PercentChangeVisits,CASE WHEN (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END) <> 0 THEN DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate))/( (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END)) ELSE 0 END AS TripsOwed,SUM(dbo.BIS2_VW_PlayerSession.coin_in) AS VisitDensity,cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) AS Visits FROM dbo.BIS2_VW_PlayerSession INNER HASH JOIN dbo.BIS2_FN_SGStartEndDate('20140601 07:00:00','20150101 06:59:00') AS BIS2_FN_SGStartEndDate ON dbo.BIS2_VW_PlayerSession.hackjoin = BIS2_FN_SGStartEndDate.HackJoin INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102') AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf')) GROUP BY dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big/* End: BIS2_SQLTC_PlayerSummary*/) AS BIS2_SQLTC_PlayerSummary ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = BIS2_SQLTC_PlayerSummary.PatronID WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102') AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf') AND (BIS2_SQLTC_PlayerSummary.ADT >= 300.00)) GROUP BY dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big)  AS  VBB2__subQuery1 ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = VBB2__subQuery1.AccountNum WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102') AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf') AND (BIS2_SQLTC_PlayerSummary.ADT >= 300.00)) GROUP BY dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big,substring(datename(weekday, BIS2_VW_PlayerSession.Time_Started),1,3),RIGHT('00' + RTRIM(datepart(hh,BIS2_VW_PlayerSession.Time_Started)), 2) HAVING CASE WHEN MAX(VBB2__subQuery1.VBB2__PreferenceDenominator) <> 0 THEN (SUM(dbo.BIS2_VW_PlayerSession.theo_loss_dol) / MAX(VBB2__subQuery1.VBB2__PreferenceDenominator))* 100.0 ELSE 0 END >= 3/* End: PrefByDayOfWeek*/) AS PrefByDayOfWeek ON (dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = PrefByDayOfWeek.AccountNum AND dbo.BIS2_VW_PlayerSession.DayOfWeek = PrefByDayOfWeek.DayOfWeek AND dbo.BIS2_VW_PlayerSession.Hour_ = PrefByDayOfWeek.Hour_) WHERE (dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00')  AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531')  AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00')  AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102')  AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf')  UNION ALL SELECT 'Step 5' AS Step, SUM(dbo.BIS2_VW_PlayerSession.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_PlayerSession.coin_in_dollars_cents) AS CoinIn, SUM(dbo.BIS2_VW_PlayerSession.Handle_Pulls_Meter) AS GamesPlayed, SUM(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) AS HoursPlayed, SUM(dbo.BIS2_VW_PlayerSession.irs_jackpot_dol) AS Jackpot, 'BIS2_SQLTC_PlayerSummary' AS StepInfo FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID INNER HASH JOIN (/* SqlTableCalculator: PrefByDayOfWeek*/SELECT dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS AccountNum,substring(datename(weekday, BIS2_VW_PlayerSession.Time_Started),1,3) AS DayOfWeek,RIGHT('00' + RTRIM(datepart(hh,BIS2_VW_PlayerSession.Time_Started)), 2) AS Hour_,CASE WHEN MAX(VBB2__subQuery1.VBB2__PreferenceDenominator) <> 0 THEN (SUM(dbo.BIS2_VW_PlayerSession.theo_loss_dol) / MAX(VBB2__subQuery1.VBB2__PreferenceDenominator))* 100.0 ELSE 0 END AS VBB2__PreferencePercent FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_PlayerSummary*/SELECT MAX(BIS2_VW_PlayerSession.GamingDate) AS LastDaywithPlay,dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS PatronID,CASE WHEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) <> 0 THEN SUM(BIS2_VW_PlayerSession.ActualWin)/SUM(BIS2_VW_PlayerSession.theo_loss_dol) ELSE 0 END AS ActualWinTheoWinRatio,CASE WHEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) ELSE 0 END AS ADT,CASE WHEN CAST(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / CAST(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) ELSE 0 END AS AMT,CASE WHEN COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) <> 0 THEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal)/ COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) ELSE 0 END AS AMV,DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,SUM(dbo.BIS2_VW_PlayerSession.coin_out) AS FreeplayReinvestmentPCTDummy,CASE WHEN SUM(case when cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)<>0 THEN (100.0*(SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)-SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)))/SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END) ELSE 0 END AS PercentChangeTheoWin,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END) ELSE 0 END AS PercentChangeVisits,CASE WHEN (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END) <> 0 THEN DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate))/( (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END)) ELSE 0 END AS TripsOwed,SUM(dbo.BIS2_VW_PlayerSession.coin_in) AS VisitDensity,cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) AS Visits FROM dbo.BIS2_VW_PlayerSession INNER HASH JOIN dbo.BIS2_FN_SGStartEndDate('20140601 07:00:00','20150101 06:59:00') AS BIS2_FN_SGStartEndDate ON dbo.BIS2_VW_PlayerSession.hackjoin = BIS2_FN_SGStartEndDate.HackJoin INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102') AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf')) GROUP BY dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big/* End: BIS2_SQLTC_PlayerSummary*/) AS BIS2_SQLTC_PlayerSummary ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = BIS2_SQLTC_PlayerSummary.PatronID INNER JOIN (SELECT dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS AccountNum,CAST(SUM(dbo.BIS2_VW_PlayerSession.theo_loss_dol) AS DECIMAL (15,2)) AS VBB2__PreferenceDenominator FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_PlayerSummary*/SELECT MAX(BIS2_VW_PlayerSession.GamingDate) AS LastDaywithPlay,dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS PatronID,CASE WHEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) <> 0 THEN SUM(BIS2_VW_PlayerSession.ActualWin)/SUM(BIS2_VW_PlayerSession.theo_loss_dol) ELSE 0 END AS ActualWinTheoWinRatio,CASE WHEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) ELSE 0 END AS ADT,CASE WHEN CAST(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / CAST(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) ELSE 0 END AS AMT,CASE WHEN COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) <> 0 THEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal)/ COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) ELSE 0 END AS AMV,DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,SUM(dbo.BIS2_VW_PlayerSession.coin_out) AS FreeplayReinvestmentPCTDummy,CASE WHEN SUM(case when cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)<>0 THEN (100.0*(SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)-SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)))/SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END) ELSE 0 END AS PercentChangeTheoWin,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END) ELSE 0 END AS PercentChangeVisits,CASE WHEN (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END) <> 0 THEN DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate))/( (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END)) ELSE 0 END AS TripsOwed,SUM(dbo.BIS2_VW_PlayerSession.coin_in) AS VisitDensity,cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) AS Visits FROM dbo.BIS2_VW_PlayerSession INNER HASH JOIN dbo.BIS2_FN_SGStartEndDate('20140601 07:00:00','20150101 06:59:00') AS BIS2_FN_SGStartEndDate ON dbo.BIS2_VW_PlayerSession.hackjoin = BIS2_FN_SGStartEndDate.HackJoin INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102') AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf')) GROUP BY dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big/* End: BIS2_SQLTC_PlayerSummary*/) AS BIS2_SQLTC_PlayerSummary ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = BIS2_SQLTC_PlayerSummary.PatronID WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102') AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf') AND (BIS2_SQLTC_PlayerSummary.ADT >= 300.00)) GROUP BY dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big)  AS  VBB2__subQuery1 ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = VBB2__subQuery1.AccountNum WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102') AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf') AND (BIS2_SQLTC_PlayerSummary.ADT >= 300.00)) GROUP BY dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big,substring(datename(weekday, BIS2_VW_PlayerSession.Time_Started),1,3),RIGHT('00' + RTRIM(datepart(hh,BIS2_VW_PlayerSession.Time_Started)), 2) HAVING CASE WHEN MAX(VBB2__subQuery1.VBB2__PreferenceDenominator) <> 0 THEN (SUM(dbo.BIS2_VW_PlayerSession.theo_loss_dol) / MAX(VBB2__subQuery1.VBB2__PreferenceDenominator))* 100.0 ELSE 0 END >= 3/* End: PrefByDayOfWeek*/) AS PrefByDayOfWeek ON (dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = PrefByDayOfWeek.AccountNum AND dbo.BIS2_VW_PlayerSession.DayOfWeek = PrefByDayOfWeek.DayOfWeek AND dbo.BIS2_VW_PlayerSession.Hour_ = PrefByDayOfWeek.Hour_) INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_PlayerSummary*/SELECT MAX(BIS2_VW_PlayerSession.GamingDate) AS LastDaywithPlay,dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS PatronID,CASE WHEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) <> 0 THEN SUM(BIS2_VW_PlayerSession.ActualWin)/SUM(BIS2_VW_PlayerSession.theo_loss_dol) ELSE 0 END AS ActualWinTheoWinRatio,CASE WHEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) ELSE 0 END AS ADT,CASE WHEN CAST(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / CAST(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) ELSE 0 END AS AMT,CASE WHEN COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) <> 0 THEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal)/ COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) ELSE 0 END AS AMV,DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,SUM(dbo.BIS2_VW_PlayerSession.coin_out) AS FreeplayReinvestmentPCTDummy,CASE WHEN SUM(case when cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)<>0 THEN (100.0*(SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)-SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)))/SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END) ELSE 0 END AS PercentChangeTheoWin,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END) ELSE 0 END AS PercentChangeVisits,CASE WHEN (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END) <> 0 THEN DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate))/( (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END)) ELSE 0 END AS TripsOwed,SUM(dbo.BIS2_VW_PlayerSession.coin_in) AS VisitDensity,cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) AS Visits FROM dbo.BIS2_VW_PlayerSession INNER HASH JOIN dbo.BIS2_FN_SGStartEndDate('20140601 07:00:00','20150101 06:59:00') AS BIS2_FN_SGStartEndDate ON dbo.BIS2_VW_PlayerSession.hackjoin = BIS2_FN_SGStartEndDate.HackJoin INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102') AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf')) GROUP BY dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big/* End: BIS2_SQLTC_PlayerSummary*/) AS BIS2_SQLTC_PlayerSummary ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = BIS2_SQLTC_PlayerSummary.PatronID WHERE (dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00')  AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531')  AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00')  AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102')  AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf')  UNION ALL SELECT 'Step 5B' AS Step, SUM(dbo.BIS2_VW_PlayerSession.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_PlayerSession.coin_in_dollars_cents) AS CoinIn, SUM(dbo.BIS2_VW_PlayerSession.Handle_Pulls_Meter) AS GamesPlayed, SUM(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) AS HoursPlayed, SUM(dbo.BIS2_VW_PlayerSession.irs_jackpot_dol) AS Jackpot, 'BIS2_SQLTC_PlayerSummary (Restriction)' AS StepInfo FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID INNER HASH JOIN (/* SqlTableCalculator: PrefByDayOfWeek*/SELECT dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS AccountNum,substring(datename(weekday, BIS2_VW_PlayerSession.Time_Started),1,3) AS DayOfWeek,RIGHT('00' + RTRIM(datepart(hh,BIS2_VW_PlayerSession.Time_Started)), 2) AS Hour_,CASE WHEN MAX(VBB2__subQuery1.VBB2__PreferenceDenominator) <> 0 THEN (SUM(dbo.BIS2_VW_PlayerSession.theo_loss_dol) / MAX(VBB2__subQuery1.VBB2__PreferenceDenominator))* 100.0 ELSE 0 END AS VBB2__PreferencePercent FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_PlayerSummary*/SELECT MAX(BIS2_VW_PlayerSession.GamingDate) AS LastDaywithPlay,dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS PatronID,CASE WHEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) <> 0 THEN SUM(BIS2_VW_PlayerSession.ActualWin)/SUM(BIS2_VW_PlayerSession.theo_loss_dol) ELSE 0 END AS ActualWinTheoWinRatio,CASE WHEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) ELSE 0 END AS ADT,CASE WHEN CAST(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / CAST(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) ELSE 0 END AS AMT,CASE WHEN COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) <> 0 THEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal)/ COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) ELSE 0 END AS AMV,DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,SUM(dbo.BIS2_VW_PlayerSession.coin_out) AS FreeplayReinvestmentPCTDummy,CASE WHEN SUM(case when cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)<>0 THEN (100.0*(SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)-SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)))/SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END) ELSE 0 END AS PercentChangeTheoWin,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END) ELSE 0 END AS PercentChangeVisits,CASE WHEN (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END) <> 0 THEN DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate))/( (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END)) ELSE 0 END AS TripsOwed,SUM(dbo.BIS2_VW_PlayerSession.coin_in) AS VisitDensity,cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) AS Visits FROM dbo.BIS2_VW_PlayerSession INNER HASH JOIN dbo.BIS2_FN_SGStartEndDate('20140601 07:00:00','20150101 06:59:00') AS BIS2_FN_SGStartEndDate ON dbo.BIS2_VW_PlayerSession.hackjoin = BIS2_FN_SGStartEndDate.HackJoin INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102') AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf')) GROUP BY dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big/* End: BIS2_SQLTC_PlayerSummary*/) AS BIS2_SQLTC_PlayerSummary ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = BIS2_SQLTC_PlayerSummary.PatronID INNER JOIN (SELECT dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS AccountNum,CAST(SUM(dbo.BIS2_VW_PlayerSession.theo_loss_dol) AS DECIMAL (15,2)) AS VBB2__PreferenceDenominator FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_PlayerSummary*/SELECT MAX(BIS2_VW_PlayerSession.GamingDate) AS LastDaywithPlay,dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS PatronID,CASE WHEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) <> 0 THEN SUM(BIS2_VW_PlayerSession.ActualWin)/SUM(BIS2_VW_PlayerSession.theo_loss_dol) ELSE 0 END AS ActualWinTheoWinRatio,CASE WHEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) ELSE 0 END AS ADT,CASE WHEN CAST(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / CAST(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) ELSE 0 END AS AMT,CASE WHEN COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) <> 0 THEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal)/ COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) ELSE 0 END AS AMV,DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,SUM(dbo.BIS2_VW_PlayerSession.coin_out) AS FreeplayReinvestmentPCTDummy,CASE WHEN SUM(case when cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)<>0 THEN (100.0*(SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)-SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)))/SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END) ELSE 0 END AS PercentChangeTheoWin,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END) ELSE 0 END AS PercentChangeVisits,CASE WHEN (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END) <> 0 THEN DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate))/( (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END)) ELSE 0 END AS TripsOwed,SUM(dbo.BIS2_VW_PlayerSession.coin_in) AS VisitDensity,cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) AS Visits FROM dbo.BIS2_VW_PlayerSession INNER HASH JOIN dbo.BIS2_FN_SGStartEndDate('20140601 07:00:00','20150101 06:59:00') AS BIS2_FN_SGStartEndDate ON dbo.BIS2_VW_PlayerSession.hackjoin = BIS2_FN_SGStartEndDate.HackJoin INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102') AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf')) GROUP BY dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big/* End: BIS2_SQLTC_PlayerSummary*/) AS BIS2_SQLTC_PlayerSummary ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = BIS2_SQLTC_PlayerSummary.PatronID WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102') AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf') AND (BIS2_SQLTC_PlayerSummary.ADT >= 300.00)) GROUP BY dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big)  AS  VBB2__subQuery1 ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = VBB2__subQuery1.AccountNum WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102') AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf') AND (BIS2_SQLTC_PlayerSummary.ADT >= 300.00)) GROUP BY dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big,substring(datename(weekday, BIS2_VW_PlayerSession.Time_Started),1,3),RIGHT('00' + RTRIM(datepart(hh,BIS2_VW_PlayerSession.Time_Started)), 2) HAVING CASE WHEN MAX(VBB2__subQuery1.VBB2__PreferenceDenominator) <> 0 THEN (SUM(dbo.BIS2_VW_PlayerSession.theo_loss_dol) / MAX(VBB2__subQuery1.VBB2__PreferenceDenominator))* 100.0 ELSE 0 END >= 3/* End: PrefByDayOfWeek*/) AS PrefByDayOfWeek ON (dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = PrefByDayOfWeek.AccountNum AND dbo.BIS2_VW_PlayerSession.DayOfWeek = PrefByDayOfWeek.DayOfWeek AND dbo.BIS2_VW_PlayerSession.Hour_ = PrefByDayOfWeek.Hour_) INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_PlayerSummary*/SELECT MAX(BIS2_VW_PlayerSession.GamingDate) AS LastDaywithPlay,dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS PatronID,CASE WHEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) <> 0 THEN SUM(BIS2_VW_PlayerSession.ActualWin)/SUM(BIS2_VW_PlayerSession.theo_loss_dol) ELSE 0 END AS ActualWinTheoWinRatio,CASE WHEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) ELSE 0 END AS ADT,CASE WHEN CAST(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / CAST(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) ELSE 0 END AS AMT,CASE WHEN COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) <> 0 THEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal)/ COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) ELSE 0 END AS AMV,DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,SUM(dbo.BIS2_VW_PlayerSession.coin_out) AS FreeplayReinvestmentPCTDummy,CASE WHEN SUM(case when cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)<>0 THEN (100.0*(SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)-SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END)))/SUM(case when   cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_PlayerSession.theo_loss_dol ELSE 0 END) ELSE 0 END AS PercentChangeTheoWin,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CASE WHEN cast(BIS2_VW_PlayerSession.time_started AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_PlayerSession.time_started AS date) as varchar) ELSE NULL END) ELSE 0 END AS PercentChangeVisits,CASE WHEN (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END) <> 0 THEN DATEDIFF(dd, MAX(cast(BIS2_VW_PlayerSession.time_started AS date)), MAX(BIS2_FN_SGStartEndDate.SGEndDate))/( (CASE WHEN (Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) <> 0 THEN cast(DATEDIFF(dd,MIN(cast(BIS2_VW_PlayerSession.time_started AS date)),MAX(cast(BIS2_VW_PlayerSession.time_started AS date))) as decimal)/(Count(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + cast(cast(BIS2_VW_PlayerSession.time_started AS date) AS varchar))-1) ELSE 0 END)) ELSE 0 END AS TripsOwed,SUM(dbo.BIS2_VW_PlayerSession.coin_in) AS VisitDensity,cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) AS Visits FROM dbo.BIS2_VW_PlayerSession INNER HASH JOIN dbo.BIS2_FN_SGStartEndDate('20140601 07:00:00','20150101 06:59:00') AS BIS2_FN_SGStartEndDate ON dbo.BIS2_VW_PlayerSession.hackjoin = BIS2_FN_SGStartEndDate.HackJoin INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102') AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf')) GROUP BY dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big/* End: BIS2_SQLTC_PlayerSummary*/) AS BIS2_SQLTC_PlayerSummary ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = BIS2_SQLTC_PlayerSummary.PatronID WHERE (dbo.BIS2_VW_PlayerSession.Time_Started >= '20140601 07:00:00')  AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20140531')  AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20150101 06:59:00')  AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20150102')  AND (dbo.SelectionList.GROUPID = '3501665e8-14d0c7bf3cf')  AND (BIS2_SQLTC_PlayerSummary.ADT >= 300.00)
2016-10-04 10:32:03.881463: Checking 34cf66448-1578c063b6b (Avg Daily Theo vs Avg Monthly Visits, BUILT FOR NEW MEMBER):
	Query: SELECT dbo.cqa.cell_index AS CellIndex,'Q'+substring(cqa.cell_index,1,1) AS QL1,'Q'+substring(cqa.cell_index,1,2) AS QL2,'Q'+substring(cqa.cell_index,1,3) AS QL3,'Q'+substring(cqa.cell_index,1,4) AS QL4,CASE WHEN SUM(BIS2_VW_DailyPlayer.CoinIn) <> 0 THEN 100.0 *   SUM(BIS2_VW_DailyPlayer.ActualWin)/SUM(BIS2_VW_DailyPlayer.CoinIn) ELSE 0 END AS ActualHoldPCT,SUM(dbo.BIS2_VW_DailyPlayer.ActualWin) AS ActualWin,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS   varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) +  cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS ADT,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct   cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) ELSE 0 END AS AMT,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) +   cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) <> 0 THEN cast(Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS   varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))AS decimal)/Count(distinct  cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) ELSE 0 END AS AMV,CASE WHEN SUM(BIS2_VW_DailyPlayer.GamesPlayed) <> 0 THEN   SUM(BIS2_VW_DailyPlayer.CoinIn)/SUM(BIS2_VW_DailyPlayer.GamesPlayed) ELSE 0 END AS AvgBet,SUM(dbo.BIS2_VW_DailyPlayer.CoinIn) AS CoinIn,SUM(dbo.BIS2_VW_DailyPlayer.Freeplay) AS Freeplay,SUM(dbo.BIS2_VW_DailyPlayer.GamesPlayed) AS GamesPlayed,SUM(BIS2_VW_DailyPlayer.timeplayedsec/3600.0) AS HoursPlayed,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS   varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.timeplayedsec/3600.0)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS  varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS HoursPlayedperVisit,SUM(dbo.BIS2_VW_DailyPlayer.Jackpot) AS Jackpot,max(bis2_sqltc_dailyplayersummary.adt) AS MaxADT,max(bis2_sqltc_dailyplayersummary.AMV) AS MaxAMV,Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) AS MonthswithPlay,COUNT(distinct BIS2_VW_DailyPlayer.PlayerID) AS PlayerCount,CASE WHEN SUM(BIS2_VW_DailyPlayer.CoinIn) <> 0 THEN 100.0 *   SUM(BIS2_VW_DailyPlayer.TheoWin)/SUM(BIS2_VW_DailyPlayer.CoinIn) ELSE 0 END AS TheoHoldPCT,SUM(dbo.BIS2_VW_DailyPlayer.TheoWin) AS TheoWin,Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) AS Visits,CASE WHEN COUNT(distinct BIS2_VW_DailyPlayer.PlayerID) <> 0 THEN Cast(Count(distinct   cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) AS  decimal)/COUNT(distinct BIS2_VW_DailyPlayer.PlayerID) ELSE 0 END AS VisitsperPlayer FROM dbo.BIS2_VW_DailyPlayer INNER JOIN dbo.cqa ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.cqa.pk LEFT JOIN dbo.BIS2_Patron_Profile ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_Patron_Profile.AccountNumber INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_VW_Patron.Account_Number LEFT JOIN dbo.BIS2_VW_Exclusion_Flags ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Exclusion_Flags.Patron_Number INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DailyPlayerSummary*/SELECT dbo.BIS2_Patron_Profile.EnrolledDate AS DateEnrolled,DATEDIFF(dd,MAX(dbo.BIS2_Patron_Profile.EnrolledDate),MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceEnrol,MAX(BIS2_VW_DailyPlayer.GamingDate) AS LastTrip,dbo.BIS2_VW_DailyPlayer.PlayerID AS PlayerID,CASE WHEN SUM(BIS2_VW_DailyPlayer.TheoWin) <>0 THEN SUM(BIS2_VW_DailyPlayer.ActualWin)/SUM(BIS2_VW_DailyPlayer.TheoWin)   ELSE 0 END AS ActualWinTheoWinRatio,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS   varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) +  cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS ADT,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct   cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) ELSE 0 END AS AMT,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) +   cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) <> 0 THEN cast(Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS   varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))AS decimal)/Count(distinct  cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) ELSE 0 END AS AMV,CASE WHEN SUM(case when cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_DailyPlayer.TheoWin ELSE 0 END)<>0 THEN (100.0*(SUM(case when   cast(BIS2_VW_DailyPlayer.GamingDate AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_DailyPlayer.TheoWin ELSE 0 END)-SUM(case when   cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_DailyPlayer.TheoWin ELSE 0 END)))/SUM(case when   cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_DailyPlayer.TheoWin ELSE 0 END) ELSE 0 END AS DailyPercentChangeTheo,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_DailyPlayer.PlayerID as varchar)+CASE WHEN cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_DailyPlayer.GamingDate AS date) as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_DailyPlayer.PlayerID as varchar)+CASE WHEN cast(BIS2_VW_DailyPlayer.GamingDate AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_DailyPlayer.GamingDate AS date) as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_DailyPlayer.PlayerID as varchar)+CASE WHEN cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_DailyPlayer.GamingDate AS date) as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_DailyPlayer.PlayerID as varchar)+CASE WHEN cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_DailyPlayer.GamingDate AS date) as varchar) ELSE NULL END) ELSE 0 END AS DailyPercentChangeVisits,CASE WHEN    (CASE WHEN (Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1) <> 0     THEN (DATEDIFF(dd,MIN(BIS2_VW_DailyPlayer.GamingDate),MAX(BIS2_VW_DailyPlayer.GamingDate)))/     (Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1)     ELSE 0 END)     <> 0    THEN (DATEDIFF(dd,MAX(BIS2_VW_DailyPlayer.GamingDate),MAX(BIS2_FN_SGStartEndDate.SGEndDate)))/    (CASE WHEN (Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1) <> 0      THEN CAST((DATEDIFF(dd,MIN(BIS2_VW_DailyPlayer.GamingDate),MAX(BIS2_VW_DailyPlayer.GamingDate)))/      (Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1) AS DECIMAL)     ELSE 0 END)    ELSE 0 END AS DailyPlayerTripsOwed,DATEDIFF(dd,  MAX(BIS2_VW_DailyPlayer.GamingDate),  MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,SUM(CASE WHEN BIS2_VW_DailyPlayer.TheoWin <> 0 THEN (BIS2_VW_DailyPlayer.Freeplay/BIS2_VW_DailyPlayer.TheoWin)*100.0 ELSE 0 END) AS FreeplayReinvestmentPCT,CASE WHEN (DATEDIFF(dd,  MIN(BIS2_VW_DailyPlayer.GamingDate),  MAX(BIS2_VW_DailyPlayer.GamingDate))) <> 0 THEN (Count( distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) +   cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1) / (DATEDIFF(dd,  MIN(BIS2_VW_DailyPlayer.GamingDate),  MAX(BIS2_VW_DailyPlayer.GamingDate))) ELSE 0 END AS VisitDensity,Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) AS Visits FROM dbo.BIS2_VW_DailyPlayer INNER HASH JOIN dbo.BIS2_FN_SGStartEndDate('20160926 00:00:00','20161003 00:00:00') AS BIS2_FN_SGStartEndDate ON dbo.BIS2_VW_DailyPlayer.HackJoin = BIS2_FN_SGStartEndDate.HackJoin LEFT JOIN dbo.BIS2_Patron_Profile ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_Patron_Profile.AccountNumber INNER JOIN dbo.cqa ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.cqa.pk INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_VW_Patron.Account_Number LEFT JOIN dbo.BIS2_VW_Exclusion_Flags ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Exclusion_Flags.Patron_Number WHERE ((dbo.BIS2_VW_DailyPlayer.GamingDate >= '20160926') AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20161003') AND ((dbo.BIS2_Patron_Profile.EnrolledDate >= '20160926') AND (dbo.BIS2_Patron_Profile.EnrolledDate < '20161003') AND ((dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag IS NULL) OR (dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag NOT IN ('50','51','55','82','83','84','85','86','87','89'))) AND (dbo.cqa.allocation_id = '34cf66d1f-1578c09840f'))) GROUP BY dbo.BIS2_Patron_Profile.EnrolledDate,dbo.BIS2_VW_DailyPlayer.PlayerID/* End: BIS2_SQLTC_DailyPlayerSummary*/) AS BIS2_SQLTC_DailyPlayerSummary ON dbo.BIS2_VW_DailyPlayer.PlayerID = BIS2_SQLTC_DailyPlayerSummary.PlayerID WHERE ((dbo.BIS2_VW_DailyPlayer.GamingDate >= '20160926') AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20161003') AND ((dbo.BIS2_Patron_Profile.EnrolledDate >= '20160926') AND (dbo.BIS2_Patron_Profile.EnrolledDate < '20161003') AND ((dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag IS NULL) OR (dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag NOT IN ('50','51','55','82','83','84','85','86','87','89'))) AND (dbo.cqa.allocation_id = '34cf66d1f-1578c09840f'))) GROUP BY dbo.cqa.cell_index,'Q'+substring(cqa.cell_index,1,1),'Q'+substring(cqa.cell_index,1,2),'Q'+substring(cqa.cell_index,1,3),'Q'+substring(cqa.cell_index,1,4)
	DocAggs: ['ActualHoldPCT', 'ActualWin', 'ADT', 'AMT', 'AvgBet', 'CoinIn', 'Freeplay', 'GamesPlayed', 'HoursPlayed', 'HoursPlayedperVisit', 'Jackpot', 'PlayerCount', 'TheoHoldPCT', 'TheoWin']
	DocAggDict: {'PlayerCount': 'COUNT(distinct BIS2_VW_DailyPlayer.PlayerID) AS PlayerCount', 'ActualWin': 'SUM(dbo.BIS2_VW_DailyPlayer.ActualWin) AS ActualWin', 'AvgBet': 'SUM(BIS2_VW_DailyPlayer.GamesPlayed) <> 0 THEN   SUM(BIS2_VW_DailyPlayer.CoinIn)/SUM(BIS2_VW_DailyPlayer.GamesPlayed) ELSE 0 END AS AvgBet', 'ActualHoldPCT': 'SUM(BIS2_VW_DailyPlayer.CoinIn) <> 0 THEN 100.0 *   SUM(BIS2_VW_DailyPlayer.ActualWin)/SUM(BIS2_VW_DailyPlayer.CoinIn) ELSE 0 END AS ActualHoldPCT', 'TheoWin': 'SUM(dbo.BIS2_VW_DailyPlayer.TheoWin) AS TheoWin', 'CoinIn': 'SUM(dbo.BIS2_VW_DailyPlayer.CoinIn) AS CoinIn', 'AMT': 'SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct   cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) ELSE 0 END AS AMT', 'HoursPlayed': 'SUM(BIS2_VW_DailyPlayer.timeplayedsec/3600.0) AS HoursPlayed', 'GamesPlayed': 'SUM(dbo.BIS2_VW_DailyPlayer.GamesPlayed) AS GamesPlayed', 'ADT': 'SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) +  cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS ADT', 'Jackpot': 'SUM(dbo.BIS2_VW_DailyPlayer.Jackpot) AS Jackpot', 'Freeplay': 'SUM(dbo.BIS2_VW_DailyPlayer.Freeplay) AS Freeplay', 'TheoHoldPCT': 'SUM(BIS2_VW_DailyPlayer.CoinIn) <> 0 THEN 100.0 *   SUM(BIS2_VW_DailyPlayer.TheoWin)/SUM(BIS2_VW_DailyPlayer.CoinIn) ELSE 0 END AS TheoHoldPCT', 'HoursPlayedperVisit': 'SUM(BIS2_VW_DailyPlayer.timeplayedsec/3600.0)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS  varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS HoursPlayedperVisit'}
	DocJoins: ['dbo.BIS2_VW_DailyPlayer', 'dbo.cqa', 'dbo.BIS2_Patron_Profile', 'dbo.BIS2_VW_Patron', 'dbo.BIS2_VW_Exclusion_Flags', 'BIS2_SQLTC_DailyPlayerSummary']DocJoinDict: {'dbo.BIS2_Patron_Profile': 'LEFT JOIN dbo.BIS2_Patron_Profile ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_Patron_Profile.AccountNumber ', 'BIS2_SQLTC_DailyPlayerSummary': "INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DailyPlayerSummary*/SELECT dbo.BIS2_Patron_Profile.EnrolledDate AS DateEnrolled,DATEDIFF(dd,MAX(dbo.BIS2_Patron_Profile.EnrolledDate),MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceEnrol,MAX(BIS2_VW_DailyPlayer.GamingDate) AS LastTrip,dbo.BIS2_VW_DailyPlayer.PlayerID AS PlayerID,CASE WHEN SUM(BIS2_VW_DailyPlayer.TheoWin) <>0 THEN SUM(BIS2_VW_DailyPlayer.ActualWin)/SUM(BIS2_VW_DailyPlayer.TheoWin)   ELSE 0 END AS ActualWinTheoWinRatio,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS   varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) +  cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS ADT,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct   cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) ELSE 0 END AS AMT,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) +   cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) <> 0 THEN cast(Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS   varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))AS decimal)/Count(distinct  cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) ELSE 0 END AS AMV,CASE WHEN SUM(case when cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_DailyPlayer.TheoWin ELSE 0 END)<>0 THEN (100.0*(SUM(case when   cast(BIS2_VW_DailyPlayer.GamingDate AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_DailyPlayer.TheoWin ELSE 0 END)-SUM(case when   cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_DailyPlayer.TheoWin ELSE 0 END)))/SUM(case when   cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_DailyPlayer.TheoWin ELSE 0 END) ELSE 0 END AS DailyPercentChangeTheo,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_DailyPlayer.PlayerID as varchar)+CASE WHEN cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_DailyPlayer.GamingDate AS date) as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_DailyPlayer.PlayerID as varchar)+CASE WHEN cast(BIS2_VW_DailyPlayer.GamingDate AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_DailyPlayer.GamingDate AS date) as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_DailyPlayer.PlayerID as varchar)+CASE WHEN cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_DailyPlayer.GamingDate AS date) as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_DailyPlayer.PlayerID as varchar)+CASE WHEN cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_DailyPlayer.GamingDate AS date) as varchar) ELSE NULL END) ELSE 0 END AS DailyPercentChangeVisits,CASE WHEN    (CASE WHEN (Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1) <> 0     THEN (DATEDIFF(dd,MIN(BIS2_VW_DailyPlayer.GamingDate),MAX(BIS2_VW_DailyPlayer.GamingDate)))/     (Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1)     ELSE 0 END)     <> 0    THEN (DATEDIFF(dd,MAX(BIS2_VW_DailyPlayer.GamingDate),MAX(BIS2_FN_SGStartEndDate.SGEndDate)))/    (CASE WHEN (Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1) <> 0      THEN CAST((DATEDIFF(dd,MIN(BIS2_VW_DailyPlayer.GamingDate),MAX(BIS2_VW_DailyPlayer.GamingDate)))/      (Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1) AS DECIMAL)     ELSE 0 END)    ELSE 0 END AS DailyPlayerTripsOwed,DATEDIFF(dd,  MAX(BIS2_VW_DailyPlayer.GamingDate),  MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,SUM(CASE WHEN BIS2_VW_DailyPlayer.TheoWin <> 0 THEN (BIS2_VW_DailyPlayer.Freeplay/BIS2_VW_DailyPlayer.TheoWin)*100.0 ELSE 0 END) AS FreeplayReinvestmentPCT,CASE WHEN (DATEDIFF(dd,  MIN(BIS2_VW_DailyPlayer.GamingDate),  MAX(BIS2_VW_DailyPlayer.GamingDate))) <> 0 THEN (Count( distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) +   cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1) / (DATEDIFF(dd,  MIN(BIS2_VW_DailyPlayer.GamingDate),  MAX(BIS2_VW_DailyPlayer.GamingDate))) ELSE 0 END AS VisitDensity,Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) AS Visits FROM dbo.BIS2_VW_DailyPlayer INNER HASH JOIN dbo.BIS2_FN_SGStartEndDate('20160926 00:00:00','20161003 00:00:00') AS BIS2_FN_SGStartEndDate ON dbo.BIS2_VW_DailyPlayer.HackJoin = BIS2_FN_SGStartEndDate.HackJoin LEFT JOIN dbo.BIS2_Patron_Profile ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_Patron_Profile.AccountNumber INNER JOIN dbo.cqa ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.cqa.pk INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_VW_Patron.Account_Number LEFT JOIN dbo.BIS2_VW_Exclusion_Flags ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Exclusion_Flags.Patron_Number WHERE ((dbo.BIS2_VW_DailyPlayer.GamingDate >= '20160926') AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20161003') AND ((dbo.BIS2_Patron_Profile.EnrolledDate >= '20160926') AND (dbo.BIS2_Patron_Profile.EnrolledDate < '20161003') AND ((dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag IS NULL) OR (dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag NOT IN ('50','51','55','82','83','84','85','86','87','89'))) AND (dbo.cqa.allocation_id = '34cf66d1f-1578c09840f'))) GROUP BY dbo.BIS2_Patron_Profile.EnrolledDate,dbo.BIS2_VW_DailyPlayer.PlayerID/* End: BIS2_SQLTC_DailyPlayerSummary*/) AS BIS2_SQLTC_DailyPlayerSummary ON dbo.BIS2_VW_DailyPlayer.PlayerID = BIS2_SQLTC_DailyPlayerSummary.PlayerID ", 'dbo.BIS2_VW_DailyPlayer': 'FROM dbo.BIS2_VW_DailyPlayer ', 'dbo.BIS2_VW_Exclusion_Flags': 'LEFT JOIN dbo.BIS2_VW_Exclusion_Flags ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Exclusion_Flags.Patron_Number ', 'dbo.BIS2_VW_Patron': 'INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_VW_Patron.Account_Number ', 'dbo.cqa': 'INNER JOIN dbo.cqa ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.cqa.pk '}
	DocWhere: ["(dbo.BIS2_VW_DailyPlayer.GamingDate >= '20160926') ", "(dbo.BIS2_VW_DailyPlayer.GamingDate < '20161003') ", "((dbo.BIS2_Patron_Profile.EnrolledDate >= '20160926') AND (dbo.BIS2_Patron_Profile.EnrolledDate < '20161003') AND ((dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag IS NULL) OR (dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag NOT IN ('50','51','55','82','83','84','85','86','87','89'))) AND (dbo.cqa.allocation_id = '34cf66d1f-1578c09840f'))"]
	DocWhereAnd: {"(dbo.BIS2_VW_DailyPlayer.GamingDate < '20161003') ": 'AND ', "((dbo.BIS2_Patron_Profile.EnrolledDate >= '20160926') AND (dbo.BIS2_Patron_Profile.EnrolledDate < '20161003') AND ((dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag IS NULL) OR (dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag NOT IN ('50','51','55','82','83','84','85','86','87','89'))) AND (dbo.cqa.allocation_id = '34cf66d1f-1578c09840f'))": 'AND ', "(dbo.BIS2_VW_DailyPlayer.GamingDate >= '20160926') ": 'start'}
2016-10-04 10:32:20.668906: Final data about 34cf66448-1578c063b6b:
	UserAggList: ['ActualWin', 'CoinIn', 'Freeplay', 'GamesPlayed', 'Jackpot', 'TheoWin']
	UserRestrictList: ["((dbo.BIS2_Patron_Profile.EnrolledDate >= '20160926') AND (dbo.BIS2_Patron_Profile.EnrolledDate < '20161003') AND ((dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag IS NULL) OR (dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag NOT IN ('50','51','55','82','83','84','85','86','87','89'))) AND (dbo.cqa.allocation_id = '34cf66d1f-1578c09840f'))"]
	FinalQuery: SELECT 'Step 1' AS Step, SUM(dbo.BIS2_VW_DailyPlayer.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_DailyPlayer.CoinIn) AS CoinIn, SUM(dbo.BIS2_VW_DailyPlayer.Freeplay) AS Freeplay, SUM(dbo.BIS2_VW_DailyPlayer.GamesPlayed) AS GamesPlayed, SUM(dbo.BIS2_VW_DailyPlayer.Jackpot) AS Jackpot, SUM(dbo.BIS2_VW_DailyPlayer.TheoWin) AS TheoWin, 'dbo.BIS2_VW_DailyPlayer' AS StepInfo FROM dbo.BIS2_VW_DailyPlayer WHERE (dbo.BIS2_VW_DailyPlayer.GamingDate >= '20160926')  AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20161003')  UNION ALL SELECT 'Step 2' AS Step, SUM(dbo.BIS2_VW_DailyPlayer.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_DailyPlayer.CoinIn) AS CoinIn, SUM(dbo.BIS2_VW_DailyPlayer.Freeplay) AS Freeplay, SUM(dbo.BIS2_VW_DailyPlayer.GamesPlayed) AS GamesPlayed, SUM(dbo.BIS2_VW_DailyPlayer.Jackpot) AS Jackpot, SUM(dbo.BIS2_VW_DailyPlayer.TheoWin) AS TheoWin, 'dbo.cqa' AS StepInfo FROM dbo.BIS2_VW_DailyPlayer INNER JOIN dbo.cqa ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.cqa.pk WHERE (dbo.BIS2_VW_DailyPlayer.GamingDate >= '20160926')  AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20161003')  UNION ALL SELECT 'Step 2B' AS Step, SUM(dbo.BIS2_VW_DailyPlayer.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_DailyPlayer.CoinIn) AS CoinIn, SUM(dbo.BIS2_VW_DailyPlayer.Freeplay) AS Freeplay, SUM(dbo.BIS2_VW_DailyPlayer.GamesPlayed) AS GamesPlayed, SUM(dbo.BIS2_VW_DailyPlayer.Jackpot) AS Jackpot, SUM(dbo.BIS2_VW_DailyPlayer.TheoWin) AS TheoWin, 'dbo.cqa (Restriction)' AS StepInfo FROM dbo.BIS2_VW_DailyPlayer INNER JOIN dbo.cqa ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.cqa.pk WHERE (dbo.BIS2_VW_DailyPlayer.GamingDate >= '20160926')  AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20161003')  AND ((dbo.BIS2_Patron_Profile.EnrolledDate >= '20160926') AND (dbo.BIS2_Patron_Profile.EnrolledDate < '20161003') AND ((dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag IS NULL) OR (dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag NOT IN ('50','51','55','82','83','84','85','86','87','89'))) AND (dbo.cqa.allocation_id = '34cf66d1f-1578c09840f')) UNION ALL SELECT 'Step 3' AS Step, SUM(dbo.BIS2_VW_DailyPlayer.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_DailyPlayer.CoinIn) AS CoinIn, SUM(dbo.BIS2_VW_DailyPlayer.Freeplay) AS Freeplay, SUM(dbo.BIS2_VW_DailyPlayer.GamesPlayed) AS GamesPlayed, SUM(dbo.BIS2_VW_DailyPlayer.Jackpot) AS Jackpot, SUM(dbo.BIS2_VW_DailyPlayer.TheoWin) AS TheoWin, 'dbo.BIS2_Patron_Profile' AS StepInfo FROM dbo.BIS2_VW_DailyPlayer INNER JOIN dbo.cqa ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.cqa.pk LEFT JOIN dbo.BIS2_Patron_Profile ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_Patron_Profile.AccountNumber WHERE (dbo.BIS2_VW_DailyPlayer.GamingDate >= '20160926')  AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20161003')  AND ((dbo.BIS2_Patron_Profile.EnrolledDate >= '20160926') AND (dbo.BIS2_Patron_Profile.EnrolledDate < '20161003') AND ((dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag IS NULL) OR (dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag NOT IN ('50','51','55','82','83','84','85','86','87','89'))) AND (dbo.cqa.allocation_id = '34cf66d1f-1578c09840f')) UNION ALL SELECT 'Step 3B' AS Step, SUM(dbo.BIS2_VW_DailyPlayer.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_DailyPlayer.CoinIn) AS CoinIn, SUM(dbo.BIS2_VW_DailyPlayer.Freeplay) AS Freeplay, SUM(dbo.BIS2_VW_DailyPlayer.GamesPlayed) AS GamesPlayed, SUM(dbo.BIS2_VW_DailyPlayer.Jackpot) AS Jackpot, SUM(dbo.BIS2_VW_DailyPlayer.TheoWin) AS TheoWin, 'dbo.BIS2_Patron_Profile (Restriction)' AS StepInfo FROM dbo.BIS2_VW_DailyPlayer INNER JOIN dbo.cqa ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.cqa.pk LEFT JOIN dbo.BIS2_Patron_Profile ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_Patron_Profile.AccountNumber WHERE (dbo.BIS2_VW_DailyPlayer.GamingDate >= '20160926')  AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20161003')  AND ((dbo.BIS2_Patron_Profile.EnrolledDate >= '20160926') AND (dbo.BIS2_Patron_Profile.EnrolledDate < '20161003') AND ((dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag IS NULL) OR (dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag NOT IN ('50','51','55','82','83','84','85','86','87','89'))) AND (dbo.cqa.allocation_id = '34cf66d1f-1578c09840f')) AND ((dbo.BIS2_Patron_Profile.EnrolledDate >= '20160926') AND (dbo.BIS2_Patron_Profile.EnrolledDate < '20161003') AND ((dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag IS NULL) OR (dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag NOT IN ('50','51','55','82','83','84','85','86','87','89'))) AND (dbo.cqa.allocation_id = '34cf66d1f-1578c09840f')) UNION ALL SELECT 'Step 4' AS Step, SUM(dbo.BIS2_VW_DailyPlayer.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_DailyPlayer.CoinIn) AS CoinIn, SUM(dbo.BIS2_VW_DailyPlayer.Freeplay) AS Freeplay, SUM(dbo.BIS2_VW_DailyPlayer.GamesPlayed) AS GamesPlayed, SUM(dbo.BIS2_VW_DailyPlayer.Jackpot) AS Jackpot, SUM(dbo.BIS2_VW_DailyPlayer.TheoWin) AS TheoWin, 'dbo.BIS2_VW_Patron' AS StepInfo FROM dbo.BIS2_VW_DailyPlayer INNER JOIN dbo.cqa ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.cqa.pk LEFT JOIN dbo.BIS2_Patron_Profile ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_Patron_Profile.AccountNumber INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_VW_Patron.Account_Number WHERE (dbo.BIS2_VW_DailyPlayer.GamingDate >= '20160926')  AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20161003')  AND ((dbo.BIS2_Patron_Profile.EnrolledDate >= '20160926') AND (dbo.BIS2_Patron_Profile.EnrolledDate < '20161003') AND ((dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag IS NULL) OR (dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag NOT IN ('50','51','55','82','83','84','85','86','87','89'))) AND (dbo.cqa.allocation_id = '34cf66d1f-1578c09840f')) AND ((dbo.BIS2_Patron_Profile.EnrolledDate >= '20160926') AND (dbo.BIS2_Patron_Profile.EnrolledDate < '20161003') AND ((dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag IS NULL) OR (dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag NOT IN ('50','51','55','82','83','84','85','86','87','89'))) AND (dbo.cqa.allocation_id = '34cf66d1f-1578c09840f')) UNION ALL SELECT 'Step 5' AS Step, SUM(dbo.BIS2_VW_DailyPlayer.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_DailyPlayer.CoinIn) AS CoinIn, SUM(dbo.BIS2_VW_DailyPlayer.Freeplay) AS Freeplay, SUM(dbo.BIS2_VW_DailyPlayer.GamesPlayed) AS GamesPlayed, SUM(dbo.BIS2_VW_DailyPlayer.Jackpot) AS Jackpot, SUM(dbo.BIS2_VW_DailyPlayer.TheoWin) AS TheoWin, 'dbo.BIS2_VW_Exclusion_Flags' AS StepInfo FROM dbo.BIS2_VW_DailyPlayer INNER JOIN dbo.cqa ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.cqa.pk LEFT JOIN dbo.BIS2_Patron_Profile ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_Patron_Profile.AccountNumber INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_VW_Patron.Account_Number LEFT JOIN dbo.BIS2_VW_Exclusion_Flags ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Exclusion_Flags.Patron_Number WHERE (dbo.BIS2_VW_DailyPlayer.GamingDate >= '20160926')  AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20161003')  AND ((dbo.BIS2_Patron_Profile.EnrolledDate >= '20160926') AND (dbo.BIS2_Patron_Profile.EnrolledDate < '20161003') AND ((dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag IS NULL) OR (dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag NOT IN ('50','51','55','82','83','84','85','86','87','89'))) AND (dbo.cqa.allocation_id = '34cf66d1f-1578c09840f')) AND ((dbo.BIS2_Patron_Profile.EnrolledDate >= '20160926') AND (dbo.BIS2_Patron_Profile.EnrolledDate < '20161003') AND ((dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag IS NULL) OR (dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag NOT IN ('50','51','55','82','83','84','85','86','87','89'))) AND (dbo.cqa.allocation_id = '34cf66d1f-1578c09840f')) UNION ALL SELECT 'Step 5B' AS Step, SUM(dbo.BIS2_VW_DailyPlayer.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_DailyPlayer.CoinIn) AS CoinIn, SUM(dbo.BIS2_VW_DailyPlayer.Freeplay) AS Freeplay, SUM(dbo.BIS2_VW_DailyPlayer.GamesPlayed) AS GamesPlayed, SUM(dbo.BIS2_VW_DailyPlayer.Jackpot) AS Jackpot, SUM(dbo.BIS2_VW_DailyPlayer.TheoWin) AS TheoWin, 'dbo.BIS2_VW_Exclusion_Flags (Restriction)' AS StepInfo FROM dbo.BIS2_VW_DailyPlayer INNER JOIN dbo.cqa ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.cqa.pk LEFT JOIN dbo.BIS2_Patron_Profile ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_Patron_Profile.AccountNumber INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_VW_Patron.Account_Number LEFT JOIN dbo.BIS2_VW_Exclusion_Flags ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Exclusion_Flags.Patron_Number WHERE (dbo.BIS2_VW_DailyPlayer.GamingDate >= '20160926')  AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20161003')  AND ((dbo.BIS2_Patron_Profile.EnrolledDate >= '20160926') AND (dbo.BIS2_Patron_Profile.EnrolledDate < '20161003') AND ((dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag IS NULL) OR (dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag NOT IN ('50','51','55','82','83','84','85','86','87','89'))) AND (dbo.cqa.allocation_id = '34cf66d1f-1578c09840f')) AND ((dbo.BIS2_Patron_Profile.EnrolledDate >= '20160926') AND (dbo.BIS2_Patron_Profile.EnrolledDate < '20161003') AND ((dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag IS NULL) OR (dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag NOT IN ('50','51','55','82','83','84','85','86','87','89'))) AND (dbo.cqa.allocation_id = '34cf66d1f-1578c09840f')) AND ((dbo.BIS2_Patron_Profile.EnrolledDate >= '20160926') AND (dbo.BIS2_Patron_Profile.EnrolledDate < '20161003') AND ((dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag IS NULL) OR (dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag NOT IN ('50','51','55','82','83','84','85','86','87','89'))) AND (dbo.cqa.allocation_id = '34cf66d1f-1578c09840f')) UNION ALL SELECT 'Step 6' AS Step, SUM(dbo.BIS2_VW_DailyPlayer.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_DailyPlayer.CoinIn) AS CoinIn, SUM(dbo.BIS2_VW_DailyPlayer.Freeplay) AS Freeplay, SUM(dbo.BIS2_VW_DailyPlayer.GamesPlayed) AS GamesPlayed, SUM(dbo.BIS2_VW_DailyPlayer.Jackpot) AS Jackpot, SUM(dbo.BIS2_VW_DailyPlayer.TheoWin) AS TheoWin, 'BIS2_SQLTC_DailyPlayerSummary' AS StepInfo FROM dbo.BIS2_VW_DailyPlayer INNER JOIN dbo.cqa ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.cqa.pk LEFT JOIN dbo.BIS2_Patron_Profile ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_Patron_Profile.AccountNumber INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_VW_Patron.Account_Number LEFT JOIN dbo.BIS2_VW_Exclusion_Flags ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Exclusion_Flags.Patron_Number INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DailyPlayerSummary*/SELECT dbo.BIS2_Patron_Profile.EnrolledDate AS DateEnrolled,DATEDIFF(dd,MAX(dbo.BIS2_Patron_Profile.EnrolledDate),MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceEnrol,MAX(BIS2_VW_DailyPlayer.GamingDate) AS LastTrip,dbo.BIS2_VW_DailyPlayer.PlayerID AS PlayerID,CASE WHEN SUM(BIS2_VW_DailyPlayer.TheoWin) <>0 THEN SUM(BIS2_VW_DailyPlayer.ActualWin)/SUM(BIS2_VW_DailyPlayer.TheoWin)   ELSE 0 END AS ActualWinTheoWinRatio,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS   varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) +  cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS ADT,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct   cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) ELSE 0 END AS AMT,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) +   cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) <> 0 THEN cast(Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS   varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))AS decimal)/Count(distinct  cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) ELSE 0 END AS AMV,CASE WHEN SUM(case when cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_DailyPlayer.TheoWin ELSE 0 END)<>0 THEN (100.0*(SUM(case when   cast(BIS2_VW_DailyPlayer.GamingDate AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_DailyPlayer.TheoWin ELSE 0 END)-SUM(case when   cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_DailyPlayer.TheoWin ELSE 0 END)))/SUM(case when   cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_DailyPlayer.TheoWin ELSE 0 END) ELSE 0 END AS DailyPercentChangeTheo,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_DailyPlayer.PlayerID as varchar)+CASE WHEN cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_DailyPlayer.GamingDate AS date) as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_DailyPlayer.PlayerID as varchar)+CASE WHEN cast(BIS2_VW_DailyPlayer.GamingDate AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_DailyPlayer.GamingDate AS date) as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_DailyPlayer.PlayerID as varchar)+CASE WHEN cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_DailyPlayer.GamingDate AS date) as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_DailyPlayer.PlayerID as varchar)+CASE WHEN cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_DailyPlayer.GamingDate AS date) as varchar) ELSE NULL END) ELSE 0 END AS DailyPercentChangeVisits,CASE WHEN    (CASE WHEN (Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1) <> 0     THEN (DATEDIFF(dd,MIN(BIS2_VW_DailyPlayer.GamingDate),MAX(BIS2_VW_DailyPlayer.GamingDate)))/     (Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1)     ELSE 0 END)     <> 0    THEN (DATEDIFF(dd,MAX(BIS2_VW_DailyPlayer.GamingDate),MAX(BIS2_FN_SGStartEndDate.SGEndDate)))/    (CASE WHEN (Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1) <> 0      THEN CAST((DATEDIFF(dd,MIN(BIS2_VW_DailyPlayer.GamingDate),MAX(BIS2_VW_DailyPlayer.GamingDate)))/      (Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1) AS DECIMAL)     ELSE 0 END)    ELSE 0 END AS DailyPlayerTripsOwed,DATEDIFF(dd,  MAX(BIS2_VW_DailyPlayer.GamingDate),  MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,SUM(CASE WHEN BIS2_VW_DailyPlayer.TheoWin <> 0 THEN (BIS2_VW_DailyPlayer.Freeplay/BIS2_VW_DailyPlayer.TheoWin)*100.0 ELSE 0 END) AS FreeplayReinvestmentPCT,CASE WHEN (DATEDIFF(dd,  MIN(BIS2_VW_DailyPlayer.GamingDate),  MAX(BIS2_VW_DailyPlayer.GamingDate))) <> 0 THEN (Count( distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) +   cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1) / (DATEDIFF(dd,  MIN(BIS2_VW_DailyPlayer.GamingDate),  MAX(BIS2_VW_DailyPlayer.GamingDate))) ELSE 0 END AS VisitDensity,Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) AS Visits FROM dbo.BIS2_VW_DailyPlayer INNER HASH JOIN dbo.BIS2_FN_SGStartEndDate('20160926 00:00:00','20161003 00:00:00') AS BIS2_FN_SGStartEndDate ON dbo.BIS2_VW_DailyPlayer.HackJoin = BIS2_FN_SGStartEndDate.HackJoin LEFT JOIN dbo.BIS2_Patron_Profile ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_Patron_Profile.AccountNumber INNER JOIN dbo.cqa ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.cqa.pk INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_VW_Patron.Account_Number LEFT JOIN dbo.BIS2_VW_Exclusion_Flags ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Exclusion_Flags.Patron_Number WHERE ((dbo.BIS2_VW_DailyPlayer.GamingDate >= '20160926') AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20161003') AND ((dbo.BIS2_Patron_Profile.EnrolledDate >= '20160926') AND (dbo.BIS2_Patron_Profile.EnrolledDate < '20161003') AND ((dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag IS NULL) OR (dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag NOT IN ('50','51','55','82','83','84','85','86','87','89'))) AND (dbo.cqa.allocation_id = '34cf66d1f-1578c09840f'))) GROUP BY dbo.BIS2_Patron_Profile.EnrolledDate,dbo.BIS2_VW_DailyPlayer.PlayerID/* End: BIS2_SQLTC_DailyPlayerSummary*/) AS BIS2_SQLTC_DailyPlayerSummary ON dbo.BIS2_VW_DailyPlayer.PlayerID = BIS2_SQLTC_DailyPlayerSummary.PlayerID WHERE (dbo.BIS2_VW_DailyPlayer.GamingDate >= '20160926')  AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20161003')  AND ((dbo.BIS2_Patron_Profile.EnrolledDate >= '20160926') AND (dbo.BIS2_Patron_Profile.EnrolledDate < '20161003') AND ((dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag IS NULL) OR (dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag NOT IN ('50','51','55','82','83','84','85','86','87','89'))) AND (dbo.cqa.allocation_id = '34cf66d1f-1578c09840f')) AND ((dbo.BIS2_Patron_Profile.EnrolledDate >= '20160926') AND (dbo.BIS2_Patron_Profile.EnrolledDate < '20161003') AND ((dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag IS NULL) OR (dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag NOT IN ('50','51','55','82','83','84','85','86','87','89'))) AND (dbo.cqa.allocation_id = '34cf66d1f-1578c09840f')) AND ((dbo.BIS2_Patron_Profile.EnrolledDate >= '20160926') AND (dbo.BIS2_Patron_Profile.EnrolledDate < '20161003') AND ((dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag IS NULL) OR (dbo.BIS2_VW_Exclusion_Flags.Exclusion_Flag NOT IN ('50','51','55','82','83','84','85','86','87','89'))) AND (dbo.cqa.allocation_id = '34cf66d1f-1578c09840f'))
2016-10-04 10:32:20.768989: Checking 34e3597c2-15387972e80 (Avg Daily Theo vs Avg Monthly Visits, AV_Q02):
	Query: SELECT dbo.cqa.cell_index AS CellIndex,'Q'+substring(cqa.cell_index,1,1) AS QL1,'Q'+substring(cqa.cell_index,1,2) AS QL2,'Q'+substring(cqa.cell_index,1,3) AS QL3,'Q'+substring(cqa.cell_index,1,4) AS QL4,CASE WHEN SUM(BIS2_VW_DailyPlayer.CoinIn) <> 0 THEN 100.0 *   SUM(BIS2_VW_DailyPlayer.ActualWin)/SUM(BIS2_VW_DailyPlayer.CoinIn) ELSE 0 END AS ActualHoldPCT,SUM(dbo.BIS2_VW_DailyPlayer.ActualWin) AS ActualWin,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS   varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) +  cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS ADT,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct   cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) ELSE 0 END AS AMT,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) +   cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) <> 0 THEN cast(Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS   varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))AS decimal)/Count(distinct  cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) ELSE 0 END AS AMV,CASE WHEN SUM(BIS2_VW_DailyPlayer.GamesPlayed) <> 0 THEN   SUM(BIS2_VW_DailyPlayer.CoinIn)/SUM(BIS2_VW_DailyPlayer.GamesPlayed) ELSE 0 END AS AvgBet,SUM(dbo.BIS2_VW_DailyPlayer.CoinIn) AS CoinIn,SUM(dbo.BIS2_VW_DailyPlayer.Freeplay) AS Freeplay,SUM(dbo.BIS2_VW_DailyPlayer.GamesPlayed) AS GamesPlayed,SUM(BIS2_VW_DailyPlayer.timeplayedsec/3600.0) AS HoursPlayed,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS   varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.timeplayedsec/3600.0)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS  varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS HoursPlayedperVisit,SUM(dbo.BIS2_VW_DailyPlayer.Jackpot) AS Jackpot,max(bis2_sqltc_dailyplayersummary.adt) AS MaxADT,max(bis2_sqltc_dailyplayersummary.AMV) AS MaxAMV,Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) AS MonthswithPlay,COUNT(distinct BIS2_VW_DailyPlayer.PlayerID) AS PlayerCount,CASE WHEN SUM(BIS2_VW_DailyPlayer.CoinIn) <> 0 THEN 100.0 *   SUM(BIS2_VW_DailyPlayer.TheoWin)/SUM(BIS2_VW_DailyPlayer.CoinIn) ELSE 0 END AS TheoHoldPCT,SUM(dbo.BIS2_VW_DailyPlayer.TheoWin) AS TheoWin,Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) AS Visits,CASE WHEN COUNT(distinct BIS2_VW_DailyPlayer.PlayerID) <> 0 THEN Cast(Count(distinct   cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) AS  decimal)/COUNT(distinct BIS2_VW_DailyPlayer.PlayerID) ELSE 0 END AS VisitsperPlayer FROM dbo.BIS2_VW_DailyPlayer INNER JOIN dbo.cqa ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.cqa.pk INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DailyPlayerSummary*/SELECT dbo.BIS2_Patron_Profile.EnrolledDate AS DateEnrolled,DATEDIFF(dd,MAX(dbo.BIS2_Patron_Profile.EnrolledDate),MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceEnrol,MAX(BIS2_VW_DailyPlayer.GamingDate) AS LastTrip,dbo.BIS2_VW_DailyPlayer.PlayerID AS PlayerID,CASE WHEN SUM(BIS2_VW_DailyPlayer.TheoWin) <>0 THEN SUM(BIS2_VW_DailyPlayer.ActualWin)/SUM(BIS2_VW_DailyPlayer.TheoWin)   ELSE 0 END AS ActualWinTheoWinRatio,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS   varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) +  cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS ADT,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct   cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) ELSE 0 END AS AMT,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) +   cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) <> 0 THEN cast(Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS   varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))AS decimal)/Count(distinct  cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) ELSE 0 END AS AMV,CASE WHEN SUM(case when cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_DailyPlayer.TheoWin ELSE 0 END)<>0 THEN (100.0*(SUM(case when   cast(BIS2_VW_DailyPlayer.GamingDate AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_DailyPlayer.TheoWin ELSE 0 END)-SUM(case when   cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_DailyPlayer.TheoWin ELSE 0 END)))/SUM(case when   cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_DailyPlayer.TheoWin ELSE 0 END) ELSE 0 END AS DailyPercentChangeTheo,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_DailyPlayer.PlayerID as varchar)+CASE WHEN cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_DailyPlayer.GamingDate AS date) as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_DailyPlayer.PlayerID as varchar)+CASE WHEN cast(BIS2_VW_DailyPlayer.GamingDate AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_DailyPlayer.GamingDate AS date) as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_DailyPlayer.PlayerID as varchar)+CASE WHEN cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_DailyPlayer.GamingDate AS date) as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_DailyPlayer.PlayerID as varchar)+CASE WHEN cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_DailyPlayer.GamingDate AS date) as varchar) ELSE NULL END) ELSE 0 END AS DailyPercentChangeVisits,CASE WHEN    (CASE WHEN (Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1) <> 0     THEN (DATEDIFF(dd,MIN(BIS2_VW_DailyPlayer.GamingDate),MAX(BIS2_VW_DailyPlayer.GamingDate)))/     (Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1)     ELSE 0 END)     <> 0    THEN (DATEDIFF(dd,MAX(BIS2_VW_DailyPlayer.GamingDate),MAX(BIS2_FN_SGStartEndDate.SGEndDate)))/    (CASE WHEN (Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1) <> 0      THEN CAST((DATEDIFF(dd,MIN(BIS2_VW_DailyPlayer.GamingDate),MAX(BIS2_VW_DailyPlayer.GamingDate)))/      (Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1) AS DECIMAL)     ELSE 0 END)    ELSE 0 END AS DailyPlayerTripsOwed,DATEDIFF(dd,  MAX(BIS2_VW_DailyPlayer.GamingDate),  MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,SUM(CASE WHEN BIS2_VW_DailyPlayer.TheoWin <> 0 THEN (BIS2_VW_DailyPlayer.Freeplay/BIS2_VW_DailyPlayer.TheoWin)*100.0 ELSE 0 END) AS FreeplayReinvestmentPCT,CASE WHEN (DATEDIFF(dd,  MIN(BIS2_VW_DailyPlayer.GamingDate),  MAX(BIS2_VW_DailyPlayer.GamingDate))) <> 0 THEN (Count( distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) +   cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1) / (DATEDIFF(dd,  MIN(BIS2_VW_DailyPlayer.GamingDate),  MAX(BIS2_VW_DailyPlayer.GamingDate))) ELSE 0 END AS VisitDensity,Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) AS Visits FROM dbo.BIS2_VW_DailyPlayer INNER HASH JOIN dbo.BIS2_FN_SGStartEndDate('20160312 00:00:00','20160313 00:00:00') AS BIS2_FN_SGStartEndDate ON dbo.BIS2_VW_DailyPlayer.HackJoin = BIS2_FN_SGStartEndDate.HackJoin INNER JOIN dbo.cqa ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.cqa.pk LEFT JOIN dbo.BIS2_Patron_Profile ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_Patron_Profile.AccountNumber WHERE ((dbo.BIS2_VW_DailyPlayer.GamingDate >= '20160312') AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20160313') AND (dbo.cqa.allocation_id = '34e35a07d-15387974da4')) GROUP BY dbo.BIS2_Patron_Profile.EnrolledDate,dbo.BIS2_VW_DailyPlayer.PlayerID/* End: BIS2_SQLTC_DailyPlayerSummary*/) AS BIS2_SQLTC_DailyPlayerSummary ON dbo.BIS2_VW_DailyPlayer.PlayerID = BIS2_SQLTC_DailyPlayerSummary.PlayerID WHERE ((dbo.BIS2_VW_DailyPlayer.GamingDate >= '20160312') AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20160313') AND (dbo.cqa.allocation_id = '34e35a07d-15387974da4')) GROUP BY dbo.cqa.cell_index,'Q'+substring(cqa.cell_index,1,1),'Q'+substring(cqa.cell_index,1,2),'Q'+substring(cqa.cell_index,1,3),'Q'+substring(cqa.cell_index,1,4)
	DocAggs: ['ActualHoldPCT', 'ActualWin', 'ADT', 'AMT', 'AvgBet', 'CoinIn', 'Freeplay', 'GamesPlayed', 'HoursPlayed', 'HoursPlayedperVisit', 'Jackpot', 'PlayerCount', 'TheoHoldPCT', 'TheoWin']
	DocAggDict: {'PlayerCount': 'COUNT(distinct BIS2_VW_DailyPlayer.PlayerID) AS PlayerCount', 'ActualWin': 'SUM(dbo.BIS2_VW_DailyPlayer.ActualWin) AS ActualWin', 'AvgBet': 'SUM(BIS2_VW_DailyPlayer.GamesPlayed) <> 0 THEN   SUM(BIS2_VW_DailyPlayer.CoinIn)/SUM(BIS2_VW_DailyPlayer.GamesPlayed) ELSE 0 END AS AvgBet', 'ActualHoldPCT': 'SUM(BIS2_VW_DailyPlayer.CoinIn) <> 0 THEN 100.0 *   SUM(BIS2_VW_DailyPlayer.ActualWin)/SUM(BIS2_VW_DailyPlayer.CoinIn) ELSE 0 END AS ActualHoldPCT', 'TheoWin': 'SUM(dbo.BIS2_VW_DailyPlayer.TheoWin) AS TheoWin', 'CoinIn': 'SUM(dbo.BIS2_VW_DailyPlayer.CoinIn) AS CoinIn', 'AMT': 'SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct   cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) ELSE 0 END AS AMT', 'HoursPlayed': 'SUM(BIS2_VW_DailyPlayer.timeplayedsec/3600.0) AS HoursPlayed', 'GamesPlayed': 'SUM(dbo.BIS2_VW_DailyPlayer.GamesPlayed) AS GamesPlayed', 'ADT': 'SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) +  cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS ADT', 'Jackpot': 'SUM(dbo.BIS2_VW_DailyPlayer.Jackpot) AS Jackpot', 'Freeplay': 'SUM(dbo.BIS2_VW_DailyPlayer.Freeplay) AS Freeplay', 'TheoHoldPCT': 'SUM(BIS2_VW_DailyPlayer.CoinIn) <> 0 THEN 100.0 *   SUM(BIS2_VW_DailyPlayer.TheoWin)/SUM(BIS2_VW_DailyPlayer.CoinIn) ELSE 0 END AS TheoHoldPCT', 'HoursPlayedperVisit': 'SUM(BIS2_VW_DailyPlayer.timeplayedsec/3600.0)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS  varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS HoursPlayedperVisit'}
	DocJoins: ['dbo.BIS2_VW_DailyPlayer', 'dbo.cqa', 'BIS2_SQLTC_DailyPlayerSummary']DocJoinDict: {'BIS2_SQLTC_DailyPlayerSummary': "INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DailyPlayerSummary*/SELECT dbo.BIS2_Patron_Profile.EnrolledDate AS DateEnrolled,DATEDIFF(dd,MAX(dbo.BIS2_Patron_Profile.EnrolledDate),MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceEnrol,MAX(BIS2_VW_DailyPlayer.GamingDate) AS LastTrip,dbo.BIS2_VW_DailyPlayer.PlayerID AS PlayerID,CASE WHEN SUM(BIS2_VW_DailyPlayer.TheoWin) <>0 THEN SUM(BIS2_VW_DailyPlayer.ActualWin)/SUM(BIS2_VW_DailyPlayer.TheoWin)   ELSE 0 END AS ActualWinTheoWinRatio,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS   varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) +  cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS ADT,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct   cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) ELSE 0 END AS AMT,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) +   cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) <> 0 THEN cast(Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS   varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))AS decimal)/Count(distinct  cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) ELSE 0 END AS AMV,CASE WHEN SUM(case when cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_DailyPlayer.TheoWin ELSE 0 END)<>0 THEN (100.0*(SUM(case when   cast(BIS2_VW_DailyPlayer.GamingDate AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_DailyPlayer.TheoWin ELSE 0 END)-SUM(case when   cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_DailyPlayer.TheoWin ELSE 0 END)))/SUM(case when   cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_DailyPlayer.TheoWin ELSE 0 END) ELSE 0 END AS DailyPercentChangeTheo,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_DailyPlayer.PlayerID as varchar)+CASE WHEN cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_DailyPlayer.GamingDate AS date) as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_DailyPlayer.PlayerID as varchar)+CASE WHEN cast(BIS2_VW_DailyPlayer.GamingDate AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_DailyPlayer.GamingDate AS date) as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_DailyPlayer.PlayerID as varchar)+CASE WHEN cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_DailyPlayer.GamingDate AS date) as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_DailyPlayer.PlayerID as varchar)+CASE WHEN cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_DailyPlayer.GamingDate AS date) as varchar) ELSE NULL END) ELSE 0 END AS DailyPercentChangeVisits,CASE WHEN    (CASE WHEN (Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1) <> 0     THEN (DATEDIFF(dd,MIN(BIS2_VW_DailyPlayer.GamingDate),MAX(BIS2_VW_DailyPlayer.GamingDate)))/     (Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1)     ELSE 0 END)     <> 0    THEN (DATEDIFF(dd,MAX(BIS2_VW_DailyPlayer.GamingDate),MAX(BIS2_FN_SGStartEndDate.SGEndDate)))/    (CASE WHEN (Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1) <> 0      THEN CAST((DATEDIFF(dd,MIN(BIS2_VW_DailyPlayer.GamingDate),MAX(BIS2_VW_DailyPlayer.GamingDate)))/      (Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1) AS DECIMAL)     ELSE 0 END)    ELSE 0 END AS DailyPlayerTripsOwed,DATEDIFF(dd,  MAX(BIS2_VW_DailyPlayer.GamingDate),  MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,SUM(CASE WHEN BIS2_VW_DailyPlayer.TheoWin <> 0 THEN (BIS2_VW_DailyPlayer.Freeplay/BIS2_VW_DailyPlayer.TheoWin)*100.0 ELSE 0 END) AS FreeplayReinvestmentPCT,CASE WHEN (DATEDIFF(dd,  MIN(BIS2_VW_DailyPlayer.GamingDate),  MAX(BIS2_VW_DailyPlayer.GamingDate))) <> 0 THEN (Count( distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) +   cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1) / (DATEDIFF(dd,  MIN(BIS2_VW_DailyPlayer.GamingDate),  MAX(BIS2_VW_DailyPlayer.GamingDate))) ELSE 0 END AS VisitDensity,Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) AS Visits FROM dbo.BIS2_VW_DailyPlayer INNER HASH JOIN dbo.BIS2_FN_SGStartEndDate('20160312 00:00:00','20160313 00:00:00') AS BIS2_FN_SGStartEndDate ON dbo.BIS2_VW_DailyPlayer.HackJoin = BIS2_FN_SGStartEndDate.HackJoin INNER JOIN dbo.cqa ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.cqa.pk LEFT JOIN dbo.BIS2_Patron_Profile ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_Patron_Profile.AccountNumber WHERE ((dbo.BIS2_VW_DailyPlayer.GamingDate >= '20160312') AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20160313') AND (dbo.cqa.allocation_id = '34e35a07d-15387974da4')) GROUP BY dbo.BIS2_Patron_Profile.EnrolledDate,dbo.BIS2_VW_DailyPlayer.PlayerID/* End: BIS2_SQLTC_DailyPlayerSummary*/) AS BIS2_SQLTC_DailyPlayerSummary ON dbo.BIS2_VW_DailyPlayer.PlayerID = BIS2_SQLTC_DailyPlayerSummary.PlayerID ", 'dbo.cqa': 'INNER JOIN dbo.cqa ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.cqa.pk ', 'dbo.BIS2_VW_DailyPlayer': 'FROM dbo.BIS2_VW_DailyPlayer '}
	DocWhere: ["(dbo.BIS2_VW_DailyPlayer.GamingDate >= '20160312') ", "(dbo.BIS2_VW_DailyPlayer.GamingDate < '20160313') ", "(dbo.cqa.allocation_id = '34e35a07d-15387974da4')"]
	DocWhereAnd: {"(dbo.BIS2_VW_DailyPlayer.GamingDate < '20160313') ": 'AND ', "(dbo.BIS2_VW_DailyPlayer.GamingDate >= '20160312') ": 'start', "(dbo.cqa.allocation_id = '34e35a07d-15387974da4')": 'AND '}
2016-10-04 10:32:26.429562: Final data about 34e3597c2-15387972e80:
	UserAggList: ['ActualWin', 'CoinIn', 'Freeplay', 'Jackpot', 'TheoWin']
	UserRestrictList: []
	FinalQuery: SELECT 'Step 1' AS Step, SUM(dbo.BIS2_VW_DailyPlayer.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_DailyPlayer.CoinIn) AS CoinIn, SUM(dbo.BIS2_VW_DailyPlayer.Freeplay) AS Freeplay, SUM(dbo.BIS2_VW_DailyPlayer.Jackpot) AS Jackpot, SUM(dbo.BIS2_VW_DailyPlayer.TheoWin) AS TheoWin, 'dbo.BIS2_VW_DailyPlayer' AS StepInfo FROM dbo.BIS2_VW_DailyPlayer WHERE (dbo.BIS2_VW_DailyPlayer.GamingDate >= '20160312')  AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20160313')  UNION ALL SELECT 'Step 2' AS Step, SUM(dbo.BIS2_VW_DailyPlayer.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_DailyPlayer.CoinIn) AS CoinIn, SUM(dbo.BIS2_VW_DailyPlayer.Freeplay) AS Freeplay, SUM(dbo.BIS2_VW_DailyPlayer.Jackpot) AS Jackpot, SUM(dbo.BIS2_VW_DailyPlayer.TheoWin) AS TheoWin, 'dbo.cqa' AS StepInfo FROM dbo.BIS2_VW_DailyPlayer INNER JOIN dbo.cqa ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.cqa.pk WHERE (dbo.BIS2_VW_DailyPlayer.GamingDate >= '20160312')  AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20160313')  AND (dbo.cqa.allocation_id = '34e35a07d-15387974da4') UNION ALL SELECT 'Step 3' AS Step, SUM(dbo.BIS2_VW_DailyPlayer.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_DailyPlayer.CoinIn) AS CoinIn, SUM(dbo.BIS2_VW_DailyPlayer.Freeplay) AS Freeplay, SUM(dbo.BIS2_VW_DailyPlayer.Jackpot) AS Jackpot, SUM(dbo.BIS2_VW_DailyPlayer.TheoWin) AS TheoWin, 'BIS2_SQLTC_DailyPlayerSummary' AS StepInfo FROM dbo.BIS2_VW_DailyPlayer INNER JOIN dbo.cqa ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.cqa.pk INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DailyPlayerSummary*/SELECT dbo.BIS2_Patron_Profile.EnrolledDate AS DateEnrolled,DATEDIFF(dd,MAX(dbo.BIS2_Patron_Profile.EnrolledDate),MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceEnrol,MAX(BIS2_VW_DailyPlayer.GamingDate) AS LastTrip,dbo.BIS2_VW_DailyPlayer.PlayerID AS PlayerID,CASE WHEN SUM(BIS2_VW_DailyPlayer.TheoWin) <>0 THEN SUM(BIS2_VW_DailyPlayer.ActualWin)/SUM(BIS2_VW_DailyPlayer.TheoWin)   ELSE 0 END AS ActualWinTheoWinRatio,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS   varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) +  cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS ADT,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct   cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) ELSE 0 END AS AMT,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) +   cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) <> 0 THEN cast(Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS   varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))AS decimal)/Count(distinct  cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) ELSE 0 END AS AMV,CASE WHEN SUM(case when cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_DailyPlayer.TheoWin ELSE 0 END)<>0 THEN (100.0*(SUM(case when   cast(BIS2_VW_DailyPlayer.GamingDate AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_DailyPlayer.TheoWin ELSE 0 END)-SUM(case when   cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_DailyPlayer.TheoWin ELSE 0 END)))/SUM(case when   cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN BIS2_VW_DailyPlayer.TheoWin ELSE 0 END) ELSE 0 END AS DailyPercentChangeTheo,CASE WHEN COUNT(DISTINCT cast(BIS2_VW_DailyPlayer.PlayerID as varchar)+CASE WHEN cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_DailyPlayer.GamingDate AS date) as varchar) ELSE NULL END)<>0 THEN   (100.0*(COUNT(DISTINCT cast(BIS2_VW_DailyPlayer.PlayerID as varchar)+CASE WHEN cast(BIS2_VW_DailyPlayer.GamingDate AS date)>=dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_DailyPlayer.GamingDate AS date) as varchar) ELSE NULL END)-   COUNT(DISTINCT cast(BIS2_VW_DailyPlayer.PlayerID as varchar)+CASE WHEN cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_DailyPlayer.GamingDate AS date) as varchar) ELSE NULL END)))/   COUNT(DISTINCT cast(BIS2_VW_DailyPlayer.PlayerID as varchar)+CASE WHEN cast(BIS2_VW_DailyPlayer.GamingDate AS date)<dateadd(day,  datediff(day,  BIS2_FN_SGStartEndDate.SGStartDate,  BIS2_FN_SGStartEndDate.SGEndDate)/2,  BIS2_FN_SGStartEndDate.SGStartDate) THEN cast(cast(BIS2_VW_DailyPlayer.GamingDate AS date) as varchar) ELSE NULL END) ELSE 0 END AS DailyPercentChangeVisits,CASE WHEN    (CASE WHEN (Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1) <> 0     THEN (DATEDIFF(dd,MIN(BIS2_VW_DailyPlayer.GamingDate),MAX(BIS2_VW_DailyPlayer.GamingDate)))/     (Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1)     ELSE 0 END)     <> 0    THEN (DATEDIFF(dd,MAX(BIS2_VW_DailyPlayer.GamingDate),MAX(BIS2_FN_SGStartEndDate.SGEndDate)))/    (CASE WHEN (Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1) <> 0      THEN CAST((DATEDIFF(dd,MIN(BIS2_VW_DailyPlayer.GamingDate),MAX(BIS2_VW_DailyPlayer.GamingDate)))/      (Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1) AS DECIMAL)     ELSE 0 END)    ELSE 0 END AS DailyPlayerTripsOwed,DATEDIFF(dd,  MAX(BIS2_VW_DailyPlayer.GamingDate),  MAX(BIS2_FN_SGStartEndDate.SGEndDate)) AS DaysSinceLastTrip,SUM(CASE WHEN BIS2_VW_DailyPlayer.TheoWin <> 0 THEN (BIS2_VW_DailyPlayer.Freeplay/BIS2_VW_DailyPlayer.TheoWin)*100.0 ELSE 0 END) AS FreeplayReinvestmentPCT,CASE WHEN (DATEDIFF(dd,  MIN(BIS2_VW_DailyPlayer.GamingDate),  MAX(BIS2_VW_DailyPlayer.GamingDate))) <> 0 THEN (Count( distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) +   cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))-1) / (DATEDIFF(dd,  MIN(BIS2_VW_DailyPlayer.GamingDate),  MAX(BIS2_VW_DailyPlayer.GamingDate))) ELSE 0 END AS VisitDensity,Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) AS Visits FROM dbo.BIS2_VW_DailyPlayer INNER HASH JOIN dbo.BIS2_FN_SGStartEndDate('20160312 00:00:00','20160313 00:00:00') AS BIS2_FN_SGStartEndDate ON dbo.BIS2_VW_DailyPlayer.HackJoin = BIS2_FN_SGStartEndDate.HackJoin INNER JOIN dbo.cqa ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.cqa.pk LEFT JOIN dbo.BIS2_Patron_Profile ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_Patron_Profile.AccountNumber WHERE ((dbo.BIS2_VW_DailyPlayer.GamingDate >= '20160312') AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20160313') AND (dbo.cqa.allocation_id = '34e35a07d-15387974da4')) GROUP BY dbo.BIS2_Patron_Profile.EnrolledDate,dbo.BIS2_VW_DailyPlayer.PlayerID/* End: BIS2_SQLTC_DailyPlayerSummary*/) AS BIS2_SQLTC_DailyPlayerSummary ON dbo.BIS2_VW_DailyPlayer.PlayerID = BIS2_SQLTC_DailyPlayerSummary.PlayerID WHERE (dbo.BIS2_VW_DailyPlayer.GamingDate >= '20160312')  AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20160313')  AND (dbo.cqa.allocation_id = '34e35a07d-15387974da4')
2016-10-04 10:32:26.471070: Checking 35153dd0a-14dde9b7dd0 (Campaign Matrix Dashboard, AV_D12):
	Query: SELECT dbo.BIS2_VW_CRMTables_CampaignMatrix.CampaignEndDate AS CampaignEndDate,dbo.BIS2_VW_CRMTables_CampaignMatrix.CampaignName AS CampaignName,dbo.BIS2_VW_CRMTables_CampaignMatrix.CampaignStartDate AS CampaignStartDate,dbo.BIS2_VW_CRMTables_CampaignMatrix.Description AS OfferDescription,dbo.BIS2_VW_CRMTables_CampaignMatrix.End_Date AS OfferEnd_Date,dbo.BIS2_VW_CRMTables_CampaignMatrix.Name AS OfferName,dbo.BIS2_VW_CRMTables_CampaignMatrix.Start_Date AS OfferStart_Date,dbo.BIS2_VW_CRMTables_CampaignMatrix.Value AS OfferValue,dbo.BIS2_VW_CRMTables_CampaignMatrix.SegmentName AS SegmentName,dbo.BIS2_VW_CRMTables_CampaignMatrix.Segment_ID AS Segment_ID,SUM(dbo.BIS2_VW_CRMTables_CampaignMatrix.InvitedPlayerCount) AS InvitedPlayerCount FROM dbo.BIS2_VW_CRMTables_CampaignMatrix GROUP BY dbo.BIS2_VW_CRMTables_CampaignMatrix.CampaignEndDate,dbo.BIS2_VW_CRMTables_CampaignMatrix.CampaignName,dbo.BIS2_VW_CRMTables_CampaignMatrix.CampaignStartDate,dbo.BIS2_VW_CRMTables_CampaignMatrix.Description,dbo.BIS2_VW_CRMTables_CampaignMatrix.End_Date,dbo.BIS2_VW_CRMTables_CampaignMatrix.Name,dbo.BIS2_VW_CRMTables_CampaignMatrix.Start_Date,dbo.BIS2_VW_CRMTables_CampaignMatrix.Value,dbo.BIS2_VW_CRMTables_CampaignMatrix.SegmentName,dbo.BIS2_VW_CRMTables_CampaignMatrix.Segment_ID
	DocAggs: []
	DocAggDict: {}
	DocJoins: ['dbo.BIS2_VW_CRMTables_CampaignMatrix']DocJoinDict: {'dbo.BIS2_VW_CRMTables_CampaignMatrix': 'FROM dbo.BIS2_VW_CRMTables_CampaignMatrix '}
	DocWhere: []
	DocWhereAnd: {}
2016-10-04 10:32:28.668968: Final data about 35153dd0a-14dde9b7dd0:
	UserAggList: []
	UserRestrictList: []
	FinalQuery: SELECT 'Step 1' AS Step, 'dbo.BIS2_VW_CRMTables_CampaignMatrix' AS StepInfo FROM dbo.BIS2_VW_CRMTables_CampaignMatrix 
2016-10-04 10:32:28.710476: Checking 34cd37a43-1570fdd5aa3 (Extract Info Dashboard, AV_D13):
	Query: SELECT dbo.BIS2_VW_ExtractInfo.DateLoaded AS VBB2__NORM_FIELD,dbo.BIS2_VW_ExtractInfo.DateLoaded2 AS DateLoaded2,dbo.BIS2_VW_ExtractInfo.ExtractNum AS ExtractNum,dbo.BIS2_VW_ExtractInfo.OfferEndDate AS OfferEndDate,dbo.BIS2_VW_ExtractInfo.OfferStartDate AS OfferStartDate,dbo.BIS2_VW_ExtractInfo.PromoCode AS PromoCode,dbo.BIS2_VW_ExtractInfo.Promotion AS Promotion,dbo.BIS2_VW_ExtractInfo.RecordNum AS RecordNum,dbo.BIS2_VW_ExtractInfo.SegmentName AS SegmentName,SUM(dbo.BIS2_VW_ExtractInfo.OfferAmount) AS OfferAmount FROM dbo.BIS2_VW_ExtractInfo WHERE ((dbo.BIS2_VW_ExtractInfo.DateLoaded >= '20160901') AND (dbo.BIS2_VW_ExtractInfo.DateLoaded < '20160916') AND (dbo.BIS2_VW_ExtractInfo.OfferStartDate >= '20161001')) GROUP BY dbo.BIS2_VW_ExtractInfo.DateLoaded,dbo.BIS2_VW_ExtractInfo.DateLoaded2,dbo.BIS2_VW_ExtractInfo.ExtractNum,dbo.BIS2_VW_ExtractInfo.OfferEndDate,dbo.BIS2_VW_ExtractInfo.OfferStartDate,dbo.BIS2_VW_ExtractInfo.PromoCode,dbo.BIS2_VW_ExtractInfo.Promotion,dbo.BIS2_VW_ExtractInfo.RecordNum,dbo.BIS2_VW_ExtractInfo.SegmentName
	DocAggs: []
	DocAggDict: {}
	DocJoins: ['dbo.BIS2_VW_ExtractInfo']DocJoinDict: {'dbo.BIS2_VW_ExtractInfo': 'FROM dbo.BIS2_VW_ExtractInfo '}
	DocWhere: ["(dbo.BIS2_VW_ExtractInfo.DateLoaded >= '20160901') ", "(dbo.BIS2_VW_ExtractInfo.DateLoaded < '20160916') ", "(dbo.BIS2_VW_ExtractInfo.OfferStartDate >= '20161001')"]
	DocWhereAnd: {"(dbo.BIS2_VW_ExtractInfo.DateLoaded >= '20160901') ": 'start', "(dbo.BIS2_VW_ExtractInfo.OfferStartDate >= '20161001')": 'AND ', "(dbo.BIS2_VW_ExtractInfo.DateLoaded < '20160916') ": 'AND '}
2016-10-04 10:32:33.555897: Final data about 34cd37a43-1570fdd5aa3:
	UserAggList: []
	UserRestrictList: []
	FinalQuery: SELECT 'Step 1' AS Step, 'dbo.BIS2_VW_ExtractInfo' AS StepInfo FROM dbo.BIS2_VW_ExtractInfo WHERE (dbo.BIS2_VW_ExtractInfo.DateLoaded >= '20160901')  AND (dbo.BIS2_VW_ExtractInfo.OfferStartDate >= '20161001') AND (dbo.BIS2_VW_ExtractInfo.DateLoaded < '20160916') 
2016-10-04 10:32:33.587417: Checking 30dbbbacd-14cfdb3fe11 (Fight Zone Map Theo Win per PlayerID, AV_S03):
	Query: SELECT dbo.BIS2_VW_Patron.Age AS Age,dbo.BIS2_VW_Patron.Residential_City AS City,dbo.BIS2_VW_Patron.Account_Number AS CustomerID,dbo.BIS2_VW_GeocodedPatrons.DistanceToProperty AS DistanceToProperty,dbo.BIS2_VW_Patron.Patron_First_Name AS FName,dbo.BIS2_VW_Patron.Applicant_Sex AS Gender,dbo.BIS2_VW_GeocodedPatrons.Lat AS Latitude,dbo.BIS2_VW_Patron.Patron_Last_Name AS LName,dbo.BIS2_VW_GeocodedPatrons.Long AS Longitude,dbo.BIS2_VW_DailyPlayer.PlayerID AS PatronID,dbo.BIS2_VW_Patron.Residential_State AS State,dbo.BIS2_VW_Patron.Zip3 AS Zip3,dbo.BIS2_VW_Patron.Zip5 AS Zip5,dbo.BIS2_VW_GEO_FZ_Combined.fz_name AS FightZoneName,dbo.BIS2_VW_GEO_FZ_Combined.startgd AS FightZoneName_SCD_Start,dbo.BIS2_VW_GEO_FZ_Combined.endgd AS FightZoneName_SCD_End,CASE WHEN SUM(BIS2_VW_DailyPlayer.CoinIn) <> 0 THEN 100.0 *   SUM(BIS2_VW_DailyPlayer.ActualWin)/SUM(BIS2_VW_DailyPlayer.CoinIn) ELSE 0 END AS ActualHoldPCT,SUM(dbo.BIS2_VW_DailyPlayer.ActualWin) AS ActualWin,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS   varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.actualWin)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS  varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS ActualWinperVisit,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct   cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) ELSE 0 END AS AMT,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) +   cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) <> 0 THEN cast(Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS   varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))AS decimal)/Count(distinct  cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) ELSE 0 END AS AMV,CASE WHEN SUM(BIS2_VW_DailyPlayer.GamesPlayed) <> 0 THEN   SUM(BIS2_VW_DailyPlayer.CoinIn)/SUM(BIS2_VW_DailyPlayer.GamesPlayed) ELSE 0 END AS AvgBet,SUM(dbo.BIS2_VW_DailyPlayer.CoinIn) AS CoinIn,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS   varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.coinin)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS  varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS CoinInperVisit,SUM(dbo.BIS2_VW_DailyPlayer.Freeplay) AS Freeplay,SUM(dbo.BIS2_VW_DailyPlayer.GamesPlayed) AS GamesPlayed,SUM(BIS2_VW_DailyPlayer.timeplayedsec/3600.0) AS HoursPlayed,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS   varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.timeplayedsec/3600.0)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS  varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS HoursPlayedperVisit,SUM(dbo.BIS2_VW_DailyPlayer.Jackpot) AS Jackpot,Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) AS MonthswithPlay,COUNT(distinct BIS2_VW_DailyPlayer.PlayerID) AS PlayerCount,CASE WHEN SUM(BIS2_VW_DailyPlayer.CoinIn) <> 0 THEN 100.0 *   SUM(BIS2_VW_DailyPlayer.TheoWin)/SUM(BIS2_VW_DailyPlayer.CoinIn) ELSE 0 END AS TheoHoldPCT,SUM(dbo.BIS2_VW_DailyPlayer.TheoWin) AS TheoWin,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS   varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS  varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS TheoWinPerVisit,Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) AS Visits FROM dbo.BIS2_VW_DailyPlayer INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_VW_Patron.Account_Number LEFT JOIN dbo.BIS2_VW_GeocodedPatrons ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_GeocodedPatrons.PlayerID INNER HASH JOIN dbo.BIS2_VW_GEO_FZ_Combined ON BIS2_VW_GeocodedPatrons.geo_wbt.STWithin(BIS2_VW_GEO_FZ_Combined.wkb_geo) = 1 WHERE ((dbo.BIS2_VW_DailyPlayer.GamingDate >= '20150401') AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20150408') AND (dbo.BIS2_VW_GEO_FZ_Combined.startgd < '20150408 00:00:00') AND (dbo.BIS2_VW_GEO_FZ_Combined.endgd >= '20150408 00:00:00')) GROUP BY dbo.BIS2_VW_Patron.Age,dbo.BIS2_VW_Patron.Residential_City,dbo.BIS2_VW_Patron.Account_Number,dbo.BIS2_VW_GeocodedPatrons.DistanceToProperty,dbo.BIS2_VW_Patron.Patron_First_Name,dbo.BIS2_VW_Patron.Applicant_Sex,dbo.BIS2_VW_GeocodedPatrons.Lat,dbo.BIS2_VW_Patron.Patron_Last_Name,dbo.BIS2_VW_GeocodedPatrons.Long,dbo.BIS2_VW_DailyPlayer.PlayerID,dbo.BIS2_VW_Patron.Residential_State,dbo.BIS2_VW_Patron.Zip3,dbo.BIS2_VW_Patron.Zip5,dbo.BIS2_VW_GEO_FZ_Combined.fz_name,dbo.BIS2_VW_GEO_FZ_Combined.startgd,dbo.BIS2_VW_GEO_FZ_Combined.endgd
	DocAggs: ['ActualHoldPCT', 'ActualWin', 'ActualWinperVisit', 'AMT', 'AvgBet', 'CoinIn', 'CoinInperVisit', 'Freeplay', 'GamesPlayed', 'HoursPlayed', 'HoursPlayedperVisit', 'Jackpot', 'PlayerCount', 'TheoHoldPCT', 'TheoWin', 'TheoWinPerVisit']
	DocAggDict: {'ActualWinperVisit': 'SUM(BIS2_VW_DailyPlayer.actualWin)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS  varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS ActualWinperVisit', 'ActualWin': 'SUM(dbo.BIS2_VW_DailyPlayer.ActualWin) AS ActualWin', 'CoinInperVisit': 'SUM(BIS2_VW_DailyPlayer.coinin)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS  varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS CoinInperVisit', 'PlayerCount': 'COUNT(distinct BIS2_VW_DailyPlayer.PlayerID) AS PlayerCount', 'AvgBet': 'SUM(BIS2_VW_DailyPlayer.GamesPlayed) <> 0 THEN   SUM(BIS2_VW_DailyPlayer.CoinIn)/SUM(BIS2_VW_DailyPlayer.GamesPlayed) ELSE 0 END AS AvgBet', 'ActualHoldPCT': 'SUM(BIS2_VW_DailyPlayer.CoinIn) <> 0 THEN 100.0 *   SUM(BIS2_VW_DailyPlayer.ActualWin)/SUM(BIS2_VW_DailyPlayer.CoinIn) ELSE 0 END AS ActualHoldPCT', 'TheoWin': 'SUM(dbo.BIS2_VW_DailyPlayer.TheoWin) AS TheoWin', 'CoinIn': 'SUM(dbo.BIS2_VW_DailyPlayer.CoinIn) AS CoinIn', 'Jackpot': 'SUM(dbo.BIS2_VW_DailyPlayer.Jackpot) AS Jackpot', 'TheoWinPerVisit': 'SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS  varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS TheoWinPerVisit', 'HoursPlayed': 'SUM(BIS2_VW_DailyPlayer.timeplayedsec/3600.0) AS HoursPlayed', 'GamesPlayed': 'SUM(dbo.BIS2_VW_DailyPlayer.GamesPlayed) AS GamesPlayed', 'AMT': 'SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct   cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) ELSE 0 END AS AMT', 'Freeplay': 'SUM(dbo.BIS2_VW_DailyPlayer.Freeplay) AS Freeplay', 'TheoHoldPCT': 'SUM(BIS2_VW_DailyPlayer.CoinIn) <> 0 THEN 100.0 *   SUM(BIS2_VW_DailyPlayer.TheoWin)/SUM(BIS2_VW_DailyPlayer.CoinIn) ELSE 0 END AS TheoHoldPCT', 'HoursPlayedperVisit': 'SUM(BIS2_VW_DailyPlayer.timeplayedsec/3600.0)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS  varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS HoursPlayedperVisit'}
	DocJoins: ['dbo.BIS2_VW_DailyPlayer', 'dbo.BIS2_VW_Patron', 'dbo.BIS2_VW_GeocodedPatrons', 'dbo.BIS2_VW_GEO_FZ_Combined']DocJoinDict: {'dbo.BIS2_VW_Patron': 'INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_VW_Patron.Account_Number ', 'dbo.BIS2_VW_GeocodedPatrons': 'LEFT JOIN dbo.BIS2_VW_GeocodedPatrons ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_GeocodedPatrons.PlayerID ', 'dbo.BIS2_VW_DailyPlayer': 'FROM dbo.BIS2_VW_DailyPlayer ', 'dbo.BIS2_VW_GEO_FZ_Combined': 'INNER HASH JOIN dbo.BIS2_VW_GEO_FZ_Combined ON BIS2_VW_GeocodedPatrons.geo_wbt.STWithin(BIS2_VW_GEO_FZ_Combined.wkb_geo) = 1 '}
	DocWhere: ["(dbo.BIS2_VW_DailyPlayer.GamingDate >= '20150401') ", "(dbo.BIS2_VW_DailyPlayer.GamingDate < '20150408') ", "(dbo.BIS2_VW_GEO_FZ_Combined.startgd < '20150408 00:00:00') ", "(dbo.BIS2_VW_GEO_FZ_Combined.endgd >= '20150408 00:00:00')"]
	DocWhereAnd: {"(dbo.BIS2_VW_GEO_FZ_Combined.endgd >= '20150408 00:00:00')": 'AND ', "(dbo.BIS2_VW_DailyPlayer.GamingDate >= '20150401') ": 'start', "(dbo.BIS2_VW_GEO_FZ_Combined.startgd < '20150408 00:00:00') ": 'AND ', "(dbo.BIS2_VW_DailyPlayer.GamingDate < '20150408') ": 'AND '}
2016-10-04 10:32:41.078668: Final data about 30dbbbacd-14cfdb3fe11:
	UserAggList: ['ActualWin', 'CoinIn', 'Freeplay', 'Jackpot', 'TheoWin']
	UserRestrictList: []
	FinalQuery: SELECT 'Step 1' AS Step, SUM(dbo.BIS2_VW_DailyPlayer.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_DailyPlayer.CoinIn) AS CoinIn, SUM(dbo.BIS2_VW_DailyPlayer.Freeplay) AS Freeplay, SUM(dbo.BIS2_VW_DailyPlayer.Jackpot) AS Jackpot, SUM(dbo.BIS2_VW_DailyPlayer.TheoWin) AS TheoWin, 'dbo.BIS2_VW_DailyPlayer' AS StepInfo FROM dbo.BIS2_VW_DailyPlayer WHERE (dbo.BIS2_VW_DailyPlayer.GamingDate >= '20150401')  AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20150408')  UNION ALL SELECT 'Step 2' AS Step, SUM(dbo.BIS2_VW_DailyPlayer.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_DailyPlayer.CoinIn) AS CoinIn, SUM(dbo.BIS2_VW_DailyPlayer.Freeplay) AS Freeplay, SUM(dbo.BIS2_VW_DailyPlayer.Jackpot) AS Jackpot, SUM(dbo.BIS2_VW_DailyPlayer.TheoWin) AS TheoWin, 'dbo.BIS2_VW_Patron' AS StepInfo FROM dbo.BIS2_VW_DailyPlayer INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_VW_Patron.Account_Number WHERE (dbo.BIS2_VW_DailyPlayer.GamingDate >= '20150401')  AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20150408')  UNION ALL SELECT 'Step 3' AS Step, SUM(dbo.BIS2_VW_DailyPlayer.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_DailyPlayer.CoinIn) AS CoinIn, SUM(dbo.BIS2_VW_DailyPlayer.Freeplay) AS Freeplay, SUM(dbo.BIS2_VW_DailyPlayer.Jackpot) AS Jackpot, SUM(dbo.BIS2_VW_DailyPlayer.TheoWin) AS TheoWin, 'dbo.BIS2_VW_GeocodedPatrons' AS StepInfo FROM dbo.BIS2_VW_DailyPlayer INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_VW_Patron.Account_Number LEFT JOIN dbo.BIS2_VW_GeocodedPatrons ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_GeocodedPatrons.PlayerID WHERE (dbo.BIS2_VW_DailyPlayer.GamingDate >= '20150401')  AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20150408')  UNION ALL SELECT 'Step 4' AS Step, SUM(dbo.BIS2_VW_DailyPlayer.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_DailyPlayer.CoinIn) AS CoinIn, SUM(dbo.BIS2_VW_DailyPlayer.Freeplay) AS Freeplay, SUM(dbo.BIS2_VW_DailyPlayer.Jackpot) AS Jackpot, SUM(dbo.BIS2_VW_DailyPlayer.TheoWin) AS TheoWin, 'dbo.BIS2_VW_GEO_FZ_Combined' AS StepInfo FROM dbo.BIS2_VW_DailyPlayer INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_VW_Patron.Account_Number LEFT JOIN dbo.BIS2_VW_GeocodedPatrons ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_GeocodedPatrons.PlayerID INNER HASH JOIN dbo.BIS2_VW_GEO_FZ_Combined ON BIS2_VW_GeocodedPatrons.geo_wbt.STWithin(BIS2_VW_GEO_FZ_Combined.wkb_geo) = 1 WHERE (dbo.BIS2_VW_DailyPlayer.GamingDate >= '20150401')  AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20150408')  AND (dbo.BIS2_VW_GEO_FZ_Combined.startgd < '20150408 00:00:00')  AND (dbo.BIS2_VW_GEO_FZ_Combined.endgd >= '20150408 00:00:00')
2016-10-04 10:32:41.144216: Checking 35f1f66bd-14be1028139 (Player Count by Day over Week, AV_T02):
	Query: SELECT datepart(year,dbo.BIS2_VW_PlayerSession.Time_Stopped)*10000+datepart(mm,dbo.BIS2_VW_PlayerSession.Time_Stopped)*100+datepart(dd,dbo.BIS2_VW_PlayerSession.Time_Stopped) AS VBB2__NORM_FIELD,substring(datename(weekday, BIS2_VW_PlayerSession.Time_Stopped),1,3) AS DayofWeek,RIGHT('00' + RTRIM(datepart(dd,BIS2_VW_PlayerSession.Time_Stopped)), 2) AS Day_,substring(DATENAME(month, BIS2_VW_PlayerSession.Time_Stopped),1,3) AS MonthName,datepart(year,BIS2_VW_PlayerSession.Time_Stopped)*10000+datepart(mm,BIS2_VW_PlayerSession.Time_Stopped)*100+datepart(dd,BIS2_VW_PlayerSession.Time_Stopped) AS NormDay,DATEPART(year,BIS2_VW_PlayerSession.Time_Stopped) AS Year_,SUM(dbo.BIS2_VW_PlayerSession.ActualWin) AS ActualWin,SUM(dbo.BIS2_VW_PlayerSession.coin_in_dollars_cents) AS CoinIn,SUM(dbo.BIS2_VW_PlayerSession.Handle_Pulls_Meter) AS GamesPlayed,SUM(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) AS HoursPlayed,count(distinct dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big) AS PlayerCount,SUM(ISNULL(dbo.BIS2_VW_PlayerSession.theo_loss_dol,0)) AS TheoWin FROM dbo.BIS2_VW_PlayerSession WHERE ((dbo.BIS2_VW_PlayerSession.Time_Stopped >= '20140707 00:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Stopped < '20150101 00:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Stopped >= '20140706 00:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Stopped < '20150102 00:00:00')) GROUP BY datepart(year,dbo.BIS2_VW_PlayerSession.Time_Stopped)*10000+datepart(mm,dbo.BIS2_VW_PlayerSession.Time_Stopped)*100+datepart(dd,dbo.BIS2_VW_PlayerSession.Time_Stopped),substring(datename(weekday, BIS2_VW_PlayerSession.Time_Stopped),1,3),RIGHT('00' + RTRIM(datepart(dd,BIS2_VW_PlayerSession.Time_Stopped)), 2),substring(DATENAME(month, BIS2_VW_PlayerSession.Time_Stopped),1,3),datepart(year,BIS2_VW_PlayerSession.Time_Stopped)*10000+datepart(mm,BIS2_VW_PlayerSession.Time_Stopped)*100+datepart(dd,BIS2_VW_PlayerSession.Time_Stopped),DATEPART(year,BIS2_VW_PlayerSession.Time_Stopped)
	DocAggs: ['ActualWin', 'CoinIn', 'GamesPlayed', 'HoursPlayed']
	DocAggDict: {'HoursPlayed': 'SUM(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) AS HoursPlayed', 'ActualWin': 'SUM(dbo.BIS2_VW_PlayerSession.ActualWin) AS ActualWin', 'CoinIn': 'SUM(dbo.BIS2_VW_PlayerSession.coin_in_dollars_cents) AS CoinIn', 'GamesPlayed': 'SUM(dbo.BIS2_VW_PlayerSession.Handle_Pulls_Meter) AS GamesPlayed'}
	DocJoins: ['dbo.BIS2_VW_PlayerSession']DocJoinDict: {'dbo.BIS2_VW_PlayerSession': 'FROM dbo.BIS2_VW_PlayerSession '}
	DocWhere: ["(dbo.BIS2_VW_PlayerSession.Time_Stopped >= '20140707 00:00:00') ", "(dbo.BIS2_VW_PlayerSession.Time_Stopped < '20150101 00:00:00') ", "(dbo.BIS2_VW_PlayerSession.Time_Stopped >= '20140706 00:00:00') ", "(dbo.BIS2_VW_PlayerSession.Time_Stopped < '20150102 00:00:00')"]
	DocWhereAnd: {"(dbo.BIS2_VW_PlayerSession.Time_Stopped < '20150102 00:00:00')": 'AND ', "(dbo.BIS2_VW_PlayerSession.Time_Stopped >= '20140707 00:00:00') ": 'start', "(dbo.BIS2_VW_PlayerSession.Time_Stopped < '20150101 00:00:00') ": 'AND ', "(dbo.BIS2_VW_PlayerSession.Time_Stopped >= '20140706 00:00:00') ": 'AND '}
2016-10-04 10:32:44.741237: Final data about 35f1f66bd-14be1028139:
	UserAggList: ['ActualWin', 'CoinIn', 'GamesPlayed', 'HoursPlayed']
	UserRestrictList: []
	FinalQuery: SELECT 'Step 1' AS Step, SUM(dbo.BIS2_VW_PlayerSession.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_PlayerSession.coin_in_dollars_cents) AS CoinIn, SUM(dbo.BIS2_VW_PlayerSession.Handle_Pulls_Meter) AS GamesPlayed, SUM(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) AS HoursPlayed, 'dbo.BIS2_VW_PlayerSession' AS StepInfo FROM dbo.BIS2_VW_PlayerSession WHERE (dbo.BIS2_VW_PlayerSession.Time_Stopped >= '20140707 00:00:00')  AND (dbo.BIS2_VW_PlayerSession.Time_Stopped >= '20140706 00:00:00')  AND (dbo.BIS2_VW_PlayerSession.Time_Stopped < '20150101 00:00:00')  AND (dbo.BIS2_VW_PlayerSession.Time_Stopped < '20150102 00:00:00')
2016-10-04 10:32:44.833296: Checking 30db00c98-14cfc70d581 (US Map Theo Win per Zip3, AV_S01):
	Query: SELECT dbo.BIS2_Zip3.City AS City,dbo.BIS2_Zip3.Latitude AS Latitude,dbo.BIS2_Zip3.Longitude AS Longitude,dbo.BIS2_Zip3.ST AS State,dbo.BIS2_Zip3.Zip3 AS Zip3,CASE WHEN SUM(BIS2_VW_DailyPlayer.CoinIn) <> 0 THEN 100.0 *   SUM(BIS2_VW_DailyPlayer.ActualWin)/SUM(BIS2_VW_DailyPlayer.CoinIn) ELSE 0 END AS ActualHoldPCT,SUM(dbo.BIS2_VW_DailyPlayer.ActualWin) AS ActualWin,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS   varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.actualWin)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS  varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS ActualWinperVisit,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct   cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) ELSE 0 END AS AMT,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) +   cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) <> 0 THEN cast(Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS   varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar))AS decimal)/Count(distinct  cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) ELSE 0 END AS AMV,CASE WHEN SUM(BIS2_VW_DailyPlayer.GamesPlayed) <> 0 THEN   SUM(BIS2_VW_DailyPlayer.CoinIn)/SUM(BIS2_VW_DailyPlayer.GamesPlayed) ELSE 0 END AS AvgBet,SUM(dbo.BIS2_VW_DailyPlayer.CoinIn) AS CoinIn,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS   varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.coinin)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS  varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS CoinInperVisit,SUM(dbo.BIS2_VW_DailyPlayer.Freeplay) AS Freeplay,SUM(dbo.BIS2_VW_DailyPlayer.GamesPlayed) AS GamesPlayed,SUM(BIS2_VW_DailyPlayer.timeplayedsec/3600.0) AS HoursPlayed,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS   varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.timeplayedsec/3600.0)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS  varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS HoursPlayedperVisit,SUM(dbo.BIS2_VW_DailyPlayer.Jackpot) AS Jackpot,Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) AS MonthswithPlay,COUNT(distinct BIS2_VW_DailyPlayer.PlayerID) AS PlayerCount,CASE WHEN SUM(BIS2_VW_DailyPlayer.CoinIn) <> 0 THEN 100.0 *   SUM(BIS2_VW_DailyPlayer.TheoWin)/SUM(BIS2_VW_DailyPlayer.CoinIn) ELSE 0 END AS TheoHoldPCT,SUM(dbo.BIS2_VW_DailyPlayer.TheoWin) AS TheoWin,CASE WHEN Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS   varchar)) <> 0 THEN SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS  varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS TheoWinPerVisit,Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) AS Visits FROM dbo.BIS2_VW_DailyPlayer INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.BIS2_Zip3 ON dbo.BIS2_VW_Patron.Zip3 = dbo.BIS2_Zip3.Zip3 WHERE ((dbo.BIS2_VW_DailyPlayer.GamingDate >= '20150101') AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20150401')) GROUP BY dbo.BIS2_Zip3.City,dbo.BIS2_Zip3.Latitude,dbo.BIS2_Zip3.Longitude,dbo.BIS2_Zip3.ST,dbo.BIS2_Zip3.Zip3
	DocAggs: ['ActualHoldPCT', 'ActualWin', 'ActualWinperVisit', 'AMT', 'AvgBet', 'CoinIn', 'CoinInperVisit', 'Freeplay', 'GamesPlayed', 'HoursPlayed', 'HoursPlayedperVisit', 'Jackpot', 'PlayerCount', 'TheoHoldPCT', 'TheoWin', 'TheoWinPerVisit']
	DocAggDict: {'ActualWinperVisit': 'SUM(BIS2_VW_DailyPlayer.actualWin)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS  varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS ActualWinperVisit', 'ActualWin': 'SUM(dbo.BIS2_VW_DailyPlayer.ActualWin) AS ActualWin', 'CoinInperVisit': 'SUM(BIS2_VW_DailyPlayer.coinin)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS  varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS CoinInperVisit', 'PlayerCount': 'COUNT(distinct BIS2_VW_DailyPlayer.PlayerID) AS PlayerCount', 'AvgBet': 'SUM(BIS2_VW_DailyPlayer.GamesPlayed) <> 0 THEN   SUM(BIS2_VW_DailyPlayer.CoinIn)/SUM(BIS2_VW_DailyPlayer.GamesPlayed) ELSE 0 END AS AvgBet', 'ActualHoldPCT': 'SUM(BIS2_VW_DailyPlayer.CoinIn) <> 0 THEN 100.0 *   SUM(BIS2_VW_DailyPlayer.ActualWin)/SUM(BIS2_VW_DailyPlayer.CoinIn) ELSE 0 END AS ActualHoldPCT', 'TheoWin': 'SUM(dbo.BIS2_VW_DailyPlayer.TheoWin) AS TheoWin', 'CoinIn': 'SUM(dbo.BIS2_VW_DailyPlayer.CoinIn) AS CoinIn', 'Jackpot': 'SUM(dbo.BIS2_VW_DailyPlayer.Jackpot) AS Jackpot', 'TheoWinPerVisit': 'SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS  varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS TheoWinPerVisit', 'HoursPlayed': 'SUM(BIS2_VW_DailyPlayer.timeplayedsec/3600.0) AS HoursPlayed', 'GamesPlayed': 'SUM(dbo.BIS2_VW_DailyPlayer.GamesPlayed) AS GamesPlayed', 'AMT': 'SUM(BIS2_VW_DailyPlayer.TheoWin)/Count(distinct   cast(BIS2_VW_DailyPlayer.PlayerID AS varchar) + cast(datepart(mm,  BIS2_VW_DailyPlayer.Gamingdate) AS varchar) + cast(datepart(yy,  BIS2_VW_DailyPlayer.GamingDate) AS varchar)) ELSE 0 END AS AMT', 'Freeplay': 'SUM(dbo.BIS2_VW_DailyPlayer.Freeplay) AS Freeplay', 'TheoHoldPCT': 'SUM(BIS2_VW_DailyPlayer.CoinIn) <> 0 THEN 100.0 *   SUM(BIS2_VW_DailyPlayer.TheoWin)/SUM(BIS2_VW_DailyPlayer.CoinIn) ELSE 0 END AS TheoHoldPCT', 'HoursPlayedperVisit': 'SUM(BIS2_VW_DailyPlayer.timeplayedsec/3600.0)/Count(distinct cast(BIS2_VW_DailyPlayer.PlayerID AS  varchar) + cast(BIS2_VW_DailyPlayer.GamingDate AS varchar)) ELSE 0 END AS HoursPlayedperVisit'}
	DocJoins: ['dbo.BIS2_VW_DailyPlayer', 'dbo.BIS2_VW_Patron', 'dbo.BIS2_Zip3']DocJoinDict: {'dbo.BIS2_VW_Patron': 'INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_VW_Patron.Account_Number ', 'dbo.BIS2_Zip3': 'INNER JOIN dbo.BIS2_Zip3 ON dbo.BIS2_VW_Patron.Zip3 = dbo.BIS2_Zip3.Zip3 ', 'dbo.BIS2_VW_DailyPlayer': 'FROM dbo.BIS2_VW_DailyPlayer '}
	DocWhere: ["(dbo.BIS2_VW_DailyPlayer.GamingDate >= '20150101') ", "(dbo.BIS2_VW_DailyPlayer.GamingDate < '20150401')"]
	DocWhereAnd: {"(dbo.BIS2_VW_DailyPlayer.GamingDate < '20150401')": 'AND ', "(dbo.BIS2_VW_DailyPlayer.GamingDate >= '20150101') ": 'start'}
2016-10-04 10:32:50.283926: Final data about 30db00c98-14cfc70d581:
	UserAggList: ['ActualWin', 'CoinIn', 'Freeplay', 'Jackpot', 'TheoWin']
	UserRestrictList: []
	FinalQuery: SELECT 'Step 1' AS Step, SUM(dbo.BIS2_VW_DailyPlayer.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_DailyPlayer.CoinIn) AS CoinIn, SUM(dbo.BIS2_VW_DailyPlayer.Freeplay) AS Freeplay, SUM(dbo.BIS2_VW_DailyPlayer.Jackpot) AS Jackpot, SUM(dbo.BIS2_VW_DailyPlayer.TheoWin) AS TheoWin, 'dbo.BIS2_VW_DailyPlayer' AS StepInfo FROM dbo.BIS2_VW_DailyPlayer WHERE (dbo.BIS2_VW_DailyPlayer.GamingDate >= '20150101')  AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20150401') UNION ALL SELECT 'Step 2' AS Step, SUM(dbo.BIS2_VW_DailyPlayer.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_DailyPlayer.CoinIn) AS CoinIn, SUM(dbo.BIS2_VW_DailyPlayer.Freeplay) AS Freeplay, SUM(dbo.BIS2_VW_DailyPlayer.Jackpot) AS Jackpot, SUM(dbo.BIS2_VW_DailyPlayer.TheoWin) AS TheoWin, 'dbo.BIS2_VW_Patron' AS StepInfo FROM dbo.BIS2_VW_DailyPlayer INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_VW_Patron.Account_Number WHERE (dbo.BIS2_VW_DailyPlayer.GamingDate >= '20150101')  AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20150401') UNION ALL SELECT 'Step 3' AS Step, SUM(dbo.BIS2_VW_DailyPlayer.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_DailyPlayer.CoinIn) AS CoinIn, SUM(dbo.BIS2_VW_DailyPlayer.Freeplay) AS Freeplay, SUM(dbo.BIS2_VW_DailyPlayer.Jackpot) AS Jackpot, SUM(dbo.BIS2_VW_DailyPlayer.TheoWin) AS TheoWin, 'dbo.BIS2_Zip3' AS StepInfo FROM dbo.BIS2_VW_DailyPlayer INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_DailyPlayer.PlayerID = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.BIS2_Zip3 ON dbo.BIS2_VW_Patron.Zip3 = dbo.BIS2_Zip3.Zip3 WHERE (dbo.BIS2_VW_DailyPlayer.GamingDate >= '20150101')  AND (dbo.BIS2_VW_DailyPlayer.GamingDate < '20150401')
2016-10-04 10:32:50.347479: Checking 350350359-14d113d69e1 (Top 50 Players by Actual Win by Month, AV_P03):
	Query: SELECT sign(datepart(dd,BIS2_FN_TopPlayersbyMonth.Norm)) AS VBB2__NORM_FIELD,cast(cast(round(BIS2_FN_TopPlayersbyMonth.LastMonthActualWin,2) as int) as varchar)+' '+BIS2_VW_Patron.Patron_First_Name+' '+BIS2_VW_Patron.Patron_Last_Name+' '+cast(BIS2_FN_TopPlayersbyMonth.Patron_Account_Number_9_Big as varchar) AS ActualWinPlayerNamePlayerID,BIS2_FN_TopPlayersbyMonth.ActualWinRanking AS ActualWinRanking,dbo.BIS2_VW_Patron.Patron_First_Name AS FName,BIS2_FN_TopPlayersbyMonth.GamingMonth AS GamingMonth,BIS2_FN_TopPlayersbyMonth.GamingYear AS GamingYear,BIS2_FN_TopPlayersbyMonth.GamingYearMonth AS GamingYearMonth,dbo.BIS2_VW_Host_Patron.rep_code AS HostID,dbo.BIS2_VW_Host_Master.HostName AS HostName,BIS2_FN_TopPlayersbyMonth.int_yearMonth AS int_yearMonth,BIS2_FN_TopPlayersbyMonth.LastMonthActualWin AS LastMonthActualWin,BIS2_FN_TopPlayersbyMonth.LastMonthPlayerWin AS LastMonthPlayerWin,dbo.BIS2_VW_Patron.Patron_Last_Name AS LName,BIS2_FN_TopPlayersbyMonth.Patron_Account_Number_9_Big AS PlayerID,SUM(BIS2_FN_TopPlayersbyMonth.ActualWin) AS ActualWin,SUM(BIS2_FN_TopPlayersbyMonth.CoinIn) AS CoinIn,SUM(BIS2_FN_TopPlayersbyMonth.GamesPlayed) AS GamesPlayed,SUM(BIS2_FN_TopPlayersbyMonth.HoursPlayed) AS HoursPlayed,SUM(BIS2_FN_TopPlayersbyMonth.PlayerWin) AS PlayerWin,SUM(BIS2_FN_TopPlayersbyMonth.TheoWin) AS TheoWin,SUM(BIS2_FN_TopPlayersbyMonth.Visits) AS Visits FROM dbo.BIS2_FN_TopPlayersbyMonth('20140301 00:00:00','20150401 00:00:00') AS BIS2_FN_TopPlayersbyMonth INNER JOIN dbo.BIS2_VW_Patron ON BIS2_FN_TopPlayersbyMonth.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number LEFT JOIN dbo.BIS2_VW_Host_Patron ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Host_Patron.account_number LEFT JOIN dbo.BIS2_VW_Host_Master ON dbo.BIS2_VW_Host_Patron.rep_code = dbo.BIS2_VW_Host_Master.Employee_Number WHERE ((BIS2_FN_TopPlayersbyMonth.ActualWinRanking <= 245) AND (dbo.BIS2_VW_Patron.Age >= 62)) GROUP BY sign(datepart(dd,BIS2_FN_TopPlayersbyMonth.Norm)),cast(cast(round(BIS2_FN_TopPlayersbyMonth.LastMonthActualWin,2) as int) as varchar)+' '+BIS2_VW_Patron.Patron_First_Name+' '+BIS2_VW_Patron.Patron_Last_Name+' '+cast(BIS2_FN_TopPlayersbyMonth.Patron_Account_Number_9_Big as varchar),BIS2_FN_TopPlayersbyMonth.ActualWinRanking,dbo.BIS2_VW_Patron.Patron_First_Name,BIS2_FN_TopPlayersbyMonth.GamingMonth,BIS2_FN_TopPlayersbyMonth.GamingYear,BIS2_FN_TopPlayersbyMonth.GamingYearMonth,dbo.BIS2_VW_Host_Patron.rep_code,dbo.BIS2_VW_Host_Master.HostName,BIS2_FN_TopPlayersbyMonth.int_yearMonth,BIS2_FN_TopPlayersbyMonth.LastMonthActualWin,BIS2_FN_TopPlayersbyMonth.LastMonthPlayerWin,dbo.BIS2_VW_Patron.Patron_Last_Name,BIS2_FN_TopPlayersbyMonth.Patron_Account_Number_9_Big
	DocAggs: ['ActualWin', 'CoinIn', 'GamesPlayed', 'HoursPlayed', 'PlayerWin', 'TheoWin']
	DocAggDict: {'ActualWin': 'SUM(BIS2_FN_TopPlayersbyMonth.ActualWin) AS ActualWin', 'TheoWin': 'SUM(BIS2_FN_TopPlayersbyMonth.TheoWin) AS TheoWin', 'PlayerWin': 'SUM(BIS2_FN_TopPlayersbyMonth.PlayerWin) AS PlayerWin', 'HoursPlayed': 'SUM(BIS2_FN_TopPlayersbyMonth.HoursPlayed) AS HoursPlayed', 'CoinIn': 'SUM(BIS2_FN_TopPlayersbyMonth.CoinIn) AS CoinIn', 'GamesPlayed': 'SUM(BIS2_FN_TopPlayersbyMonth.GamesPlayed) AS GamesPlayed'}
	DocJoins: ["dbo.BIS2_FN_TopPlayersbyMonth('20140301", 'dbo.BIS2_VW_Patron', 'dbo.BIS2_VW_Host_Patron', 'dbo.BIS2_VW_Host_Master']DocJoinDict: {"dbo.BIS2_FN_TopPlayersbyMonth('20140301": "FROM dbo.BIS2_FN_TopPlayersbyMonth('20140301 00:00:00','20150401 00:00:00') AS BIS2_FN_TopPlayersbyMonth ", 'dbo.BIS2_VW_Patron': 'INNER JOIN dbo.BIS2_VW_Patron ON BIS2_FN_TopPlayersbyMonth.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number ', 'dbo.BIS2_VW_Host_Master': 'LEFT JOIN dbo.BIS2_VW_Host_Master ON dbo.BIS2_VW_Host_Patron.rep_code = dbo.BIS2_VW_Host_Master.Employee_Number ', 'dbo.BIS2_VW_Host_Patron': 'LEFT JOIN dbo.BIS2_VW_Host_Patron ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Host_Patron.account_number '}
	DocWhere: ['(BIS2_FN_TopPlayersbyMonth.ActualWinRanking <= 245) ', '(dbo.BIS2_VW_Patron.Age >= 62)']
	DocWhereAnd: {'(dbo.BIS2_VW_Patron.Age >= 62)': 'AND ', '(BIS2_FN_TopPlayersbyMonth.ActualWinRanking <= 245) ': 'start'}
2016-10-04 10:33:01.374347: Final data about 350350359-14d113d69e1:
	UserAggList: ['ActualWin', 'CoinIn', 'GamesPlayed', 'PlayerWin', 'TheoWin']
	UserRestrictList: ['(dbo.BIS2_VW_Patron.Age >= 62)']
	FinalQuery: SELECT 'Step 1' AS Step, SUM(BIS2_FN_TopPlayersbyMonth.ActualWin) AS ActualWin, SUM(BIS2_FN_TopPlayersbyMonth.CoinIn) AS CoinIn, SUM(BIS2_FN_TopPlayersbyMonth.GamesPlayed) AS GamesPlayed, SUM(BIS2_FN_TopPlayersbyMonth.PlayerWin) AS PlayerWin, SUM(BIS2_FN_TopPlayersbyMonth.TheoWin) AS TheoWin, 'dbo.BIS2_FN_TopPlayersbyMonth' AS StepInfo FROM dbo.BIS2_FN_TopPlayersbyMonth('20140301 00:00:00','20150401 00:00:00') AS BIS2_FN_TopPlayersbyMonth  UNION ALL SELECT 'Step 2' AS Step, SUM(BIS2_FN_TopPlayersbyMonth.ActualWin) AS ActualWin, SUM(BIS2_FN_TopPlayersbyMonth.CoinIn) AS CoinIn, SUM(BIS2_FN_TopPlayersbyMonth.GamesPlayed) AS GamesPlayed, SUM(BIS2_FN_TopPlayersbyMonth.PlayerWin) AS PlayerWin, SUM(BIS2_FN_TopPlayersbyMonth.TheoWin) AS TheoWin, 'dbo.BIS2_VW_Patron' AS StepInfo FROM dbo.BIS2_FN_TopPlayersbyMonth('20140301 00:00:00','20150401 00:00:00') AS BIS2_FN_TopPlayersbyMonth INNER JOIN dbo.BIS2_VW_Patron ON BIS2_FN_TopPlayersbyMonth.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number  UNION ALL SELECT 'Step 2B' AS Step, SUM(BIS2_FN_TopPlayersbyMonth.ActualWin) AS ActualWin, SUM(BIS2_FN_TopPlayersbyMonth.CoinIn) AS CoinIn, SUM(BIS2_FN_TopPlayersbyMonth.GamesPlayed) AS GamesPlayed, SUM(BIS2_FN_TopPlayersbyMonth.PlayerWin) AS PlayerWin, SUM(BIS2_FN_TopPlayersbyMonth.TheoWin) AS TheoWin, 'dbo.BIS2_VW_Patron (Restriction)' AS StepInfo FROM dbo.BIS2_FN_TopPlayersbyMonth('20140301 00:00:00','20150401 00:00:00') AS BIS2_FN_TopPlayersbyMonth INNER JOIN dbo.BIS2_VW_Patron ON BIS2_FN_TopPlayersbyMonth.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number WHERE  AND (dbo.BIS2_VW_Patron.Age >= 62) UNION ALL SELECT 'Step 3' AS Step, SUM(BIS2_FN_TopPlayersbyMonth.ActualWin) AS ActualWin, SUM(BIS2_FN_TopPlayersbyMonth.CoinIn) AS CoinIn, SUM(BIS2_FN_TopPlayersbyMonth.GamesPlayed) AS GamesPlayed, SUM(BIS2_FN_TopPlayersbyMonth.PlayerWin) AS PlayerWin, SUM(BIS2_FN_TopPlayersbyMonth.TheoWin) AS TheoWin, 'dbo.BIS2_VW_Host_Patron' AS StepInfo FROM dbo.BIS2_FN_TopPlayersbyMonth('20140301 00:00:00','20150401 00:00:00') AS BIS2_FN_TopPlayersbyMonth INNER JOIN dbo.BIS2_VW_Patron ON BIS2_FN_TopPlayersbyMonth.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number LEFT JOIN dbo.BIS2_VW_Host_Patron ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Host_Patron.account_number WHERE  AND (dbo.BIS2_VW_Patron.Age >= 62) UNION ALL SELECT 'Step 4' AS Step, SUM(BIS2_FN_TopPlayersbyMonth.ActualWin) AS ActualWin, SUM(BIS2_FN_TopPlayersbyMonth.CoinIn) AS CoinIn, SUM(BIS2_FN_TopPlayersbyMonth.GamesPlayed) AS GamesPlayed, SUM(BIS2_FN_TopPlayersbyMonth.PlayerWin) AS PlayerWin, SUM(BIS2_FN_TopPlayersbyMonth.TheoWin) AS TheoWin, 'dbo.BIS2_VW_Host_Master' AS StepInfo FROM dbo.BIS2_FN_TopPlayersbyMonth('20140301 00:00:00','20150401 00:00:00') AS BIS2_FN_TopPlayersbyMonth INNER JOIN dbo.BIS2_VW_Patron ON BIS2_FN_TopPlayersbyMonth.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number LEFT JOIN dbo.BIS2_VW_Host_Patron ON dbo.BIS2_VW_Patron.Account_Number = dbo.BIS2_VW_Host_Patron.account_number LEFT JOIN dbo.BIS2_VW_Host_Master ON dbo.BIS2_VW_Host_Patron.rep_code = dbo.BIS2_VW_Host_Master.Employee_Number WHERE  AND (dbo.BIS2_VW_Patron.Age >= 62)
2016-10-04 10:33:01.524965: Checking 34cc52c7e-1525d161787 (Player Preference Dashboard, AV_D07 v2.0):
	Query: SELECT BIS2_SQLTC_Rated_Main.CabinetType AS CabinetType,BIS2_SQLTC_Rated_Main.Denom AS Denom,BIS2_SQLTC_Rated_Main.GameType AS GameType,BIS2_SQLTC_Rated_Main.Manufacturer AS Manufacturer,BIS2_SQLTC_Rated_Main.PlayerID AS PlayerID,BIS2_SQLTC_Rated_Main.SiteID AS SiteID,BIS2_SQLTC_Rated_Main.Theme AS Theme,BIS2_SQLTC_Rated_Main.ThemeMod AS ThemeMod,COUNT(DISTINCT BIS2_SQLTC_Rated_Main.PlayerID) AS PlayerCount,SUM(BIS2_SQLTC_Rated_Main.PreferencePercentActualWin) AS PreferencePercentActualWin,SUM(BIS2_SQLTC_Rated_Main.PreferencePercentCoinIn) AS PreferencePercentCoinIn,SUM(BIS2_SQLTC_Rated_Main.PreferencePercentHoursPlayed) AS PreferencePercentHoursPlayed,SUM(BIS2_SQLTC_Rated_Main.PreferencePercentTheoWin) AS PreferencePercentTheoWin,SUM(BIS2_SQLTC_Rated_Main.TotalActualWinPlayer) AS TotalActualWinPlayer,SUM(BIS2_SQLTC_Rated_Main.TotalActualWinPlayerTheme) AS TotalActualWinPlayerTheme,SUM(BIS2_SQLTC_Rated_Main.TotalCoinInPlayer) AS TotalCoinInPlayer,SUM(BIS2_SQLTC_Rated_Main.TotalCoinInPlayerTheme) AS TotalCoinInPlayerTheme,SUM(BIS2_SQLTC_Rated_Main.TotalHoursPlayedPlayer) AS TotalHoursPlayedPlayer,SUM(BIS2_SQLTC_Rated_Main.TotalHoursPlayedPlayerTheme) AS TotalHoursPlayedPlayerTheme,SUM(BIS2_SQLTC_Rated_Main.TotalTheoWinPlayer) AS TotalTheoWinPlayer,SUM(BIS2_SQLTC_Rated_Main.TotalTheoWinPlayerTheme) AS TotalTheoWinPlayerTheme FROM (/* SqlTableCalculator: BIS2_SQLTC_Rated_Main*/SELECT BIS2_SQLTC_RatedData.CabinetType AS CabinetType,BIS2_SQLTC_RatedData.Denom AS Denom,BIS2_SQLTC_RatedData.GameType AS GameType,BIS2_SQLTC_RatedData.Manufacturer AS Manufacturer,BIS2_SQLTC_RatedData.PlayerID AS PlayerID,BIS2_SQLTC_RatedData.SiteID AS SiteID,BIS2_SQLTC_RatedData.Theme AS Theme,BIS2_SQLTC_RatedData.ThemeMod AS ThemeMod,CASE WHEN SUM(BIS2_SQLTC_RatedData.ActualWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID)<>0 THEN  SUM(BIS2_SQLTC_RatedData.ActualWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.Theme,BIS2_SQLTC_RatedData.Manufacturer,BIS2_SQLTC_RatedData.Denom,BIS2_SQLTC_RatedData.CabinetType,BIS2_SQLTC_RatedData.GameType,BIS2_SQLTC_RatedData.PlayerID)*100.0/  SUM(BIS2_SQLTC_RatedData.ActualWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID) ELSE 0 END AS PreferencePercentActualWin,CASE WHEN SUM(BIS2_SQLTC_RatedData.CoinIn) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID)<>0 THEN  SUM(BIS2_SQLTC_RatedData.CoinIn) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.Theme,BIS2_SQLTC_RatedData.Manufacturer,BIS2_SQLTC_RatedData.Denom,BIS2_SQLTC_RatedData.CabinetType,BIS2_SQLTC_RatedData.GameType,BIS2_SQLTC_RatedData.PlayerID)*100.0/  SUM(BIS2_SQLTC_RatedData.CoinIn) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID) ELSE 0 END AS PreferencePercentCoinIn,CASE WHEN SUM(BIS2_SQLTC_RatedData.HoursPlayed) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID)<>0 THEN  SUM(BIS2_SQLTC_RatedData.HoursPlayed) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.Theme,BIS2_SQLTC_RatedData.Manufacturer,BIS2_SQLTC_RatedData.Denom,BIS2_SQLTC_RatedData.CabinetType,BIS2_SQLTC_RatedData.GameType,BIS2_SQLTC_RatedData.PlayerID)*100.0/  SUM(BIS2_SQLTC_RatedData.HoursPlayed) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID) ELSE 0 END AS PreferencePercentHoursPlayed,CASE WHEN SUM(BIS2_SQLTC_RatedData.TheoWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID)<>0 THEN  SUM(BIS2_SQLTC_RatedData.TheoWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.Theme,BIS2_SQLTC_RatedData.Manufacturer,BIS2_SQLTC_RatedData.Denom,BIS2_SQLTC_RatedData.CabinetType,BIS2_SQLTC_RatedData.GameType,BIS2_SQLTC_RatedData.PlayerID)*100.0/  SUM(BIS2_SQLTC_RatedData.TheoWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID) ELSE 0 END AS PreferencePercentTheoWin,SUM(BIS2_SQLTC_RatedData.ActualWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID) AS TotalActualWinPlayer,SUM(BIS2_SQLTC_RatedData.ActualWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.Theme,BIS2_SQLTC_RatedData.Manufacturer,BIS2_SQLTC_RatedData.Denom,  BIS2_SQLTC_RatedData.CabinetType,BIS2_SQLTC_RatedData.GameType,BIS2_SQLTC_RatedData.PlayerID) AS TotalActualWinPlayerTheme,SUM(BIS2_SQLTC_RatedData.CoinIn) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID) AS TotalCoinInPlayer,SUM(BIS2_SQLTC_RatedData.CoinIn) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.Theme,BIS2_SQLTC_RatedData.Manufacturer,BIS2_SQLTC_RatedData.Denom,  BIS2_SQLTC_RatedData.CabinetType,BIS2_SQLTC_RatedData.GameType,BIS2_SQLTC_RatedData.PlayerID) AS TotalCoinInPlayerTheme,SUM(BIS2_SQLTC_RatedData.HoursPlayed) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID) AS TotalHoursPlayedPlayer,SUM(BIS2_SQLTC_RatedData.HoursPlayed) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.Theme,BIS2_SQLTC_RatedData.Manufacturer,BIS2_SQLTC_RatedData.Denom,  BIS2_SQLTC_RatedData.CabinetType,BIS2_SQLTC_RatedData.GameType,BIS2_SQLTC_RatedData.PlayerID) AS TotalHoursPlayedPlayerTheme,SUM(BIS2_SQLTC_RatedData.TheoWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID) AS TotalTheoWinPlayer,SUM(BIS2_SQLTC_RatedData.TheoWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.Theme,BIS2_SQLTC_RatedData.Manufacturer,BIS2_SQLTC_RatedData.Denom,  BIS2_SQLTC_RatedData.CabinetType,BIS2_SQLTC_RatedData.GameType,BIS2_SQLTC_RatedData.PlayerID) AS TotalTheoWinPlayerTheme FROM (/* SqlTableCalculator: BIS2_SQLTC_RatedData*/SELECT dbo.BIS2_VW_Slot_Config.Cabinet_Type AS CabinetType,dbo.BIS2_VW_Slot_Config.denomination_nominal AS Denom,dbo.BIS2_VW_Slot_Config.Game_Code AS GameType,dbo.BIS2_VW_Slot_Config.Manufacturer_Short_Name AS Manufacturer,dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS PlayerID,dbo.BIS2_VW_PlayerSession.Property_Id AS SiteID,dbo.BIS2_VW_Slot_Config.Game_Description AS Theme,REPLACE(BIS2_VW_Slot_Config.Game_Description,'''','_') AS ThemeMod,SUM(dbo.BIS2_VW_PlayerSession.ActualWin) AS ActualWin,CASE WHEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) ELSE 0 END AS ADT,CASE WHEN CAST(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / CAST(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) ELSE 0 END AS AMT,CASE WHEN COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) <> 0 THEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal)/ COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) ELSE 0 END AS AMV,SUM(dbo.BIS2_VW_PlayerSession.coin_in_dollars_cents) AS CoinIn,SUM(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) AS HoursPlayed,SUM(ISNULL(dbo.BIS2_VW_PlayerSession.theo_loss_dol,0)) AS TheoWin,cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) AS Visits FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_PlayerSession.asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_PlayerSession.Time_Stopped >= dbo.BIS2_VW_Slot_Config.AV_Start_Date AND dbo.BIS2_VW_PlayerSession.Time_Stopped < dbo.BIS2_VW_Slot_Config.AV_End_Date AND dbo.BIS2_VW_PlayerSession.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20151001 00:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20160101 00:00:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20150930') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20160102') AND (dbo.SelectionList.GROUPID = '34cc2d1a1-1525d09b411')) GROUP BY dbo.BIS2_VW_Slot_Config.Cabinet_Type,dbo.BIS2_VW_Slot_Config.denomination_nominal,dbo.BIS2_VW_Slot_Config.Game_Code,dbo.BIS2_VW_Slot_Config.Manufacturer_Short_Name,dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big,dbo.BIS2_VW_PlayerSession.Property_Id,dbo.BIS2_VW_Slot_Config.Game_Description,REPLACE(BIS2_VW_Slot_Config.Game_Description,'''','_')/* End: BIS2_SQLTC_RatedData*/) AS BIS2_SQLTC_RatedData/* End: BIS2_SQLTC_Rated_Main*/) AS BIS2_SQLTC_Rated_Main GROUP BY BIS2_SQLTC_Rated_Main.CabinetType,BIS2_SQLTC_Rated_Main.Denom,BIS2_SQLTC_Rated_Main.GameType,BIS2_SQLTC_Rated_Main.Manufacturer,BIS2_SQLTC_Rated_Main.PlayerID,BIS2_SQLTC_Rated_Main.SiteID,BIS2_SQLTC_Rated_Main.Theme,BIS2_SQLTC_Rated_Main.ThemeMod
	DocAggs: ['PlayerCount', 'PreferencePercentActualWin', 'PreferencePercentCoinIn', 'PreferencePercentHoursPlayed', 'PreferencePercentTheoWin', 'TotalActualWinPlayer', 'TotalActualWinPlayerTheme', 'TotalCoinInPlayer', 'TotalCoinInPlayerTheme', 'TotalHoursPlayedPlayer', 'TotalHoursPlayedPlayerTheme', 'TotalTheoWinPlayer']
	DocAggDict: {'TotalActualWinPlayer': 'SUM(BIS2_SQLTC_Rated_Main.TotalActualWinPlayer) AS TotalActualWinPlayer', 'TotalTheoWinPlayer': 'SUM(BIS2_SQLTC_Rated_Main.TotalTheoWinPlayer) AS TotalTheoWinPlayer', 'PreferencePercentActualWin': 'SUM(BIS2_SQLTC_Rated_Main.PreferencePercentActualWin) AS PreferencePercentActualWin', 'PreferencePercentTheoWin': 'SUM(BIS2_SQLTC_Rated_Main.PreferencePercentTheoWin) AS PreferencePercentTheoWin', 'TotalHoursPlayedPlayerTheme': 'SUM(BIS2_SQLTC_Rated_Main.TotalHoursPlayedPlayerTheme) AS TotalHoursPlayedPlayerTheme', 'PlayerCount': 'COUNT(DISTINCT BIS2_SQLTC_Rated_Main.PlayerID) AS PlayerCount', 'TotalCoinInPlayerTheme': 'SUM(BIS2_SQLTC_Rated_Main.TotalCoinInPlayerTheme) AS TotalCoinInPlayerTheme', 'TotalActualWinPlayerTheme': 'SUM(BIS2_SQLTC_Rated_Main.TotalActualWinPlayerTheme) AS TotalActualWinPlayerTheme', 'PreferencePercentHoursPlayed': 'SUM(BIS2_SQLTC_Rated_Main.PreferencePercentHoursPlayed) AS PreferencePercentHoursPlayed', 'TotalHoursPlayedPlayer': 'SUM(BIS2_SQLTC_Rated_Main.TotalHoursPlayedPlayer) AS TotalHoursPlayedPlayer', 'PreferencePercentCoinIn': 'SUM(BIS2_SQLTC_Rated_Main.PreferencePercentCoinIn) AS PreferencePercentCoinIn', 'TotalCoinInPlayer': 'SUM(BIS2_SQLTC_Rated_Main.TotalCoinInPlayer) AS TotalCoinInPlayer'}
	DocJoins: ['(/']DocJoinDict: {'(/': "FROM (/* SqlTableCalculator: BIS2_SQLTC_Rated_Main*/SELECT BIS2_SQLTC_RatedData.CabinetType AS CabinetType,BIS2_SQLTC_RatedData.Denom AS Denom,BIS2_SQLTC_RatedData.GameType AS GameType,BIS2_SQLTC_RatedData.Manufacturer AS Manufacturer,BIS2_SQLTC_RatedData.PlayerID AS PlayerID,BIS2_SQLTC_RatedData.SiteID AS SiteID,BIS2_SQLTC_RatedData.Theme AS Theme,BIS2_SQLTC_RatedData.ThemeMod AS ThemeMod,CASE WHEN SUM(BIS2_SQLTC_RatedData.ActualWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID)<>0 THEN  SUM(BIS2_SQLTC_RatedData.ActualWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.Theme,BIS2_SQLTC_RatedData.Manufacturer,BIS2_SQLTC_RatedData.Denom,BIS2_SQLTC_RatedData.CabinetType,BIS2_SQLTC_RatedData.GameType,BIS2_SQLTC_RatedData.PlayerID)*100.0/  SUM(BIS2_SQLTC_RatedData.ActualWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID) ELSE 0 END AS PreferencePercentActualWin,CASE WHEN SUM(BIS2_SQLTC_RatedData.CoinIn) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID)<>0 THEN  SUM(BIS2_SQLTC_RatedData.CoinIn) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.Theme,BIS2_SQLTC_RatedData.Manufacturer,BIS2_SQLTC_RatedData.Denom,BIS2_SQLTC_RatedData.CabinetType,BIS2_SQLTC_RatedData.GameType,BIS2_SQLTC_RatedData.PlayerID)*100.0/  SUM(BIS2_SQLTC_RatedData.CoinIn) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID) ELSE 0 END AS PreferencePercentCoinIn,CASE WHEN SUM(BIS2_SQLTC_RatedData.HoursPlayed) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID)<>0 THEN  SUM(BIS2_SQLTC_RatedData.HoursPlayed) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.Theme,BIS2_SQLTC_RatedData.Manufacturer,BIS2_SQLTC_RatedData.Denom,BIS2_SQLTC_RatedData.CabinetType,BIS2_SQLTC_RatedData.GameType,BIS2_SQLTC_RatedData.PlayerID)*100.0/  SUM(BIS2_SQLTC_RatedData.HoursPlayed) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID) ELSE 0 END AS PreferencePercentHoursPlayed,CASE WHEN SUM(BIS2_SQLTC_RatedData.TheoWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID)<>0 THEN  SUM(BIS2_SQLTC_RatedData.TheoWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.Theme,BIS2_SQLTC_RatedData.Manufacturer,BIS2_SQLTC_RatedData.Denom,BIS2_SQLTC_RatedData.CabinetType,BIS2_SQLTC_RatedData.GameType,BIS2_SQLTC_RatedData.PlayerID)*100.0/  SUM(BIS2_SQLTC_RatedData.TheoWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID) ELSE 0 END AS PreferencePercentTheoWin,SUM(BIS2_SQLTC_RatedData.ActualWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID) AS TotalActualWinPlayer,SUM(BIS2_SQLTC_RatedData.ActualWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.Theme,BIS2_SQLTC_RatedData.Manufacturer,BIS2_SQLTC_RatedData.Denom,  BIS2_SQLTC_RatedData.CabinetType,BIS2_SQLTC_RatedData.GameType,BIS2_SQLTC_RatedData.PlayerID) AS TotalActualWinPlayerTheme,SUM(BIS2_SQLTC_RatedData.CoinIn) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID) AS TotalCoinInPlayer,SUM(BIS2_SQLTC_RatedData.CoinIn) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.Theme,BIS2_SQLTC_RatedData.Manufacturer,BIS2_SQLTC_RatedData.Denom,  BIS2_SQLTC_RatedData.CabinetType,BIS2_SQLTC_RatedData.GameType,BIS2_SQLTC_RatedData.PlayerID) AS TotalCoinInPlayerTheme,SUM(BIS2_SQLTC_RatedData.HoursPlayed) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID) AS TotalHoursPlayedPlayer,SUM(BIS2_SQLTC_RatedData.HoursPlayed) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.Theme,BIS2_SQLTC_RatedData.Manufacturer,BIS2_SQLTC_RatedData.Denom,  BIS2_SQLTC_RatedData.CabinetType,BIS2_SQLTC_RatedData.GameType,BIS2_SQLTC_RatedData.PlayerID) AS TotalHoursPlayedPlayerTheme,SUM(BIS2_SQLTC_RatedData.TheoWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID) AS TotalTheoWinPlayer,SUM(BIS2_SQLTC_RatedData.TheoWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.Theme,BIS2_SQLTC_RatedData.Manufacturer,BIS2_SQLTC_RatedData.Denom,  BIS2_SQLTC_RatedData.CabinetType,BIS2_SQLTC_RatedData.GameType,BIS2_SQLTC_RatedData.PlayerID) AS TotalTheoWinPlayerTheme FROM (/* SqlTableCalculator: BIS2_SQLTC_RatedData*/SELECT dbo.BIS2_VW_Slot_Config.Cabinet_Type AS CabinetType,dbo.BIS2_VW_Slot_Config.denomination_nominal AS Denom,dbo.BIS2_VW_Slot_Config.Game_Code AS GameType,dbo.BIS2_VW_Slot_Config.Manufacturer_Short_Name AS Manufacturer,dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS PlayerID,dbo.BIS2_VW_PlayerSession.Property_Id AS SiteID,dbo.BIS2_VW_Slot_Config.Game_Description AS Theme,REPLACE(BIS2_VW_Slot_Config.Game_Description,'''','_') AS ThemeMod,SUM(dbo.BIS2_VW_PlayerSession.ActualWin) AS ActualWin,CASE WHEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) ELSE 0 END AS ADT,CASE WHEN CAST(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / CAST(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) ELSE 0 END AS AMT,CASE WHEN COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) <> 0 THEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal)/ COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) ELSE 0 END AS AMV,SUM(dbo.BIS2_VW_PlayerSession.coin_in_dollars_cents) AS CoinIn,SUM(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) AS HoursPlayed,SUM(ISNULL(dbo.BIS2_VW_PlayerSession.theo_loss_dol,0)) AS TheoWin,cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) AS Visits FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_PlayerSession.asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_PlayerSession.Time_Stopped >= dbo.BIS2_VW_Slot_Config.AV_Start_Date AND dbo.BIS2_VW_PlayerSession.Time_Stopped < dbo.BIS2_VW_Slot_Config.AV_End_Date AND dbo.BIS2_VW_PlayerSession.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20151001 00:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20160101 00:00:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20150930') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20160102') AND (dbo.SelectionList.GROUPID = '34cc2d1a1-1525d09b411')) GROUP BY dbo.BIS2_VW_Slot_Config.Cabinet_Type,dbo.BIS2_VW_Slot_Config.denomination_nominal,dbo.BIS2_VW_Slot_Config.Game_Code,dbo.BIS2_VW_Slot_Config.Manufacturer_Short_Name,dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big,dbo.BIS2_VW_PlayerSession.Property_Id,dbo.BIS2_VW_Slot_Config.Game_Description,REPLACE(BIS2_VW_Slot_Config.Game_Description,'''','_')/* End: BIS2_SQLTC_RatedData*/) AS BIS2_SQLTC_RatedData/* End: BIS2_SQLTC_Rated_Main*/) AS BIS2_SQLTC_Rated_Main "}
	DocWhere: []
	DocWhereAnd: {}
2016-10-04 10:33:07.348761: Final data about 34cc52c7e-1525d161787:
	UserAggList: ['TotalCoinInPlayer', 'TotalCoinInPlayerTheme', 'TotalHoursPlayedPlayer', 'TotalHoursPlayedPlayerTheme', 'TotalTheoWinPlayer']
	UserRestrictList: []
	FinalQuery: SELECT 'Step 1' AS Step, SUM(BIS2_SQLTC_Rated_Main.TotalCoinInPlayer) AS TotalCoinInPlayer, SUM(BIS2_SQLTC_Rated_Main.TotalCoinInPlayerTheme) AS TotalCoinInPlayerTheme, SUM(BIS2_SQLTC_Rated_Main.TotalHoursPlayedPlayer) AS TotalHoursPlayedPlayer, SUM(BIS2_SQLTC_Rated_Main.TotalHoursPlayedPlayerTheme) AS TotalHoursPlayedPlayerTheme, SUM(BIS2_SQLTC_Rated_Main.TotalTheoWinPlayer) AS TotalTheoWinPlayer, '' AS StepInfo FROM (/* SqlTableCalculator: BIS2_SQLTC_Rated_Main*/SELECT BIS2_SQLTC_RatedData.CabinetType AS CabinetType,BIS2_SQLTC_RatedData.Denom AS Denom,BIS2_SQLTC_RatedData.GameType AS GameType,BIS2_SQLTC_RatedData.Manufacturer AS Manufacturer,BIS2_SQLTC_RatedData.PlayerID AS PlayerID,BIS2_SQLTC_RatedData.SiteID AS SiteID,BIS2_SQLTC_RatedData.Theme AS Theme,BIS2_SQLTC_RatedData.ThemeMod AS ThemeMod,CASE WHEN SUM(BIS2_SQLTC_RatedData.ActualWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID)<>0 THEN  SUM(BIS2_SQLTC_RatedData.ActualWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.Theme,BIS2_SQLTC_RatedData.Manufacturer,BIS2_SQLTC_RatedData.Denom,BIS2_SQLTC_RatedData.CabinetType,BIS2_SQLTC_RatedData.GameType,BIS2_SQLTC_RatedData.PlayerID)*100.0/  SUM(BIS2_SQLTC_RatedData.ActualWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID) ELSE 0 END AS PreferencePercentActualWin,CASE WHEN SUM(BIS2_SQLTC_RatedData.CoinIn) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID)<>0 THEN  SUM(BIS2_SQLTC_RatedData.CoinIn) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.Theme,BIS2_SQLTC_RatedData.Manufacturer,BIS2_SQLTC_RatedData.Denom,BIS2_SQLTC_RatedData.CabinetType,BIS2_SQLTC_RatedData.GameType,BIS2_SQLTC_RatedData.PlayerID)*100.0/  SUM(BIS2_SQLTC_RatedData.CoinIn) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID) ELSE 0 END AS PreferencePercentCoinIn,CASE WHEN SUM(BIS2_SQLTC_RatedData.HoursPlayed) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID)<>0 THEN  SUM(BIS2_SQLTC_RatedData.HoursPlayed) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.Theme,BIS2_SQLTC_RatedData.Manufacturer,BIS2_SQLTC_RatedData.Denom,BIS2_SQLTC_RatedData.CabinetType,BIS2_SQLTC_RatedData.GameType,BIS2_SQLTC_RatedData.PlayerID)*100.0/  SUM(BIS2_SQLTC_RatedData.HoursPlayed) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID) ELSE 0 END AS PreferencePercentHoursPlayed,CASE WHEN SUM(BIS2_SQLTC_RatedData.TheoWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID)<>0 THEN  SUM(BIS2_SQLTC_RatedData.TheoWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.Theme,BIS2_SQLTC_RatedData.Manufacturer,BIS2_SQLTC_RatedData.Denom,BIS2_SQLTC_RatedData.CabinetType,BIS2_SQLTC_RatedData.GameType,BIS2_SQLTC_RatedData.PlayerID)*100.0/  SUM(BIS2_SQLTC_RatedData.TheoWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID) ELSE 0 END AS PreferencePercentTheoWin,SUM(BIS2_SQLTC_RatedData.ActualWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID) AS TotalActualWinPlayer,SUM(BIS2_SQLTC_RatedData.ActualWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.Theme,BIS2_SQLTC_RatedData.Manufacturer,BIS2_SQLTC_RatedData.Denom,  BIS2_SQLTC_RatedData.CabinetType,BIS2_SQLTC_RatedData.GameType,BIS2_SQLTC_RatedData.PlayerID) AS TotalActualWinPlayerTheme,SUM(BIS2_SQLTC_RatedData.CoinIn) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID) AS TotalCoinInPlayer,SUM(BIS2_SQLTC_RatedData.CoinIn) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.Theme,BIS2_SQLTC_RatedData.Manufacturer,BIS2_SQLTC_RatedData.Denom,  BIS2_SQLTC_RatedData.CabinetType,BIS2_SQLTC_RatedData.GameType,BIS2_SQLTC_RatedData.PlayerID) AS TotalCoinInPlayerTheme,SUM(BIS2_SQLTC_RatedData.HoursPlayed) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID) AS TotalHoursPlayedPlayer,SUM(BIS2_SQLTC_RatedData.HoursPlayed) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.Theme,BIS2_SQLTC_RatedData.Manufacturer,BIS2_SQLTC_RatedData.Denom,  BIS2_SQLTC_RatedData.CabinetType,BIS2_SQLTC_RatedData.GameType,BIS2_SQLTC_RatedData.PlayerID) AS TotalHoursPlayedPlayerTheme,SUM(BIS2_SQLTC_RatedData.TheoWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.PlayerID) AS TotalTheoWinPlayer,SUM(BIS2_SQLTC_RatedData.TheoWin) OVER (PARTITION BY BIS2_SQLTC_RatedData.SiteID,BIS2_SQLTC_RatedData.Theme,BIS2_SQLTC_RatedData.Manufacturer,BIS2_SQLTC_RatedData.Denom,  BIS2_SQLTC_RatedData.CabinetType,BIS2_SQLTC_RatedData.GameType,BIS2_SQLTC_RatedData.PlayerID) AS TotalTheoWinPlayerTheme FROM (/* SqlTableCalculator: BIS2_SQLTC_RatedData*/SELECT dbo.BIS2_VW_Slot_Config.Cabinet_Type AS CabinetType,dbo.BIS2_VW_Slot_Config.denomination_nominal AS Denom,dbo.BIS2_VW_Slot_Config.Game_Code AS GameType,dbo.BIS2_VW_Slot_Config.Manufacturer_Short_Name AS Manufacturer,dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS PlayerID,dbo.BIS2_VW_PlayerSession.Property_Id AS SiteID,dbo.BIS2_VW_Slot_Config.Game_Description AS Theme,REPLACE(BIS2_VW_Slot_Config.Game_Description,'''','_') AS ThemeMod,SUM(dbo.BIS2_VW_PlayerSession.ActualWin) AS ActualWin,CASE WHEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) ELSE 0 END AS ADT,CASE WHEN CAST(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) <> 0 THEN SUM(BIS2_VW_PlayerSession.theo_loss_dol) / CAST(COUNT(DISTINCT cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big as varchar)+CAST(DATEPART(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR) + CAST(DATEPART(yy, BIS2_VW_PlayerSession.transaction_date_hun_year) AS VARCHAR)) AS DECIMAL) ELSE 0 END AS AMT,CASE WHEN COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) <> 0 THEN cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal)/ COUNT(distinct cast(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + datepart(mm, BIS2_VW_PlayerSession.transaction_date_hun_year) + datepart(yy, BIS2_VW_PlayerSession.transaction_date_hun_year)) ELSE 0 END AS AMV,SUM(dbo.BIS2_VW_PlayerSession.coin_in_dollars_cents) AS CoinIn,SUM(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) AS HoursPlayed,SUM(ISNULL(dbo.BIS2_VW_PlayerSession.theo_loss_dol,0)) AS TheoWin,cast(COUNT(DISTINCT CAST(BIS2_VW_PlayerSession.Patron_Account_Number_9_Big AS varchar) + CAST(BIS2_VW_PlayerSession.transaction_date_hun_year AS varchar)) as decimal) AS Visits FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Patron ON dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big = dbo.BIS2_VW_Patron.Account_Number INNER JOIN dbo.SelectionList ON dbo.BIS2_VW_Patron.Account_Number = dbo.SelectionList.PlayerID INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_PlayerSession.asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_PlayerSession.Time_Stopped >= dbo.BIS2_VW_Slot_Config.AV_Start_Date AND dbo.BIS2_VW_PlayerSession.Time_Stopped < dbo.BIS2_VW_Slot_Config.AV_End_Date AND dbo.BIS2_VW_PlayerSession.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20151001 00:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20160101 00:00:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20150930') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20160102') AND (dbo.SelectionList.GROUPID = '34cc2d1a1-1525d09b411')) GROUP BY dbo.BIS2_VW_Slot_Config.Cabinet_Type,dbo.BIS2_VW_Slot_Config.denomination_nominal,dbo.BIS2_VW_Slot_Config.Game_Code,dbo.BIS2_VW_Slot_Config.Manufacturer_Short_Name,dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big,dbo.BIS2_VW_PlayerSession.Property_Id,dbo.BIS2_VW_Slot_Config.Game_Description,REPLACE(BIS2_VW_Slot_Config.Game_Description,'''','_')/* End: BIS2_SQLTC_RatedData*/) AS BIS2_SQLTC_RatedData/* End: BIS2_SQLTC_Rated_Main*/) AS BIS2_SQLTC_Rated_Main 
2016-10-04 10:33:07.574390: Checking 34e3bed48-1539eb8644e (Rated Daily Theo Win per Slot, AV_I01):
	Query: SELECT VBB2__Aggregates.Asset AS Asset,VBB2__Aggregates.Bank AS Bank,VBB2__Aggregates.CabinetType AS CabinetType,VBB2__Aggregates.Denom AS Denom,VBB2__Aggregates.GameCode AS GameCode,VBB2__Aggregates.Location AS Location,VBB2__Aggregates.Manufacturer AS Manufacturer,VBB2__Aggregates.Model AS Model,VBB2__Aggregates.Paylines AS Paylines,VBB2__Aggregates.Reels AS Reels,VBB2__Aggregates.Section AS Section,VBB2__Aggregates.SerialNumber AS SerialNumber,VBB2__Aggregates.Theme AS Theme,VBB2__Spatials.Latitude AS Latitude,VBB2__Spatials.Longitude AS Longitude,VBB2__Aggregates.Chairs_StandID AS Chairs_StandID,VBB2__Aggregates.Chairs_StandID_SCD_Start AS Chairs_StandID_SCD_Start,VBB2__Aggregates.Chairs_StandID_SCD_End AS Chairs_StandID_SCD_End,VBB2__Aggregates.Chairs_StandID_SCD_History AS Chairs_StandID_SCD_History,VBB2__Aggregates.Chairs_StandID_SCD_Changed AS Chairs_StandID_SCD_Changed,VBB2__Aggregates.Slot_StandID AS Slot_StandID,VBB2__Aggregates.Slot_StandID_SCD_Start AS Slot_StandID_SCD_Start,VBB2__Aggregates.Slot_StandID_SCD_End AS Slot_StandID_SCD_End,VBB2__Aggregates.Slot_StandID_SCD_History AS Slot_StandID_SCD_History,VBB2__Aggregates.Slot_StandID_SCD_Changed AS Slot_StandID_SCD_Changed,VBB2__Aggregates.ActualHoldPct AS ActualHoldPct,VBB2__Aggregates.ActualWin AS ActualWin,VBB2__Aggregates.ActualWinperDay AS ActualWinperDay,VBB2__Aggregates.AvgBet AS AvgBet,VBB2__Aggregates.CoinIn AS CoinIn,VBB2__Aggregates.CoinInperDay AS CoinInperDay,VBB2__Aggregates.DaysonFloor AS DaysonFloor,VBB2__Aggregates.GamesPlayed AS GamesPlayed,VBB2__Aggregates.GamesPlayedperDay AS GamesPlayedperDay,VBB2__Aggregates.GamesPlayedperMinute AS GamesPlayedperMinute,VBB2__Aggregates.HoldVariance AS HoldVariance,VBB2__Aggregates.HoursPlayed AS HoursPlayed,VBB2__Aggregates.HoursPlayedperDay AS HoursPlayedperDay,VBB2__Aggregates.Jackpot AS Jackpot,VBB2__Aggregates.Occupancy AS Occupancy,VBB2__Aggregates.PlayerCount AS PlayerCount,VBB2__Aggregates.TheoHoldPct AS TheoHoldPct,VBB2__Aggregates.TheoWin AS TheoWin,VBB2__Aggregates.TheoWinperDay AS TheoWinperDay,VBB2__Aggregates.TheoWinperHour AS TheoWinperHour FROM (SELECT dbo.BIS2_VW_Slot_Config.Asset AS Asset,dbo.BIS2_VW_Slot_Config.Bank AS Bank,dbo.BIS2_VW_Slot_Config.Cabinet_Type AS CabinetType,dbo.BIS2_GEO_chairs.ogc_fid AS VBB2__kf_Chairs_ogc,dbo.BIS2_VW_Slot_Config.denomination_nominal AS Denom,dbo.BIS2_VW_Slot_Config.Game_Code AS GameCode,dbo.BIS2_VW_Slot_Config.Location AS Location,dbo.BIS2_VW_Slot_Config.Manufacturer_Short_Name AS Manufacturer,dbo.BIS2_VW_Slot_Config.Model_Number AS Model,dbo.BIS2_VW_Slot_Config.Number_Of_Play_Lines AS Paylines,dbo.BIS2_VW_Slot_Config.Number_Of_Reels AS Reels,dbo.BIS2_VW_Slot_Config.Section AS Section,dbo.BIS2_VW_Slot_Config.Serial_Number AS SerialNumber,dbo.BIS2_VW_Slot_Config.Game_Description AS Theme,dbo.BIS2_GEO_chairs.standid AS Chairs_StandID,dbo.BIS2_GEO_chairs.startgd AS Chairs_StandID_SCD_Start,dbo.BIS2_GEO_chairs.endgd AS Chairs_StandID_SCD_End,dbo.BIS2_GEO_chairs.version AS Chairs_StandID_SCD_Version,CASE WHEN(datepart(year,dbo.BIS2_GEO_chairs.startgd)*10000+datepart(mm,dbo.BIS2_GEO_chairs.startgd)*100+datepart(dd,dbo.BIS2_GEO_chairs.startgd))-(datepart(year,'20160320')*10000+datepart(mm,'20160320')*100+datepart(dd,'20160320'))<0 AND (datepart(year,'20160320')*10000+datepart(mm,'20160320')*100+datepart(dd,'20160320'))-(datepart(year,dbo.BIS2_GEO_chairs.endgd)*10000+datepart(mm,dbo.BIS2_GEO_chairs.endgd)*100+datepart(dd,dbo.BIS2_GEO_chairs.endgd))<=0 THEN 0 ELSE 1 END AS Chairs_StandID_SCD_History,CASE WHEN((dbo.BIS2_GEO_chairs.startgd < '20160320' AND dbo.BIS2_GEO_chairs.startgd >= '20160101') OR (dbo.BIS2_GEO_chairs.endgd < '20160320' AND dbo.BIS2_GEO_chairs.endgd >= '20160101'))THEN 1 ELSE 0 END AS Chairs_StandID_SCD_Changed,dbo.BIS2_VW_Slot_Config.stand_id AS Slot_StandID,dbo.BIS2_VW_Slot_Config.AV_Start_Date AS Slot_StandID_SCD_Start,dbo.BIS2_VW_Slot_Config.AV_End_Date AS Slot_StandID_SCD_End,CASE WHEN(datepart(year,dbo.BIS2_VW_Slot_Config.AV_Start_Date)*10000+datepart(mm,dbo.BIS2_VW_Slot_Config.AV_Start_Date)*100+datepart(dd,dbo.BIS2_VW_Slot_Config.AV_Start_Date))-(datepart(year,'20160320')*10000+datepart(mm,'20160320')*100+datepart(dd,'20160320'))<0 AND (datepart(year,'20160320')*10000+datepart(mm,'20160320')*100+datepart(dd,'20160320'))-(datepart(year,dbo.BIS2_VW_Slot_Config.AV_End_Date)*10000+datepart(mm,dbo.BIS2_VW_Slot_Config.AV_End_Date)*100+datepart(dd,dbo.BIS2_VW_Slot_Config.AV_End_Date))<=0 THEN 0 ELSE 1 END AS Slot_StandID_SCD_History,CASE WHEN((dbo.BIS2_VW_Slot_Config.AV_Start_Date < '20160320' AND dbo.BIS2_VW_Slot_Config.AV_Start_Date >= '20160101') OR (dbo.BIS2_VW_Slot_Config.AV_End_Date < '20160320' AND dbo.BIS2_VW_Slot_Config.AV_End_Date >= '20160101'))THEN 1 ELSE 0 END AS Slot_StandID_SCD_Changed,CASE         WHEN Sum(dbo.BIS2_VW_PlayerSession.Coin_In_Dollars_Cents) <> 0 THEN ( sum(BIS2_VW_PlayerSession.ActualWin) * 100.0 ) / Sum(dbo.BIS2_VW_PlayerSession.Coin_In_Dollars_Cents)         ELSE 0       END AS ActualHoldPct,SUM(dbo.BIS2_VW_PlayerSession.ActualWin) AS ActualWin,SUM(dbo.BIS2_VW_PlayerSession.ActualWin)/COUNT(distinct cast(BIS2_VW_Slot_Config.stand_id as  varchar)+cast(BIS2_VW_PlayerSession.transaction_date_hun_year as varchar)) AS ActualWinperDay,CASE WHEN SUM(BIS2_VW_PlayerSession.Handle_Pulls_Meter) <> 0 THEN SUM(BIS2_VW_PlayerSession.Coin_In_Dollars_Cents) / SUM(BIS2_VW_PlayerSession.Handle_Pulls_Meter) ELSE 0.0 END AS AvgBet,SUM(dbo.BIS2_VW_PlayerSession.coin_in_dollars_cents) AS CoinIn,SUM(BIS2_VW_PlayerSession.coin_in_dollars_cents)/COUNT(distinct cast(BIS2_VW_Slot_Config.stand_id as varchar)+cast(BIS2_VW_PlayerSession.transaction_date_hun_year as varchar)) AS CoinInperDay,COUNT(distinct cast(BIS2_VW_Slot_Config.stand_id as varchar)+cast(BIS2_VW_PlayerSession.transaction_date_hun_year as varchar)) AS DaysonFloor,SUM(dbo.BIS2_VW_PlayerSession.Handle_Pulls_Meter) AS GamesPlayed,SUM(dbo.BIS2_VW_PlayerSession.Handle_Pulls_Meter)/COUNT(cast(BIS2_VW_Slot_Config.stand_id as  varchar)+cast(BIS2_VW_PlayerSession.transaction_date_hun_year as varchar)) AS GamesPlayedperDay,MAX(BIS2_SQLTC_UtilCalculation.GamesPlayedperMinute) AS GamesPlayedperMinute,CASE    WHEN SUM(BIS2_VW_PlayerSession.Coin_In_Dollars_Cents) <> 0   THEN 100.0*(SUM(BIS2_VW_PlayerSession.ActualWin) - SUM(BIS2_VW_PlayerSession.theo_loss_dol))/SUM(BIS2_VW_PlayerSession.Coin_In_Dollars_Cents)   ELSE 0 END AS HoldVariance,SUM(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) AS HoursPlayed,SUM(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0)/COUNT(distinct cast(BIS2_VW_Slot_Config.stand_id as  varchar)+cast(BIS2_VW_PlayerSession.transaction_date_hun_year as varchar)) AS HoursPlayedperDay,SUM(dbo.BIS2_VW_PlayerSession.irs_jackpot_dol) AS Jackpot,MAX(BIS2_SQLTC_UtilCalculation.Occupancy) AS Occupancy,count(distinct dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big) AS PlayerCount,CASE          WHEN Sum(dbo.BIS2_VW_PlayerSession.Coin_In_Dollars_Cents) <> 0 THEN ( Sum(dbo.BIS2_VW_PlayerSession.theo_loss_dol) * 100.0 ) / Sum(dbo.BIS2_VW_PlayerSession.Coin_In_Dollars_Cents)          ELSE 0        END AS TheoHoldPct,SUM(ISNULL(dbo.BIS2_VW_PlayerSession.theo_loss_dol,0)) AS TheoWin,SUM(BIS2_VW_PlayerSession.Theo_Loss_dol)/COUNT(distinct cast(BIS2_VW_Slot_Config.stand_id as varchar)+cast(BIS2_VW_PlayerSession.transaction_date_hun_year as varchar)) AS TheoWinperDay,MAX(BIS2_SQLTC_UtilCalculation.TheoWinperHour) AS TheoWinperHour FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_PlayerSession.asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_PlayerSession.Time_Stopped >= dbo.BIS2_VW_Slot_Config.AV_Start_Date AND dbo.BIS2_VW_PlayerSession.Time_Stopped < dbo.BIS2_VW_Slot_Config.AV_End_Date AND dbo.BIS2_VW_PlayerSession.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) INNER JOIN dbo.BIS2_GEO_chairs ON dbo.BIS2_VW_Slot_Config.stand_id = dbo.BIS2_GEO_chairs.standid LEFT HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_UtilCalculation*/SELECT BIS2_SQLTC_RatedMetrics.Asset AS Asset,BIS2_SQLTC_RatedMetrics.Slot_Start AS Slot_Start,BIS2_SQLTC_RatedMetrics.StandID AS StandID,BIS2_SQLTC_RatedMetrics.GamesPlayedperMinute AS GamesPlayedperMinute,case when BIS2_SQLTC_RatedMetrics.GamesPlayedperHour<>0 then 100.0*BIS2_SQLTC_UnRatedMetrics.GamesPlayedperDay / BIS2_SQLTC_RatedMetrics.GamesPlayedperHour / 24.0 ELSE 0 END AS Occupancy,BIS2_SQLTC_RatedMetrics.PlayerCount AS PlayerCount,BIS2_SQLTC_RatedMetrics.TheoWinperHour AS TheoWinperHour FROM (/* SqlTableCalculator: BIS2_SQLTC_RatedMetrics*/SELECT dbo.BIS2_VW_Slot_Config.Asset AS Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AS Slot_Start,dbo.BIS2_VW_Slot_Config.stand_id AS StandID,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0)<>0 then SUM(BIS2_VW_PlayerSession.handle_pulls_meter)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) else 0 end AS GamesPlayedperHour,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/60.0)<>0 then SUM(BIS2_VW_PlayerSession.handle_pulls_meter)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/60.0) else 0 end AS GamesPlayedperMinute,count(distinct dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big) AS PlayerCount,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0)<>0 then SUM(BIS2_VW_PlayerSession.theo_loss_dol)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) else 0 end AS TheoWinperHour FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_PlayerSession.asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_PlayerSession.Time_Stopped >= dbo.BIS2_VW_Slot_Config.AV_Start_Date AND dbo.BIS2_VW_PlayerSession.Time_Stopped < dbo.BIS2_VW_Slot_Config.AV_End_Date AND dbo.BIS2_VW_PlayerSession.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20160101 00:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20160320 00:00:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20151231') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20160321') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date,dbo.BIS2_VW_Slot_Config.stand_id/* End: BIS2_SQLTC_RatedMetrics*/) AS BIS2_SQLTC_RatedMetrics INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_UnRatedMetrics*/SELECT dbo.BIS2_VW_Slot_Config.Asset AS Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AS Slot_Start,dbo.BIS2_VW_Slot_Config.stand_id AS StandID,CASE WHEN SUM(dbo.BIS2_VW_Slot_Daily.Machine_Days)<>0 THEN SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls)/SUM(dbo.BIS2_VW_Slot_Daily.Machine_Days) ELSE 0 END AS GamesPlayedperDay FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160320') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date,dbo.BIS2_VW_Slot_Config.stand_id/* End: BIS2_SQLTC_UnRatedMetrics*/) AS BIS2_SQLTC_UnRatedMetrics ON (BIS2_SQLTC_RatedMetrics.StandID = BIS2_SQLTC_UnRatedMetrics.StandID AND BIS2_SQLTC_RatedMetrics.Asset = BIS2_SQLTC_UnRatedMetrics.Asset AND BIS2_SQLTC_RatedMetrics.Slot_Start = BIS2_SQLTC_UnRatedMetrics.Slot_Start)/* End: BIS2_SQLTC_UtilCalculation*/) AS BIS2_SQLTC_UtilCalculation ON (dbo.BIS2_VW_Slot_Config.Asset = BIS2_SQLTC_UtilCalculation.Asset AND dbo.BIS2_VW_Slot_Config.stand_id = BIS2_SQLTC_UtilCalculation.StandID AND dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date = BIS2_SQLTC_UtilCalculation.Slot_Start) WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20160101 00:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20160320 00:00:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20151231') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20160321') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%') AND (dbo.BIS2_VW_PlayerSession.Time_Started >= dbo.BIS2_GEO_chairs.startgd) AND (dbo.BIS2_VW_PlayerSession.Time_Started < dbo.BIS2_GEO_chairs.endgd) AND (dbo.BIS2_VW_PlayerSession.Time_Started >= dbo.BIS2_VW_Slot_Config.AV_Start_Date) AND (dbo.BIS2_VW_PlayerSession.Time_Started < dbo.BIS2_VW_Slot_Config.AV_End_Date)) GROUP BY dbo.BIS2_VW_Slot_Config.Asset,dbo.BIS2_VW_Slot_Config.Bank,dbo.BIS2_VW_Slot_Config.Cabinet_Type,dbo.BIS2_GEO_chairs.ogc_fid,dbo.BIS2_VW_Slot_Config.denomination_nominal,dbo.BIS2_VW_Slot_Config.Game_Code,dbo.BIS2_VW_Slot_Config.Location,dbo.BIS2_VW_Slot_Config.Manufacturer_Short_Name,dbo.BIS2_VW_Slot_Config.Model_Number,dbo.BIS2_VW_Slot_Config.Number_Of_Play_Lines,dbo.BIS2_VW_Slot_Config.Number_Of_Reels,dbo.BIS2_VW_Slot_Config.Section,dbo.BIS2_VW_Slot_Config.Serial_Number,dbo.BIS2_VW_Slot_Config.Game_Description,dbo.BIS2_GEO_chairs.standid,dbo.BIS2_GEO_chairs.startgd,dbo.BIS2_GEO_chairs.endgd,dbo.BIS2_GEO_chairs.version,CASE WHEN(datepart(year,dbo.BIS2_GEO_chairs.startgd)*10000+datepart(mm,dbo.BIS2_GEO_chairs.startgd)*100+datepart(dd,dbo.BIS2_GEO_chairs.startgd))-(datepart(year,'20160320')*10000+datepart(mm,'20160320')*100+datepart(dd,'20160320'))<0 AND (datepart(year,'20160320')*10000+datepart(mm,'20160320')*100+datepart(dd,'20160320'))-(datepart(year,dbo.BIS2_GEO_chairs.endgd)*10000+datepart(mm,dbo.BIS2_GEO_chairs.endgd)*100+datepart(dd,dbo.BIS2_GEO_chairs.endgd))<=0 THEN 0 ELSE 1 END,CASE WHEN((dbo.BIS2_GEO_chairs.startgd < '20160320' AND dbo.BIS2_GEO_chairs.startgd >= '20160101') OR (dbo.BIS2_GEO_chairs.endgd < '20160320' AND dbo.BIS2_GEO_chairs.endgd >= '20160101'))THEN 1 ELSE 0 END,dbo.BIS2_VW_Slot_Config.stand_id,dbo.BIS2_VW_Slot_Config.AV_Start_Date,dbo.BIS2_VW_Slot_Config.AV_End_Date,CASE WHEN(datepart(year,dbo.BIS2_VW_Slot_Config.AV_Start_Date)*10000+datepart(mm,dbo.BIS2_VW_Slot_Config.AV_Start_Date)*100+datepart(dd,dbo.BIS2_VW_Slot_Config.AV_Start_Date))-(datepart(year,'20160320')*10000+datepart(mm,'20160320')*100+datepart(dd,'20160320'))<0 AND (datepart(year,'20160320')*10000+datepart(mm,'20160320')*100+datepart(dd,'20160320'))-(datepart(year,dbo.BIS2_VW_Slot_Config.AV_End_Date)*10000+datepart(mm,dbo.BIS2_VW_Slot_Config.AV_End_Date)*100+datepart(dd,dbo.BIS2_VW_Slot_Config.AV_End_Date))<=0 THEN 0 ELSE 1 END,CASE WHEN((dbo.BIS2_VW_Slot_Config.AV_Start_Date < '20160320' AND dbo.BIS2_VW_Slot_Config.AV_Start_Date >= '20160101') OR (dbo.BIS2_VW_Slot_Config.AV_End_Date < '20160320' AND dbo.BIS2_VW_Slot_Config.AV_End_Date >= '20160101'))THEN 1 ELSE 0 END) AS VBB2__Aggregates INNER JOIN (SELECT dbo.BIS2_GEO_chairs.ogc_fid AS VBB2__kf_Chairs_ogc,dbo.BIS2_GEO_chairs.wkt_geo AS Latitude,dbo.BIS2_GEO_chairs.wkt_geo AS Longitude FROM dbo.BIS2_GEO_chairs) AS VBB2__Spatials ON VBB2__Aggregates.VBB2__kf_Chairs_ogc = VBB2__Spatials.VBB2__kf_Chairs_ogc ORDER BY Chairs_StandID,Chairs_StandID_SCD_History,Chairs_StandID_SCD_Start DESC,Slot_StandID,Slot_StandID_SCD_History,Slot_StandID_SCD_Start DESC
	DocAggs: ['ActualWin', 'ActualWinperDay', 'AvgBet', 'CoinIn', 'CoinInperDay', 'DaysonFloor', 'GamesPlayed', 'GamesPlayedperDay', 'HoldVariance', 'HoursPlayed', 'HoursPlayedperDay', 'Jackpot', 'TheoWin', 'TheoWinperDay']
	DocAggDict: {'GamesPlayedperDay': 'SUM(dbo.BIS2_VW_PlayerSession.Handle_Pulls_Meter)/COUNT(cast(BIS2_VW_Slot_Config.stand_id as  varchar)+cast(BIS2_VW_PlayerSession.transaction_date_hun_year as varchar)) AS GamesPlayedperDay', 'ActualWin': 'SUM(dbo.BIS2_VW_PlayerSession.ActualWin) AS ActualWin', 'TheoWinperDay': 'SUM(BIS2_VW_PlayerSession.Theo_Loss_dol)/COUNT(distinct cast(BIS2_VW_Slot_Config.stand_id as varchar)+cast(BIS2_VW_PlayerSession.transaction_date_hun_year as varchar)) AS TheoWinperDay', 'ActualWinperDay': 'SUM(dbo.BIS2_VW_PlayerSession.ActualWin)/COUNT(distinct cast(BIS2_VW_Slot_Config.stand_id as  varchar)+cast(BIS2_VW_PlayerSession.transaction_date_hun_year as varchar)) AS ActualWinperDay', 'AvgBet': 'SUM(BIS2_VW_PlayerSession.Handle_Pulls_Meter) <> 0 THEN SUM(BIS2_VW_PlayerSession.Coin_In_Dollars_Cents) / SUM(BIS2_VW_PlayerSession.Handle_Pulls_Meter) ELSE 0.0 END AS AvgBet', 'TheoWin': 'SUM(ISNULL(dbo.BIS2_VW_PlayerSession.theo_loss_dol,0)) AS TheoWin', 'CoinIn': 'SUM(dbo.BIS2_VW_PlayerSession.coin_in_dollars_cents) AS CoinIn', 'Jackpot': 'SUM(dbo.BIS2_VW_PlayerSession.irs_jackpot_dol) AS Jackpot', 'HoldVariance': 'SUM(BIS2_VW_PlayerSession.Coin_In_Dollars_Cents) <> 0   THEN 100.0*(SUM(BIS2_VW_PlayerSession.ActualWin) - SUM(BIS2_VW_PlayerSession.theo_loss_dol))/SUM(BIS2_VW_PlayerSession.Coin_In_Dollars_Cents)   ELSE 0 END AS HoldVariance', 'GamesPlayed': 'SUM(dbo.BIS2_VW_PlayerSession.Handle_Pulls_Meter) AS GamesPlayed', 'HoursPlayedperDay': 'SUM(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0)/COUNT(distinct cast(BIS2_VW_Slot_Config.stand_id as  varchar)+cast(BIS2_VW_PlayerSession.transaction_date_hun_year as varchar)) AS HoursPlayedperDay', 'CoinInperDay': 'SUM(BIS2_VW_PlayerSession.coin_in_dollars_cents)/COUNT(distinct cast(BIS2_VW_Slot_Config.stand_id as varchar)+cast(BIS2_VW_PlayerSession.transaction_date_hun_year as varchar)) AS CoinInperDay', 'HoursPlayed': 'SUM(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) AS HoursPlayed', 'DaysonFloor': 'COUNT(distinct cast(BIS2_VW_Slot_Config.stand_id as varchar)+cast(BIS2_VW_PlayerSession.transaction_date_hun_year as varchar)) AS DaysonFloor'}
	DocJoins: ['dbo.BIS2_VW_PlayerSession', 'dbo.BIS2_VW_Slot_Config', 'dbo.BIS2_GEO_chairs', 'BIS2_SQLTC_UtilCalculation']DocJoinDict: {'dbo.BIS2_GEO_chairs': 'INNER JOIN dbo.BIS2_GEO_chairs ON dbo.BIS2_VW_Slot_Config.stand_id = dbo.BIS2_GEO_chairs.standid ', 'BIS2_SQLTC_UtilCalculation': "LEFT HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_UtilCalculation*/SELECT BIS2_SQLTC_RatedMetrics.Asset AS Asset,BIS2_SQLTC_RatedMetrics.Slot_Start AS Slot_Start,BIS2_SQLTC_RatedMetrics.StandID AS StandID,BIS2_SQLTC_RatedMetrics.GamesPlayedperMinute AS GamesPlayedperMinute,case when BIS2_SQLTC_RatedMetrics.GamesPlayedperHour<>0 then 100.0*BIS2_SQLTC_UnRatedMetrics.GamesPlayedperDay / BIS2_SQLTC_RatedMetrics.GamesPlayedperHour / 24.0 ELSE 0 END AS Occupancy,BIS2_SQLTC_RatedMetrics.PlayerCount AS PlayerCount,BIS2_SQLTC_RatedMetrics.TheoWinperHour AS TheoWinperHour FROM (/* SqlTableCalculator: BIS2_SQLTC_RatedMetrics*/SELECT dbo.BIS2_VW_Slot_Config.Asset AS Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AS Slot_Start,dbo.BIS2_VW_Slot_Config.stand_id AS StandID,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0)<>0 then SUM(BIS2_VW_PlayerSession.handle_pulls_meter)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) else 0 end AS GamesPlayedperHour,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/60.0)<>0 then SUM(BIS2_VW_PlayerSession.handle_pulls_meter)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/60.0) else 0 end AS GamesPlayedperMinute,count(distinct dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big) AS PlayerCount,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0)<>0 then SUM(BIS2_VW_PlayerSession.theo_loss_dol)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) else 0 end AS TheoWinperHour FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_PlayerSession.asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_PlayerSession.Time_Stopped >= dbo.BIS2_VW_Slot_Config.AV_Start_Date AND dbo.BIS2_VW_PlayerSession.Time_Stopped < dbo.BIS2_VW_Slot_Config.AV_End_Date AND dbo.BIS2_VW_PlayerSession.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20160101 00:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20160320 00:00:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20151231') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20160321') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date,dbo.BIS2_VW_Slot_Config.stand_id/* End: BIS2_SQLTC_RatedMetrics*/) AS BIS2_SQLTC_RatedMetrics INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_UnRatedMetrics*/SELECT dbo.BIS2_VW_Slot_Config.Asset AS Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AS Slot_Start,dbo.BIS2_VW_Slot_Config.stand_id AS StandID,CASE WHEN SUM(dbo.BIS2_VW_Slot_Daily.Machine_Days)<>0 THEN SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls)/SUM(dbo.BIS2_VW_Slot_Daily.Machine_Days) ELSE 0 END AS GamesPlayedperDay FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160320') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date,dbo.BIS2_VW_Slot_Config.stand_id/* End: BIS2_SQLTC_UnRatedMetrics*/) AS BIS2_SQLTC_UnRatedMetrics ON (BIS2_SQLTC_RatedMetrics.StandID = BIS2_SQLTC_UnRatedMetrics.StandID AND BIS2_SQLTC_RatedMetrics.Asset = BIS2_SQLTC_UnRatedMetrics.Asset AND BIS2_SQLTC_RatedMetrics.Slot_Start = BIS2_SQLTC_UnRatedMetrics.Slot_Start)/* End: BIS2_SQLTC_UtilCalculation*/) AS BIS2_SQLTC_UtilCalculation ON (dbo.BIS2_VW_Slot_Config.Asset = BIS2_SQLTC_UtilCalculation.Asset AND dbo.BIS2_VW_Slot_Config.stand_id = BIS2_SQLTC_UtilCalculation.StandID AND dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date = BIS2_SQLTC_UtilCalculation.Slot_Start) ", 'dbo.BIS2_VW_PlayerSession': 'FROM dbo.BIS2_VW_PlayerSession ', 'dbo.BIS2_VW_Slot_Config': 'INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_PlayerSession.asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_PlayerSession.Time_Stopped >= dbo.BIS2_VW_Slot_Config.AV_Start_Date AND dbo.BIS2_VW_PlayerSession.Time_Stopped < dbo.BIS2_VW_Slot_Config.AV_End_Date AND dbo.BIS2_VW_PlayerSession.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) '}
	DocWhere: ["(dbo.BIS2_VW_PlayerSession.Time_Started >= '20160101 00:00:00') ", "(dbo.BIS2_VW_PlayerSession.Time_Started < '20160320 00:00:00') ", "(dbo.BIS2_VW_PlayerSession.GamingDate >= '20151231') ", "(dbo.BIS2_VW_PlayerSession.GamingDate < '20160321') ", "(dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%') ", '(dbo.BIS2_VW_PlayerSession.Time_Started >= dbo.BIS2_GEO_chairs.startgd) ', '(dbo.BIS2_VW_PlayerSession.Time_Started < dbo.BIS2_GEO_chairs.endgd) ', '(dbo.BIS2_VW_PlayerSession.Time_Started >= dbo.BIS2_VW_Slot_Config.AV_Start_Date) ', '(dbo.BIS2_VW_PlayerSession.Time_Started < dbo.BIS2_VW_Slot_Config.AV_End_Date)']
	DocWhereAnd: {"(dbo.BIS2_VW_PlayerSession.Time_Started >= '20160101 00:00:00') ": 'start', "(dbo.BIS2_VW_PlayerSession.Time_Started < '20160320 00:00:00') ": 'AND ', '(dbo.BIS2_VW_PlayerSession.Time_Started < dbo.BIS2_VW_Slot_Config.AV_End_Date)': 'AND ', '(dbo.BIS2_VW_PlayerSession.Time_Started >= dbo.BIS2_GEO_chairs.startgd) ': 'AND ', "(dbo.BIS2_VW_PlayerSession.GamingDate >= '20151231') ": 'AND ', "(dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%') ": 'AND ', '(dbo.BIS2_VW_PlayerSession.Time_Started < dbo.BIS2_GEO_chairs.endgd) ': 'AND ', '(dbo.BIS2_VW_PlayerSession.Time_Started >= dbo.BIS2_VW_Slot_Config.AV_Start_Date) ': 'AND ', "(dbo.BIS2_VW_PlayerSession.GamingDate < '20160321') ": 'AND '}
2016-10-04 10:33:18.385217: Final data about 34e3bed48-1539eb8644e:
	UserAggList: ['ActualWin', 'CoinIn', 'GamesPlayed', 'Jackpot', 'TheoWin']
	UserRestrictList: ["(dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%') "]
	FinalQuery: SELECT 'Step 1' AS Step, SUM(dbo.BIS2_VW_PlayerSession.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_PlayerSession.coin_in_dollars_cents) AS CoinIn, SUM(dbo.BIS2_VW_PlayerSession.Handle_Pulls_Meter) AS GamesPlayed, SUM(dbo.BIS2_VW_PlayerSession.irs_jackpot_dol) AS Jackpot, SUM(ISNULL(dbo.BIS2_VW_PlayerSession.theo_loss_dol,0)) AS TheoWin, 'dbo.BIS2_VW_PlayerSession' AS StepInfo FROM dbo.BIS2_VW_PlayerSession WHERE (dbo.BIS2_VW_PlayerSession.Time_Started >= '20160101 00:00:00')  AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20151231')  AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20160320 00:00:00')  AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20160321')  UNION ALL SELECT 'Step 2' AS Step, SUM(dbo.BIS2_VW_PlayerSession.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_PlayerSession.coin_in_dollars_cents) AS CoinIn, SUM(dbo.BIS2_VW_PlayerSession.Handle_Pulls_Meter) AS GamesPlayed, SUM(dbo.BIS2_VW_PlayerSession.irs_jackpot_dol) AS Jackpot, SUM(ISNULL(dbo.BIS2_VW_PlayerSession.theo_loss_dol,0)) AS TheoWin, 'dbo.BIS2_VW_Slot_Config' AS StepInfo FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_PlayerSession.asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_PlayerSession.Time_Stopped >= dbo.BIS2_VW_Slot_Config.AV_Start_Date AND dbo.BIS2_VW_PlayerSession.Time_Stopped < dbo.BIS2_VW_Slot_Config.AV_End_Date AND dbo.BIS2_VW_PlayerSession.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE (dbo.BIS2_VW_PlayerSession.Time_Started >= '20160101 00:00:00')  AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20151231')  AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20160320 00:00:00')  AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20160321')  UNION ALL SELECT 'Step 2B' AS Step, SUM(dbo.BIS2_VW_PlayerSession.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_PlayerSession.coin_in_dollars_cents) AS CoinIn, SUM(dbo.BIS2_VW_PlayerSession.Handle_Pulls_Meter) AS GamesPlayed, SUM(dbo.BIS2_VW_PlayerSession.irs_jackpot_dol) AS Jackpot, SUM(ISNULL(dbo.BIS2_VW_PlayerSession.theo_loss_dol,0)) AS TheoWin, 'dbo.BIS2_VW_Slot_Config (Restriction)' AS StepInfo FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_PlayerSession.asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_PlayerSession.Time_Stopped >= dbo.BIS2_VW_Slot_Config.AV_Start_Date AND dbo.BIS2_VW_PlayerSession.Time_Stopped < dbo.BIS2_VW_Slot_Config.AV_End_Date AND dbo.BIS2_VW_PlayerSession.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE (dbo.BIS2_VW_PlayerSession.Time_Started >= '20160101 00:00:00')  AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20151231')  AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20160320 00:00:00')  AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20160321')  AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')  UNION ALL SELECT 'Step 3' AS Step, SUM(dbo.BIS2_VW_PlayerSession.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_PlayerSession.coin_in_dollars_cents) AS CoinIn, SUM(dbo.BIS2_VW_PlayerSession.Handle_Pulls_Meter) AS GamesPlayed, SUM(dbo.BIS2_VW_PlayerSession.irs_jackpot_dol) AS Jackpot, SUM(ISNULL(dbo.BIS2_VW_PlayerSession.theo_loss_dol,0)) AS TheoWin, 'dbo.BIS2_GEO_chairs' AS StepInfo FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_PlayerSession.asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_PlayerSession.Time_Stopped >= dbo.BIS2_VW_Slot_Config.AV_Start_Date AND dbo.BIS2_VW_PlayerSession.Time_Stopped < dbo.BIS2_VW_Slot_Config.AV_End_Date AND dbo.BIS2_VW_PlayerSession.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) INNER JOIN dbo.BIS2_GEO_chairs ON dbo.BIS2_VW_Slot_Config.stand_id = dbo.BIS2_GEO_chairs.standid WHERE (dbo.BIS2_VW_PlayerSession.Time_Started >= '20160101 00:00:00')  AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20151231')  AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20160320 00:00:00')  AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20160321')  AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')  UNION ALL SELECT 'Step 4' AS Step, SUM(dbo.BIS2_VW_PlayerSession.ActualWin) AS ActualWin, SUM(dbo.BIS2_VW_PlayerSession.coin_in_dollars_cents) AS CoinIn, SUM(dbo.BIS2_VW_PlayerSession.Handle_Pulls_Meter) AS GamesPlayed, SUM(dbo.BIS2_VW_PlayerSession.irs_jackpot_dol) AS Jackpot, SUM(ISNULL(dbo.BIS2_VW_PlayerSession.theo_loss_dol,0)) AS TheoWin, 'BIS2_SQLTC_UtilCalculation' AS StepInfo FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_PlayerSession.asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_PlayerSession.Time_Stopped >= dbo.BIS2_VW_Slot_Config.AV_Start_Date AND dbo.BIS2_VW_PlayerSession.Time_Stopped < dbo.BIS2_VW_Slot_Config.AV_End_Date AND dbo.BIS2_VW_PlayerSession.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) INNER JOIN dbo.BIS2_GEO_chairs ON dbo.BIS2_VW_Slot_Config.stand_id = dbo.BIS2_GEO_chairs.standid LEFT HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_UtilCalculation*/SELECT BIS2_SQLTC_RatedMetrics.Asset AS Asset,BIS2_SQLTC_RatedMetrics.Slot_Start AS Slot_Start,BIS2_SQLTC_RatedMetrics.StandID AS StandID,BIS2_SQLTC_RatedMetrics.GamesPlayedperMinute AS GamesPlayedperMinute,case when BIS2_SQLTC_RatedMetrics.GamesPlayedperHour<>0 then 100.0*BIS2_SQLTC_UnRatedMetrics.GamesPlayedperDay / BIS2_SQLTC_RatedMetrics.GamesPlayedperHour / 24.0 ELSE 0 END AS Occupancy,BIS2_SQLTC_RatedMetrics.PlayerCount AS PlayerCount,BIS2_SQLTC_RatedMetrics.TheoWinperHour AS TheoWinperHour FROM (/* SqlTableCalculator: BIS2_SQLTC_RatedMetrics*/SELECT dbo.BIS2_VW_Slot_Config.Asset AS Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AS Slot_Start,dbo.BIS2_VW_Slot_Config.stand_id AS StandID,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0)<>0 then SUM(BIS2_VW_PlayerSession.handle_pulls_meter)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) else 0 end AS GamesPlayedperHour,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/60.0)<>0 then SUM(BIS2_VW_PlayerSession.handle_pulls_meter)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/60.0) else 0 end AS GamesPlayedperMinute,count(distinct dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big) AS PlayerCount,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0)<>0 then SUM(BIS2_VW_PlayerSession.theo_loss_dol)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) else 0 end AS TheoWinperHour FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_PlayerSession.asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_PlayerSession.Time_Stopped >= dbo.BIS2_VW_Slot_Config.AV_Start_Date AND dbo.BIS2_VW_PlayerSession.Time_Stopped < dbo.BIS2_VW_Slot_Config.AV_End_Date AND dbo.BIS2_VW_PlayerSession.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20160101 00:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20160320 00:00:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20151231') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20160321') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date,dbo.BIS2_VW_Slot_Config.stand_id/* End: BIS2_SQLTC_RatedMetrics*/) AS BIS2_SQLTC_RatedMetrics INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_UnRatedMetrics*/SELECT dbo.BIS2_VW_Slot_Config.Asset AS Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AS Slot_Start,dbo.BIS2_VW_Slot_Config.stand_id AS StandID,CASE WHEN SUM(dbo.BIS2_VW_Slot_Daily.Machine_Days)<>0 THEN SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls)/SUM(dbo.BIS2_VW_Slot_Daily.Machine_Days) ELSE 0 END AS GamesPlayedperDay FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160320') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date,dbo.BIS2_VW_Slot_Config.stand_id/* End: BIS2_SQLTC_UnRatedMetrics*/) AS BIS2_SQLTC_UnRatedMetrics ON (BIS2_SQLTC_RatedMetrics.StandID = BIS2_SQLTC_UnRatedMetrics.StandID AND BIS2_SQLTC_RatedMetrics.Asset = BIS2_SQLTC_UnRatedMetrics.Asset AND BIS2_SQLTC_RatedMetrics.Slot_Start = BIS2_SQLTC_UnRatedMetrics.Slot_Start)/* End: BIS2_SQLTC_UtilCalculation*/) AS BIS2_SQLTC_UtilCalculation ON (dbo.BIS2_VW_Slot_Config.Asset = BIS2_SQLTC_UtilCalculation.Asset AND dbo.BIS2_VW_Slot_Config.stand_id = BIS2_SQLTC_UtilCalculation.StandID AND dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date = BIS2_SQLTC_UtilCalculation.Slot_Start) WHERE (dbo.BIS2_VW_PlayerSession.Time_Started >= '20160101 00:00:00')  AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20151231')  AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20160320 00:00:00')  AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20160321')  AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%') 
2016-10-04 10:33:18.596834: Checking 34f311442-154badd3d4a (Slot Report Dashboard, FV_D01):
	Query: SELECT dbo.BIS2_VW_Slot_Config.Asset AS Asset,dbo.BIS2_VW_Slot_Config.Bank AS Bank,dbo.BIS2_VW_Slot_Config.Cabinet_Type AS CabinetType,dbo.BIS2_VW_Slot_Config.denomination_nominal AS Denom,dbo.BIS2_VW_Slot_Config.Game_Code AS GameCode,dbo.BIS2_VW_Slot_Config.Game_Display AS Game_Display,dbo.BIS2_VW_Slot_Config.Location AS Location,dbo.BIS2_VW_Slot_Config.Manufacturer_Short_Name AS Manufacturer,dbo.BIS2_VW_Slot_Config.Number_Of_Play_Lines AS Paylines,dbo.BIS2_VW_Slot_Config.Number_Of_Reels AS Reels,dbo.BIS2_VW_Slot_Config.Section AS Section,dbo.BIS2_VW_Slot_Config.Serial_Number AS SerialNumber,dbo.BIS2_VW_Slot_Config.Game_Description AS Theme,dbo.BIS2_VW_Slot_Config.stand_id AS Slot_StandID,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AS Slot_StandID_SCD_Start,dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AS Slot_StandID_SCD_End,CASE WHEN(datepart(year,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date)*10000+datepart(mm,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date)*100+datepart(dd,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date))-(datepart(year,'20160501')*10000+datepart(mm,'20160501')*100+datepart(dd,'20160501'))<0 AND (datepart(year,'20160501')*10000+datepart(mm,'20160501')*100+datepart(dd,'20160501'))-(datepart(year,dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date)*10000+datepart(mm,dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date)*100+datepart(dd,dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date))<=0 THEN 0 ELSE 1 END AS Slot_StandID_SCD_History,CASE WHEN((dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date < '20160501' AND dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date >= '20160101') OR (dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date < '20160501' AND dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date >= '20160101'))THEN 1 ELSE 0 END AS Slot_StandID_SCD_Changed,SUM(dbo.BIS2_VW_Slot_Daily.Meter_Win) AS ActualHold,SUM(dbo.BIS2_VW_Slot_Daily.Meter_Win) AS ActualWin,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS ActualWinperDay,MAX(BIS2_SQLTC_UtilCalculation.PlayerCount) AS AvgBet,SUM(dbo.BIS2_VW_Slot_Daily.Meter_Coin_In) AS CoinIn,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS CoinInperDay,COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DaysonFloor,SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls) AS GamesPlayed,SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls)/COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS GamesPlayedperDay,MAX(BIS2_SQLTC_UtilCalculation.GamesPlayedperMinute) AS GamesPlayedperMinute,CASE    WHEN SUM(BIS2_VW_Slot_Daily.Meter_Coin_In) <> 0   THEN 100.0*(SUM(BIS2_VW_Slot_Daily.Meter_Win) - SUM(BIS2_VW_Slot_Daily.TheoWin))/SUM(BIS2_VW_Slot_Daily.Meter_Coin_In)   ELSE 0 END AS HoldVariance,MAX(BIS2_SQLTC_UtilCalculation.Occupancy) AS Occupancy,CASE    WHEN MAX(BIS2_SQLTC_DenomAvg.DenomAvgActualWin) <> 0    THEN (      SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(DISTINCT CAST(BIS2_VW_Slot_Daily.Slot_Date AS            VARCHAR) + CAST(BIS2_VW_Slot_Config.Stand_ID AS VARCHAR))      ) * 100.0 / MAX(BIS2_SQLTC_DenomAvg.DenomAvgActualWin)   ELSE 0   END AS PctofDenomAvgActualWin,CASE    WHEN MAX(BIS2_SQLTC_DenomAvg.DenomAvgCoinIn) <> 0    THEN (      SUM(BIS2_VW_Slot_Daily.Meter_Coin_In) / COUNT(DISTINCT CAST(BIS2_VW_Slot_Daily.           Slot_Date AS VARCHAR) + CAST(BIS2_VW_Slot_Config.Stand_ID AS VARCHAR))      ) * 100.0 / MAX(BIS2_SQLTC_DenomAvg.DenomAvgCoinIn)   ELSE 0   END AS PctofDenomAvgCoinIn,CASE    WHEN MAX(BIS2_SQLTC_DenomAvg.DenomAvgTheoWin) <> 0    THEN (      SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(DISTINCT CAST(BIS2_VW_Slot_Daily.slot_Date AS            VARCHAR) + CAST(BIS2_VW_Slot_Config.Stand_ID AS VARCHAR))      ) * 100.0 / MAX(BIS2_SQLTC_DenomAvg.DenomAvgTheoWin)   ELSE 0   END AS PctofDenomAvgTheoWin,CASE    WHEN MAX(BIS2_SQLTC_FloorAvg.FloorAvgActualWin) <> 0    THEN (      SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(DISTINCT CAST(BIS2_VW_Slot_Daily.slot_Date AS            VARCHAR) + CAST(BIS2_VW_Slot_Config.Stand_ID AS VARCHAR))      ) * 100.0 / MAX(BIS2_SQLTC_FloorAvg.FloorAvgActualWin)   ELSE 0   END AS PctofFloorAvgActualWin,CASE    WHEN MAX(BIS2_SQLTC_FloorAvg.FloorAvgCoinIn) <> 0    THEN (      SUM(BIS2_VW_Slot_Daily.Meter_Coin_In) / COUNT(DISTINCT CAST(BIS2_VW_Slot_Daily.           slot_Date AS VARCHAR) + CAST(BIS2_VW_Slot_Config.Stand_ID AS VARCHAR))      ) * 100.0 / MAX(BIS2_SQLTC_FloorAvg.FloorAvgCoinIn)   ELSE 0   END AS PctofFloorAvgCoinIn,CASE    WHEN MAX(BIS2_SQLTC_FloorAvg.FloorAvgTheoWin) <> 0    THEN (      SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(DISTINCT CAST(BIS2_VW_Slot_Daily.slot_Date AS            VARCHAR) + CAST(BIS2_VW_Slot_Config.Stand_ID AS VARCHAR))      ) * 100.0 / MAX(BIS2_SQLTC_FloorAvg.FloorAvgTheoWin)   ELSE 0   END AS PctofFloorAvgTheoWin,CASE    WHEN MAX(BIS2_SQLTC_SectionAvg.SectionAvgActualWin) <> 0    THEN (      SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(DISTINCT CAST(BIS2_VW_Slot_Daily.slot_Date AS            VARCHAR) + CAST(BIS2_VW_Slot_Config.Stand_ID AS VARCHAR))      ) * 100.0 / MAX(BIS2_SQLTC_SectionAvg.SectionAvgActualWin)   ELSE 0   END AS PctofSectionAvgActualWin,CASE    WHEN MAX(BIS2_SQLTC_SectionAvg.SectionAvgCoinIn) <> 0    THEN (      SUM(BIS2_VW_Slot_Daily.Meter_Coin_In) / COUNT(DISTINCT CAST(BIS2_VW_Slot_Daily.           slot_Date AS VARCHAR) + CAST(BIS2_VW_Slot_Config.Stand_ID AS VARCHAR))      ) * 100.0 / MAX(BIS2_SQLTC_SectionAvg.SectionAvgCoinIn)   ELSE 0   END AS PctofSectionAvgCoinIn,CASE    WHEN MAX(BIS2_SQLTC_SectionAvg.SectionAvgTheoWin) <> 0    THEN (      SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(DISTINCT CAST(BIS2_VW_Slot_Daily.slot_Date AS            VARCHAR) + CAST(BIS2_VW_Slot_Config.Stand_ID AS VARCHAR))      ) * 100.0 / MAX(BIS2_SQLTC_SectionAvg.SectionAvgTheoWin)   ELSE 0   END AS PctofSectionAvgTheoWin,SUM(dbo.BIS2_VW_Slot_Daily.TheoWin) AS TheoHold,SUM(dbo.BIS2_VW_Slot_Daily.TheoWin) AS TheoWin,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS TheoWinperDay,MAX(BIS2_SQLTC_UtilCalculation.TheoWinperHour) AS TheoWinperHour FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_SectionAvg*/SELECT dbo.BIS2_VW_Slot_Config.Section AS Section,dbo.BIS2_VW_Slot_Config.SiteID AS SiteID,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgActualWin,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgCoinIn,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgTheoWin FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160501')) GROUP BY dbo.BIS2_VW_Slot_Config.Section,dbo.BIS2_VW_Slot_Config.SiteID/* End: BIS2_SQLTC_SectionAvg*/) AS BIS2_SQLTC_SectionAvg ON (dbo.BIS2_VW_Slot_Config.Section = BIS2_SQLTC_SectionAvg.Section AND dbo.BIS2_VW_Slot_Config.SiteID = BIS2_SQLTC_SectionAvg.SiteID) LEFT HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_UtilCalculation*/SELECT BIS2_SQLTC_RatedMetrics.Asset AS Asset,BIS2_SQLTC_RatedMetrics.Slot_Start AS Slot_Start,BIS2_SQLTC_RatedMetrics.StandID AS StandID,BIS2_SQLTC_RatedMetrics.GamesPlayedperMinute AS GamesPlayedperMinute,case when BIS2_SQLTC_RatedMetrics.GamesPlayedperHour<>0 then 100.0*BIS2_SQLTC_UnRatedMetrics.GamesPlayedperDay / BIS2_SQLTC_RatedMetrics.GamesPlayedperHour / 24.0 ELSE 0 END AS Occupancy,BIS2_SQLTC_RatedMetrics.PlayerCount AS PlayerCount,BIS2_SQLTC_RatedMetrics.TheoWinperHour AS TheoWinperHour FROM (/* SqlTableCalculator: BIS2_SQLTC_RatedMetrics*/SELECT dbo.BIS2_VW_Slot_Config.Asset AS Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AS Slot_Start,dbo.BIS2_VW_Slot_Config.stand_id AS StandID,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0)<>0 then SUM(BIS2_VW_PlayerSession.handle_pulls_meter)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) else 0 end AS GamesPlayedperHour,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/60.0)<>0 then SUM(BIS2_VW_PlayerSession.handle_pulls_meter)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/60.0) else 0 end AS GamesPlayedperMinute,count(distinct dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big) AS PlayerCount,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0)<>0 then SUM(BIS2_VW_PlayerSession.theo_loss_dol)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) else 0 end AS TheoWinperHour FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_PlayerSession.asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_PlayerSession.Time_Stopped >= dbo.BIS2_VW_Slot_Config.AV_Start_Date AND dbo.BIS2_VW_PlayerSession.Time_Stopped < dbo.BIS2_VW_Slot_Config.AV_End_Date AND dbo.BIS2_VW_PlayerSession.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20160101 00:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20160501 00:00:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20151231') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20160502')) GROUP BY dbo.BIS2_VW_Slot_Config.Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date,dbo.BIS2_VW_Slot_Config.stand_id/* End: BIS2_SQLTC_RatedMetrics*/) AS BIS2_SQLTC_RatedMetrics INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_UnRatedMetrics*/SELECT dbo.BIS2_VW_Slot_Config.Asset AS Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AS Slot_Start,dbo.BIS2_VW_Slot_Config.stand_id AS StandID,CASE WHEN SUM(dbo.BIS2_VW_Slot_Daily.Machine_Days)<>0 THEN SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls)/SUM(dbo.BIS2_VW_Slot_Daily.Machine_Days) ELSE 0 END AS GamesPlayedperDay FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160501')) GROUP BY dbo.BIS2_VW_Slot_Config.Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date,dbo.BIS2_VW_Slot_Config.stand_id/* End: BIS2_SQLTC_UnRatedMetrics*/) AS BIS2_SQLTC_UnRatedMetrics ON (BIS2_SQLTC_RatedMetrics.StandID = BIS2_SQLTC_UnRatedMetrics.StandID AND BIS2_SQLTC_RatedMetrics.Asset = BIS2_SQLTC_UnRatedMetrics.Asset AND BIS2_SQLTC_RatedMetrics.Slot_Start = BIS2_SQLTC_UnRatedMetrics.Slot_Start)/* End: BIS2_SQLTC_UtilCalculation*/) AS BIS2_SQLTC_UtilCalculation ON (dbo.BIS2_VW_Slot_Config.Asset = BIS2_SQLTC_UtilCalculation.Asset AND dbo.BIS2_VW_Slot_Config.stand_id = BIS2_SQLTC_UtilCalculation.StandID AND dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date = BIS2_SQLTC_UtilCalculation.Slot_Start) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DenomAvg*/SELECT dbo.BIS2_VW_Slot_Config.denomination_nominal AS Denom,dbo.BIS2_VW_Slot_Config.SiteID AS SiteID,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DenomAvgActualWin,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DenomAvgCoinIn,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DenomAvgTheoWin FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160501')) GROUP BY dbo.BIS2_VW_Slot_Config.denomination_nominal,dbo.BIS2_VW_Slot_Config.SiteID/* End: BIS2_SQLTC_DenomAvg*/) AS BIS2_SQLTC_DenomAvg ON (dbo.BIS2_VW_Slot_Config.denomination_nominal = BIS2_SQLTC_DenomAvg.Denom AND dbo.BIS2_VW_Slot_Config.SiteID = BIS2_SQLTC_DenomAvg.SiteID) INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_FloorAvg*/SELECT dbo.BIS2_VW_Slot_Config.SiteID AS SiteID,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS FloorAvgActualWin,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS FloorAvgCoinIn,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS FloorAvgTheoWin FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160501')) GROUP BY dbo.BIS2_VW_Slot_Config.SiteID/* End: BIS2_SQLTC_FloorAvg*/) AS BIS2_SQLTC_FloorAvg ON dbo.BIS2_VW_Slot_Config.SiteID = BIS2_SQLTC_FloorAvg.SiteID WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160501') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date) AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date)) GROUP BY dbo.BIS2_VW_Slot_Config.Asset,dbo.BIS2_VW_Slot_Config.Bank,dbo.BIS2_VW_Slot_Config.Cabinet_Type,dbo.BIS2_VW_Slot_Config.denomination_nominal,dbo.BIS2_VW_Slot_Config.Game_Code,dbo.BIS2_VW_Slot_Config.Game_Display,dbo.BIS2_VW_Slot_Config.Location,dbo.BIS2_VW_Slot_Config.Manufacturer_Short_Name,dbo.BIS2_VW_Slot_Config.Number_Of_Play_Lines,dbo.BIS2_VW_Slot_Config.Number_Of_Reels,dbo.BIS2_VW_Slot_Config.Section,dbo.BIS2_VW_Slot_Config.Serial_Number,dbo.BIS2_VW_Slot_Config.Game_Description,dbo.BIS2_VW_Slot_Config.stand_id,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date,dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date,CASE WHEN(datepart(year,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date)*10000+datepart(mm,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date)*100+datepart(dd,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date))-(datepart(year,'20160501')*10000+datepart(mm,'20160501')*100+datepart(dd,'20160501'))<0 AND (datepart(year,'20160501')*10000+datepart(mm,'20160501')*100+datepart(dd,'20160501'))-(datepart(year,dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date)*10000+datepart(mm,dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date)*100+datepart(dd,dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date))<=0 THEN 0 ELSE 1 END,CASE WHEN((dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date < '20160501' AND dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date >= '20160101') OR (dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date < '20160501' AND dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date >= '20160101'))THEN 1 ELSE 0 END ORDER BY Slot_StandID,Slot_StandID_SCD_History,Slot_StandID_SCD_Start DESC
	DocAggs: ['ActualHold', 'ActualWin', 'ActualWinperDay', 'CoinIn', 'CoinInperDay', 'DaysonFloor', 'GamesPlayed', 'GamesPlayedperDay', 'HoldVariance']
	DocAggDict: {'GamesPlayedperDay': 'SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls)/COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS GamesPlayedperDay', 'ActualWin': 'SUM(dbo.BIS2_VW_Slot_Daily.Meter_Win) AS ActualWin', 'ActualWinperDay': 'SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS ActualWinperDay', 'CoinInperDay': 'SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS CoinInperDay', 'CoinIn': 'SUM(dbo.BIS2_VW_Slot_Daily.Meter_Coin_In) AS CoinIn', 'GamesPlayed': 'SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls) AS GamesPlayed', 'DaysonFloor': 'COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DaysonFloor', 'HoldVariance': 'SUM(BIS2_VW_Slot_Daily.Meter_Coin_In) <> 0   THEN 100.0*(SUM(BIS2_VW_Slot_Daily.Meter_Win) - SUM(BIS2_VW_Slot_Daily.TheoWin))/SUM(BIS2_VW_Slot_Daily.Meter_Coin_In)   ELSE 0 END AS HoldVariance', 'ActualHold': 'SUM(dbo.BIS2_VW_Slot_Daily.Meter_Win) AS ActualHold'}
	DocJoins: ['dbo.BIS2_VW_Slot_Daily', 'dbo.BIS2_VW_Slot_Config', 'BIS2_SQLTC_SectionAvg', 'BIS2_SQLTC_UtilCalculation', 'BIS2_SQLTC_DenomAvg', 'BIS2_SQLTC_FloorAvg']DocJoinDict: {'BIS2_SQLTC_SectionAvg': "INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_SectionAvg*/SELECT dbo.BIS2_VW_Slot_Config.Section AS Section,dbo.BIS2_VW_Slot_Config.SiteID AS SiteID,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgActualWin,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgCoinIn,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgTheoWin FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160501')) GROUP BY dbo.BIS2_VW_Slot_Config.Section,dbo.BIS2_VW_Slot_Config.SiteID/* End: BIS2_SQLTC_SectionAvg*/) AS BIS2_SQLTC_SectionAvg ON (dbo.BIS2_VW_Slot_Config.Section = BIS2_SQLTC_SectionAvg.Section AND dbo.BIS2_VW_Slot_Config.SiteID = BIS2_SQLTC_SectionAvg.SiteID) ", 'BIS2_SQLTC_UtilCalculation': "LEFT HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_UtilCalculation*/SELECT BIS2_SQLTC_RatedMetrics.Asset AS Asset,BIS2_SQLTC_RatedMetrics.Slot_Start AS Slot_Start,BIS2_SQLTC_RatedMetrics.StandID AS StandID,BIS2_SQLTC_RatedMetrics.GamesPlayedperMinute AS GamesPlayedperMinute,case when BIS2_SQLTC_RatedMetrics.GamesPlayedperHour<>0 then 100.0*BIS2_SQLTC_UnRatedMetrics.GamesPlayedperDay / BIS2_SQLTC_RatedMetrics.GamesPlayedperHour / 24.0 ELSE 0 END AS Occupancy,BIS2_SQLTC_RatedMetrics.PlayerCount AS PlayerCount,BIS2_SQLTC_RatedMetrics.TheoWinperHour AS TheoWinperHour FROM (/* SqlTableCalculator: BIS2_SQLTC_RatedMetrics*/SELECT dbo.BIS2_VW_Slot_Config.Asset AS Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AS Slot_Start,dbo.BIS2_VW_Slot_Config.stand_id AS StandID,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0)<>0 then SUM(BIS2_VW_PlayerSession.handle_pulls_meter)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) else 0 end AS GamesPlayedperHour,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/60.0)<>0 then SUM(BIS2_VW_PlayerSession.handle_pulls_meter)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/60.0) else 0 end AS GamesPlayedperMinute,count(distinct dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big) AS PlayerCount,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0)<>0 then SUM(BIS2_VW_PlayerSession.theo_loss_dol)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) else 0 end AS TheoWinperHour FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_PlayerSession.asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_PlayerSession.Time_Stopped >= dbo.BIS2_VW_Slot_Config.AV_Start_Date AND dbo.BIS2_VW_PlayerSession.Time_Stopped < dbo.BIS2_VW_Slot_Config.AV_End_Date AND dbo.BIS2_VW_PlayerSession.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20160101 00:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20160501 00:00:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20151231') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20160502')) GROUP BY dbo.BIS2_VW_Slot_Config.Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date,dbo.BIS2_VW_Slot_Config.stand_id/* End: BIS2_SQLTC_RatedMetrics*/) AS BIS2_SQLTC_RatedMetrics INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_UnRatedMetrics*/SELECT dbo.BIS2_VW_Slot_Config.Asset AS Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AS Slot_Start,dbo.BIS2_VW_Slot_Config.stand_id AS StandID,CASE WHEN SUM(dbo.BIS2_VW_Slot_Daily.Machine_Days)<>0 THEN SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls)/SUM(dbo.BIS2_VW_Slot_Daily.Machine_Days) ELSE 0 END AS GamesPlayedperDay FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160501')) GROUP BY dbo.BIS2_VW_Slot_Config.Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date,dbo.BIS2_VW_Slot_Config.stand_id/* End: BIS2_SQLTC_UnRatedMetrics*/) AS BIS2_SQLTC_UnRatedMetrics ON (BIS2_SQLTC_RatedMetrics.StandID = BIS2_SQLTC_UnRatedMetrics.StandID AND BIS2_SQLTC_RatedMetrics.Asset = BIS2_SQLTC_UnRatedMetrics.Asset AND BIS2_SQLTC_RatedMetrics.Slot_Start = BIS2_SQLTC_UnRatedMetrics.Slot_Start)/* End: BIS2_SQLTC_UtilCalculation*/) AS BIS2_SQLTC_UtilCalculation ON (dbo.BIS2_VW_Slot_Config.Asset = BIS2_SQLTC_UtilCalculation.Asset AND dbo.BIS2_VW_Slot_Config.stand_id = BIS2_SQLTC_UtilCalculation.StandID AND dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date = BIS2_SQLTC_UtilCalculation.Slot_Start) ", 'BIS2_SQLTC_DenomAvg': "INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DenomAvg*/SELECT dbo.BIS2_VW_Slot_Config.denomination_nominal AS Denom,dbo.BIS2_VW_Slot_Config.SiteID AS SiteID,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DenomAvgActualWin,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DenomAvgCoinIn,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DenomAvgTheoWin FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160501')) GROUP BY dbo.BIS2_VW_Slot_Config.denomination_nominal,dbo.BIS2_VW_Slot_Config.SiteID/* End: BIS2_SQLTC_DenomAvg*/) AS BIS2_SQLTC_DenomAvg ON (dbo.BIS2_VW_Slot_Config.denomination_nominal = BIS2_SQLTC_DenomAvg.Denom AND dbo.BIS2_VW_Slot_Config.SiteID = BIS2_SQLTC_DenomAvg.SiteID) ", 'dbo.BIS2_VW_Slot_Daily': 'FROM dbo.BIS2_VW_Slot_Daily ', 'BIS2_SQLTC_FloorAvg': "INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_FloorAvg*/SELECT dbo.BIS2_VW_Slot_Config.SiteID AS SiteID,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS FloorAvgActualWin,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS FloorAvgCoinIn,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS FloorAvgTheoWin FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160501')) GROUP BY dbo.BIS2_VW_Slot_Config.SiteID/* End: BIS2_SQLTC_FloorAvg*/) AS BIS2_SQLTC_FloorAvg ON dbo.BIS2_VW_Slot_Config.SiteID = BIS2_SQLTC_FloorAvg.SiteID ", 'dbo.BIS2_VW_Slot_Config': 'INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) '}
	DocWhere: ["(dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') ", "(dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160501') ", '(dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date) ', '(dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date)']
	DocWhereAnd: {"(dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160501') ": 'AND ', '(dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date) ': 'AND ', "(dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') ": 'start', '(dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date)': 'AND '}
2016-10-04 10:33:27.736734: Final data about 34f311442-154badd3d4a:
	UserAggList: ['ActualWin', 'CoinIn', 'GamesPlayed']
	UserRestrictList: []
	FinalQuery: SELECT 'Step 1' AS Step, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Win) AS ActualWin, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Coin_In) AS CoinIn, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls) AS GamesPlayed, 'dbo.BIS2_VW_Slot_Daily' AS StepInfo FROM dbo.BIS2_VW_Slot_Daily WHERE (dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101')  AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160501')  UNION ALL SELECT 'Step 2' AS Step, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Win) AS ActualWin, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Coin_In) AS CoinIn, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls) AS GamesPlayed, 'dbo.BIS2_VW_Slot_Config' AS StepInfo FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE (dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101')  AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160501')  UNION ALL SELECT 'Step 3' AS Step, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Win) AS ActualWin, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Coin_In) AS CoinIn, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls) AS GamesPlayed, 'BIS2_SQLTC_SectionAvg' AS StepInfo FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_SectionAvg*/SELECT dbo.BIS2_VW_Slot_Config.Section AS Section,dbo.BIS2_VW_Slot_Config.SiteID AS SiteID,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgActualWin,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgCoinIn,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgTheoWin FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160501')) GROUP BY dbo.BIS2_VW_Slot_Config.Section,dbo.BIS2_VW_Slot_Config.SiteID/* End: BIS2_SQLTC_SectionAvg*/) AS BIS2_SQLTC_SectionAvg ON (dbo.BIS2_VW_Slot_Config.Section = BIS2_SQLTC_SectionAvg.Section AND dbo.BIS2_VW_Slot_Config.SiteID = BIS2_SQLTC_SectionAvg.SiteID) WHERE (dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101')  AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160501')  UNION ALL SELECT 'Step 4' AS Step, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Win) AS ActualWin, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Coin_In) AS CoinIn, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls) AS GamesPlayed, 'BIS2_SQLTC_UtilCalculation' AS StepInfo FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_SectionAvg*/SELECT dbo.BIS2_VW_Slot_Config.Section AS Section,dbo.BIS2_VW_Slot_Config.SiteID AS SiteID,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgActualWin,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgCoinIn,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgTheoWin FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160501')) GROUP BY dbo.BIS2_VW_Slot_Config.Section,dbo.BIS2_VW_Slot_Config.SiteID/* End: BIS2_SQLTC_SectionAvg*/) AS BIS2_SQLTC_SectionAvg ON (dbo.BIS2_VW_Slot_Config.Section = BIS2_SQLTC_SectionAvg.Section AND dbo.BIS2_VW_Slot_Config.SiteID = BIS2_SQLTC_SectionAvg.SiteID) LEFT HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_UtilCalculation*/SELECT BIS2_SQLTC_RatedMetrics.Asset AS Asset,BIS2_SQLTC_RatedMetrics.Slot_Start AS Slot_Start,BIS2_SQLTC_RatedMetrics.StandID AS StandID,BIS2_SQLTC_RatedMetrics.GamesPlayedperMinute AS GamesPlayedperMinute,case when BIS2_SQLTC_RatedMetrics.GamesPlayedperHour<>0 then 100.0*BIS2_SQLTC_UnRatedMetrics.GamesPlayedperDay / BIS2_SQLTC_RatedMetrics.GamesPlayedperHour / 24.0 ELSE 0 END AS Occupancy,BIS2_SQLTC_RatedMetrics.PlayerCount AS PlayerCount,BIS2_SQLTC_RatedMetrics.TheoWinperHour AS TheoWinperHour FROM (/* SqlTableCalculator: BIS2_SQLTC_RatedMetrics*/SELECT dbo.BIS2_VW_Slot_Config.Asset AS Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AS Slot_Start,dbo.BIS2_VW_Slot_Config.stand_id AS StandID,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0)<>0 then SUM(BIS2_VW_PlayerSession.handle_pulls_meter)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) else 0 end AS GamesPlayedperHour,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/60.0)<>0 then SUM(BIS2_VW_PlayerSession.handle_pulls_meter)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/60.0) else 0 end AS GamesPlayedperMinute,count(distinct dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big) AS PlayerCount,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0)<>0 then SUM(BIS2_VW_PlayerSession.theo_loss_dol)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) else 0 end AS TheoWinperHour FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_PlayerSession.asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_PlayerSession.Time_Stopped >= dbo.BIS2_VW_Slot_Config.AV_Start_Date AND dbo.BIS2_VW_PlayerSession.Time_Stopped < dbo.BIS2_VW_Slot_Config.AV_End_Date AND dbo.BIS2_VW_PlayerSession.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20160101 00:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20160501 00:00:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20151231') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20160502')) GROUP BY dbo.BIS2_VW_Slot_Config.Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date,dbo.BIS2_VW_Slot_Config.stand_id/* End: BIS2_SQLTC_RatedMetrics*/) AS BIS2_SQLTC_RatedMetrics INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_UnRatedMetrics*/SELECT dbo.BIS2_VW_Slot_Config.Asset AS Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AS Slot_Start,dbo.BIS2_VW_Slot_Config.stand_id AS StandID,CASE WHEN SUM(dbo.BIS2_VW_Slot_Daily.Machine_Days)<>0 THEN SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls)/SUM(dbo.BIS2_VW_Slot_Daily.Machine_Days) ELSE 0 END AS GamesPlayedperDay FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160501')) GROUP BY dbo.BIS2_VW_Slot_Config.Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date,dbo.BIS2_VW_Slot_Config.stand_id/* End: BIS2_SQLTC_UnRatedMetrics*/) AS BIS2_SQLTC_UnRatedMetrics ON (BIS2_SQLTC_RatedMetrics.StandID = BIS2_SQLTC_UnRatedMetrics.StandID AND BIS2_SQLTC_RatedMetrics.Asset = BIS2_SQLTC_UnRatedMetrics.Asset AND BIS2_SQLTC_RatedMetrics.Slot_Start = BIS2_SQLTC_UnRatedMetrics.Slot_Start)/* End: BIS2_SQLTC_UtilCalculation*/) AS BIS2_SQLTC_UtilCalculation ON (dbo.BIS2_VW_Slot_Config.Asset = BIS2_SQLTC_UtilCalculation.Asset AND dbo.BIS2_VW_Slot_Config.stand_id = BIS2_SQLTC_UtilCalculation.StandID AND dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date = BIS2_SQLTC_UtilCalculation.Slot_Start) WHERE (dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101')  AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160501')  UNION ALL SELECT 'Step 5' AS Step, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Win) AS ActualWin, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Coin_In) AS CoinIn, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls) AS GamesPlayed, 'BIS2_SQLTC_DenomAvg' AS StepInfo FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_SectionAvg*/SELECT dbo.BIS2_VW_Slot_Config.Section AS Section,dbo.BIS2_VW_Slot_Config.SiteID AS SiteID,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgActualWin,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgCoinIn,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgTheoWin FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160501')) GROUP BY dbo.BIS2_VW_Slot_Config.Section,dbo.BIS2_VW_Slot_Config.SiteID/* End: BIS2_SQLTC_SectionAvg*/) AS BIS2_SQLTC_SectionAvg ON (dbo.BIS2_VW_Slot_Config.Section = BIS2_SQLTC_SectionAvg.Section AND dbo.BIS2_VW_Slot_Config.SiteID = BIS2_SQLTC_SectionAvg.SiteID) LEFT HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_UtilCalculation*/SELECT BIS2_SQLTC_RatedMetrics.Asset AS Asset,BIS2_SQLTC_RatedMetrics.Slot_Start AS Slot_Start,BIS2_SQLTC_RatedMetrics.StandID AS StandID,BIS2_SQLTC_RatedMetrics.GamesPlayedperMinute AS GamesPlayedperMinute,case when BIS2_SQLTC_RatedMetrics.GamesPlayedperHour<>0 then 100.0*BIS2_SQLTC_UnRatedMetrics.GamesPlayedperDay / BIS2_SQLTC_RatedMetrics.GamesPlayedperHour / 24.0 ELSE 0 END AS Occupancy,BIS2_SQLTC_RatedMetrics.PlayerCount AS PlayerCount,BIS2_SQLTC_RatedMetrics.TheoWinperHour AS TheoWinperHour FROM (/* SqlTableCalculator: BIS2_SQLTC_RatedMetrics*/SELECT dbo.BIS2_VW_Slot_Config.Asset AS Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AS Slot_Start,dbo.BIS2_VW_Slot_Config.stand_id AS StandID,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0)<>0 then SUM(BIS2_VW_PlayerSession.handle_pulls_meter)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) else 0 end AS GamesPlayedperHour,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/60.0)<>0 then SUM(BIS2_VW_PlayerSession.handle_pulls_meter)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/60.0) else 0 end AS GamesPlayedperMinute,count(distinct dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big) AS PlayerCount,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0)<>0 then SUM(BIS2_VW_PlayerSession.theo_loss_dol)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) else 0 end AS TheoWinperHour FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_PlayerSession.asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_PlayerSession.Time_Stopped >= dbo.BIS2_VW_Slot_Config.AV_Start_Date AND dbo.BIS2_VW_PlayerSession.Time_Stopped < dbo.BIS2_VW_Slot_Config.AV_End_Date AND dbo.BIS2_VW_PlayerSession.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20160101 00:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20160501 00:00:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20151231') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20160502')) GROUP BY dbo.BIS2_VW_Slot_Config.Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date,dbo.BIS2_VW_Slot_Config.stand_id/* End: BIS2_SQLTC_RatedMetrics*/) AS BIS2_SQLTC_RatedMetrics INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_UnRatedMetrics*/SELECT dbo.BIS2_VW_Slot_Config.Asset AS Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AS Slot_Start,dbo.BIS2_VW_Slot_Config.stand_id AS StandID,CASE WHEN SUM(dbo.BIS2_VW_Slot_Daily.Machine_Days)<>0 THEN SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls)/SUM(dbo.BIS2_VW_Slot_Daily.Machine_Days) ELSE 0 END AS GamesPlayedperDay FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160501')) GROUP BY dbo.BIS2_VW_Slot_Config.Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date,dbo.BIS2_VW_Slot_Config.stand_id/* End: BIS2_SQLTC_UnRatedMetrics*/) AS BIS2_SQLTC_UnRatedMetrics ON (BIS2_SQLTC_RatedMetrics.StandID = BIS2_SQLTC_UnRatedMetrics.StandID AND BIS2_SQLTC_RatedMetrics.Asset = BIS2_SQLTC_UnRatedMetrics.Asset AND BIS2_SQLTC_RatedMetrics.Slot_Start = BIS2_SQLTC_UnRatedMetrics.Slot_Start)/* End: BIS2_SQLTC_UtilCalculation*/) AS BIS2_SQLTC_UtilCalculation ON (dbo.BIS2_VW_Slot_Config.Asset = BIS2_SQLTC_UtilCalculation.Asset AND dbo.BIS2_VW_Slot_Config.stand_id = BIS2_SQLTC_UtilCalculation.StandID AND dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date = BIS2_SQLTC_UtilCalculation.Slot_Start) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DenomAvg*/SELECT dbo.BIS2_VW_Slot_Config.denomination_nominal AS Denom,dbo.BIS2_VW_Slot_Config.SiteID AS SiteID,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DenomAvgActualWin,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DenomAvgCoinIn,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DenomAvgTheoWin FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160501')) GROUP BY dbo.BIS2_VW_Slot_Config.denomination_nominal,dbo.BIS2_VW_Slot_Config.SiteID/* End: BIS2_SQLTC_DenomAvg*/) AS BIS2_SQLTC_DenomAvg ON (dbo.BIS2_VW_Slot_Config.denomination_nominal = BIS2_SQLTC_DenomAvg.Denom AND dbo.BIS2_VW_Slot_Config.SiteID = BIS2_SQLTC_DenomAvg.SiteID) WHERE (dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101')  AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160501')  UNION ALL SELECT 'Step 6' AS Step, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Win) AS ActualWin, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Coin_In) AS CoinIn, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls) AS GamesPlayed, 'BIS2_SQLTC_FloorAvg' AS StepInfo FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_SectionAvg*/SELECT dbo.BIS2_VW_Slot_Config.Section AS Section,dbo.BIS2_VW_Slot_Config.SiteID AS SiteID,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgActualWin,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgCoinIn,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgTheoWin FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160501')) GROUP BY dbo.BIS2_VW_Slot_Config.Section,dbo.BIS2_VW_Slot_Config.SiteID/* End: BIS2_SQLTC_SectionAvg*/) AS BIS2_SQLTC_SectionAvg ON (dbo.BIS2_VW_Slot_Config.Section = BIS2_SQLTC_SectionAvg.Section AND dbo.BIS2_VW_Slot_Config.SiteID = BIS2_SQLTC_SectionAvg.SiteID) LEFT HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_UtilCalculation*/SELECT BIS2_SQLTC_RatedMetrics.Asset AS Asset,BIS2_SQLTC_RatedMetrics.Slot_Start AS Slot_Start,BIS2_SQLTC_RatedMetrics.StandID AS StandID,BIS2_SQLTC_RatedMetrics.GamesPlayedperMinute AS GamesPlayedperMinute,case when BIS2_SQLTC_RatedMetrics.GamesPlayedperHour<>0 then 100.0*BIS2_SQLTC_UnRatedMetrics.GamesPlayedperDay / BIS2_SQLTC_RatedMetrics.GamesPlayedperHour / 24.0 ELSE 0 END AS Occupancy,BIS2_SQLTC_RatedMetrics.PlayerCount AS PlayerCount,BIS2_SQLTC_RatedMetrics.TheoWinperHour AS TheoWinperHour FROM (/* SqlTableCalculator: BIS2_SQLTC_RatedMetrics*/SELECT dbo.BIS2_VW_Slot_Config.Asset AS Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AS Slot_Start,dbo.BIS2_VW_Slot_Config.stand_id AS StandID,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0)<>0 then SUM(BIS2_VW_PlayerSession.handle_pulls_meter)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) else 0 end AS GamesPlayedperHour,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/60.0)<>0 then SUM(BIS2_VW_PlayerSession.handle_pulls_meter)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/60.0) else 0 end AS GamesPlayedperMinute,count(distinct dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big) AS PlayerCount,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0)<>0 then SUM(BIS2_VW_PlayerSession.theo_loss_dol)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) else 0 end AS TheoWinperHour FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_PlayerSession.asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_PlayerSession.Time_Stopped >= dbo.BIS2_VW_Slot_Config.AV_Start_Date AND dbo.BIS2_VW_PlayerSession.Time_Stopped < dbo.BIS2_VW_Slot_Config.AV_End_Date AND dbo.BIS2_VW_PlayerSession.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20160101 00:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20160501 00:00:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20151231') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20160502')) GROUP BY dbo.BIS2_VW_Slot_Config.Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date,dbo.BIS2_VW_Slot_Config.stand_id/* End: BIS2_SQLTC_RatedMetrics*/) AS BIS2_SQLTC_RatedMetrics INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_UnRatedMetrics*/SELECT dbo.BIS2_VW_Slot_Config.Asset AS Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AS Slot_Start,dbo.BIS2_VW_Slot_Config.stand_id AS StandID,CASE WHEN SUM(dbo.BIS2_VW_Slot_Daily.Machine_Days)<>0 THEN SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls)/SUM(dbo.BIS2_VW_Slot_Daily.Machine_Days) ELSE 0 END AS GamesPlayedperDay FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160501')) GROUP BY dbo.BIS2_VW_Slot_Config.Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date,dbo.BIS2_VW_Slot_Config.stand_id/* End: BIS2_SQLTC_UnRatedMetrics*/) AS BIS2_SQLTC_UnRatedMetrics ON (BIS2_SQLTC_RatedMetrics.StandID = BIS2_SQLTC_UnRatedMetrics.StandID AND BIS2_SQLTC_RatedMetrics.Asset = BIS2_SQLTC_UnRatedMetrics.Asset AND BIS2_SQLTC_RatedMetrics.Slot_Start = BIS2_SQLTC_UnRatedMetrics.Slot_Start)/* End: BIS2_SQLTC_UtilCalculation*/) AS BIS2_SQLTC_UtilCalculation ON (dbo.BIS2_VW_Slot_Config.Asset = BIS2_SQLTC_UtilCalculation.Asset AND dbo.BIS2_VW_Slot_Config.stand_id = BIS2_SQLTC_UtilCalculation.StandID AND dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date = BIS2_SQLTC_UtilCalculation.Slot_Start) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DenomAvg*/SELECT dbo.BIS2_VW_Slot_Config.denomination_nominal AS Denom,dbo.BIS2_VW_Slot_Config.SiteID AS SiteID,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DenomAvgActualWin,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DenomAvgCoinIn,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DenomAvgTheoWin FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160501')) GROUP BY dbo.BIS2_VW_Slot_Config.denomination_nominal,dbo.BIS2_VW_Slot_Config.SiteID/* End: BIS2_SQLTC_DenomAvg*/) AS BIS2_SQLTC_DenomAvg ON (dbo.BIS2_VW_Slot_Config.denomination_nominal = BIS2_SQLTC_DenomAvg.Denom AND dbo.BIS2_VW_Slot_Config.SiteID = BIS2_SQLTC_DenomAvg.SiteID) INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_FloorAvg*/SELECT dbo.BIS2_VW_Slot_Config.SiteID AS SiteID,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS FloorAvgActualWin,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS FloorAvgCoinIn,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS FloorAvgTheoWin FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160501')) GROUP BY dbo.BIS2_VW_Slot_Config.SiteID/* End: BIS2_SQLTC_FloorAvg*/) AS BIS2_SQLTC_FloorAvg ON dbo.BIS2_VW_Slot_Config.SiteID = BIS2_SQLTC_FloorAvg.SiteID WHERE (dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101')  AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160501') 
2016-10-04 10:33:27.792274: Checking 34c682578-152570abfe9 (Bottom 50 Theme / Denom by Month, FV_P02):
	Query: SELECT sign(datepart(dd,BIS2_FN_GameThemes_TWPU_Index.Norm)) AS VBB2__NORM_FIELD,BIS2_FN_GameThemes_TWPU_Index.Denom AS Denom,BIS2_FN_GameThemes_TWPU_Index.GameTheme AS GameTheme,BIS2_FN_GameThemes_TWPU_Index.GameType AS GameType,BIS2_FN_GameThemes_TWPU_Index.GamingMonth AS GamingMonth,BIS2_FN_GameThemes_TWPU_Index.GamingYear AS GamingYear,BIS2_FN_GameThemes_TWPU_Index.GamingYearMonth AS GamingYearMonth,BIS2_FN_GameThemes_TWPU_Index.int_yearMonth AS int_yearMonth,BIS2_FN_GameThemes_TWPU_Index.Manufacturer AS Manufacturer,BIS2_FN_GameThemes_TWPU_Index.ranked_GameTheme AS ranked_GameTheme,BIS2_FN_GameThemes_TWPU_Index.ranking AS Ranking,BIS2_FN_GameThemes_TWPU_Index.rankingFromBottom AS rankingFromBottom,SUM(BIS2_FN_GameThemes_TWPU_Index.ActualWinPerUnitPerDay) AS ActualWinPerUnitPerDay,SUM(BIS2_FN_GameThemes_TWPU_Index.avgTWPUIndex) AS avgTWPUIndex,SUM(BIS2_FN_GameThemes_TWPU_Index.CoinInPerUnitPerDay) AS CoinInPerUnitPerDay,SUM(BIS2_FN_GameThemes_TWPU_Index.MachineDays) AS MachineDays,SUM(BIS2_FN_GameThemes_TWPU_Index.AdjUtil) AS Occupancy,SUM(BIS2_FN_GameThemes_TWPU_Index.PlaysPerUnitPerDay) AS PlaysPerUnitPerDay,SUM(BIS2_FN_GameThemes_TWPU_Index.TheoPerUnitPerDay) AS TheoPerUnitPerDay,SUM(BIS2_FN_GameThemes_TWPU_Index.Units) AS Units FROM dbo.BIS2_FN_GameThemes_TWPU_Index('20141201 00:00:00','20160101 00:00:00') AS BIS2_FN_GameThemes_TWPU_Index WHERE (BIS2_FN_GameThemes_TWPU_Index.rankingFromBottom <= 50) GROUP BY sign(datepart(dd,BIS2_FN_GameThemes_TWPU_Index.Norm)),BIS2_FN_GameThemes_TWPU_Index.Denom,BIS2_FN_GameThemes_TWPU_Index.GameTheme,BIS2_FN_GameThemes_TWPU_Index.GameType,BIS2_FN_GameThemes_TWPU_Index.GamingMonth,BIS2_FN_GameThemes_TWPU_Index.GamingYear,BIS2_FN_GameThemes_TWPU_Index.GamingYearMonth,BIS2_FN_GameThemes_TWPU_Index.int_yearMonth,BIS2_FN_GameThemes_TWPU_Index.Manufacturer,BIS2_FN_GameThemes_TWPU_Index.ranked_GameTheme,BIS2_FN_GameThemes_TWPU_Index.ranking,BIS2_FN_GameThemes_TWPU_Index.rankingFromBottom
	DocAggs: ['ActualWinPerUnitPerDay', 'avgTWPUIndex', 'CoinInPerUnitPerDay', 'MachineDays', 'Occupancy', 'PlaysPerUnitPerDay', 'TheoPerUnitPerDay']
	DocAggDict: {'MachineDays': 'SUM(BIS2_FN_GameThemes_TWPU_Index.MachineDays) AS MachineDays', 'CoinInPerUnitPerDay': 'SUM(BIS2_FN_GameThemes_TWPU_Index.CoinInPerUnitPerDay) AS CoinInPerUnitPerDay', 'avgTWPUIndex': 'SUM(BIS2_FN_GameThemes_TWPU_Index.avgTWPUIndex) AS avgTWPUIndex', 'TheoPerUnitPerDay': 'SUM(BIS2_FN_GameThemes_TWPU_Index.TheoPerUnitPerDay) AS TheoPerUnitPerDay', 'Occupancy': 'SUM(BIS2_FN_GameThemes_TWPU_Index.AdjUtil) AS Occupancy', 'PlaysPerUnitPerDay': 'SUM(BIS2_FN_GameThemes_TWPU_Index.PlaysPerUnitPerDay) AS PlaysPerUnitPerDay', 'ActualWinPerUnitPerDay': 'SUM(BIS2_FN_GameThemes_TWPU_Index.ActualWinPerUnitPerDay) AS ActualWinPerUnitPerDay'}
	DocJoins: ["dbo.BIS2_FN_GameThemes_TWPU_Index('20141201"]DocJoinDict: {"dbo.BIS2_FN_GameThemes_TWPU_Index('20141201": "FROM dbo.BIS2_FN_GameThemes_TWPU_Index('20141201 00:00:00','20160101 00:00:00') AS BIS2_FN_GameThemes_TWPU_Index "}
	DocWhere: ['(BIS2_FN_GameThemes_TWPU_Index.rankingFromBottom <= 50) ']
	DocWhereAnd: {'(BIS2_FN_GameThemes_TWPU_Index.rankingFromBottom <= 50) ': 'start'}
2016-10-04 10:33:35.933170: Final data about 34c682578-152570abfe9:
	UserAggList: ['ActualWinPerUnitPerDay', 'CoinInPerUnitPerDay', 'PlaysPerUnitPerDay', 'TheoPerUnitPerDay']
	UserRestrictList: []
	FinalQuery: SELECT 'Step 1' AS Step, SUM(BIS2_FN_GameThemes_TWPU_Index.ActualWinPerUnitPerDay) AS ActualWinPerUnitPerDay, SUM(BIS2_FN_GameThemes_TWPU_Index.CoinInPerUnitPerDay) AS CoinInPerUnitPerDay, SUM(BIS2_FN_GameThemes_TWPU_Index.PlaysPerUnitPerDay) AS PlaysPerUnitPerDay, SUM(BIS2_FN_GameThemes_TWPU_Index.TheoPerUnitPerDay) AS TheoPerUnitPerDay, 'dbo.BIS2_FN_GameThemes_TWPU_Index' AS StepInfo FROM dbo.BIS2_FN_GameThemes_TWPU_Index('20141201 00:00:00','20160101 00:00:00') AS BIS2_FN_GameThemes_TWPU_Index 
2016-10-04 10:33:36.330926: Checking 3502f802c-15679da5643 (All Play Theo Win per Day, FV_I01):
	Query: SELECT VBB2__Aggregates.Asset AS Asset,VBB2__Aggregates.Bank AS Bank,VBB2__Aggregates.CabinetType AS CabinetType,VBB2__Aggregates.Denom AS Denom,VBB2__Aggregates.GameCode AS GameCode,VBB2__Aggregates.Location AS Location,VBB2__Aggregates.Manufacturer AS Manufacturer,VBB2__Aggregates.Model AS Model,VBB2__Aggregates.Paylines AS Paylines,VBB2__Aggregates.Reels AS Reels,VBB2__Aggregates.Section AS Section,VBB2__Aggregates.SerialNumber AS SerialNumber,VBB2__Aggregates.Theme AS Theme,VBB2__Spatials.Latitude AS Latitude,VBB2__Spatials.Longitude AS Longitude,VBB2__Aggregates.Chairs_StandID AS Chairs_StandID,VBB2__Aggregates.Chairs_StandID_SCD_Start AS Chairs_StandID_SCD_Start,VBB2__Aggregates.Chairs_StandID_SCD_End AS Chairs_StandID_SCD_End,VBB2__Aggregates.Chairs_StandID_SCD_History AS Chairs_StandID_SCD_History,VBB2__Aggregates.Chairs_StandID_SCD_Changed AS Chairs_StandID_SCD_Changed,VBB2__Aggregates.Slot_StandID AS Slot_StandID,VBB2__Aggregates.Slot_StandID_SCD_Start AS Slot_StandID_SCD_Start,VBB2__Aggregates.Slot_StandID_SCD_End AS Slot_StandID_SCD_End,VBB2__Aggregates.Slot_StandID_SCD_History AS Slot_StandID_SCD_History,VBB2__Aggregates.Slot_StandID_SCD_Changed AS Slot_StandID_SCD_Changed,VBB2__Aggregates.ActualHoldPct AS ActualHoldPct,VBB2__Aggregates.ActualWin AS ActualWin,VBB2__Aggregates.ActualWinperDay AS ActualWinperDay,VBB2__Aggregates.AvgBet AS AvgBet,VBB2__Aggregates.CoinIn AS CoinIn,VBB2__Aggregates.CoinInperDay AS CoinInperDay,VBB2__Aggregates.DaysonFloor AS DaysonFloor,VBB2__Aggregates.GamesPlayed AS GamesPlayed,VBB2__Aggregates.GamesPlayedperDay AS GamesPlayedperDay,VBB2__Aggregates.GamesPlayedperMinute AS GamesPlayedperMinute,VBB2__Aggregates.HoldVariance AS HoldVariance,VBB2__Aggregates.Jackpot AS Jackpot,VBB2__Aggregates.Occupancy AS Occupancy,VBB2__Aggregates.PctofDenomAvgActualWin AS PctofDenomAvgActualWin,VBB2__Aggregates.PctofDenomAvgCoinIn AS PctofDenomAvgCoinIn,VBB2__Aggregates.PctofDenomAvgTheoWin AS PctofDenomAvgTheoWin,VBB2__Aggregates.PctofFloorAvgActualWin AS PctofFloorAvgActualWin,VBB2__Aggregates.PctofFloorAvgCoinIn AS PctofFloorAvgCoinIn,VBB2__Aggregates.PctofFloorAvgTheoWin AS PctofFloorAvgTheoWin,VBB2__Aggregates.PctofSectionAvgActualWin AS PctofSectionAvgActualWin,VBB2__Aggregates.PctofSectionAvgCoinIn AS PctofSectionAvgCoinIn,VBB2__Aggregates.PctofSectionAvgTheoWin AS PctofSectionAvgTheoWin,VBB2__Aggregates.TheoHoldPct AS TheoHoldPct,VBB2__Aggregates.TheoWin AS TheoWin,VBB2__Aggregates.TheoWinperDay AS TheoWinperDay,VBB2__Aggregates.TheoWinperHour AS TheoWinperHour FROM (SELECT dbo.BIS2_VW_Slot_Config.Asset AS Asset,dbo.BIS2_VW_Slot_Config.Bank AS Bank,dbo.BIS2_VW_Slot_Config.Cabinet_Type AS CabinetType,dbo.BIS2_GEO_chairs.ogc_fid AS VBB2__kf_Chairs_ogc,dbo.BIS2_VW_Slot_Config.denomination_nominal AS Denom,dbo.BIS2_VW_Slot_Config.Game_Code AS GameCode,dbo.BIS2_VW_Slot_Config.Location AS Location,dbo.BIS2_VW_Slot_Config.Manufacturer_Short_Name AS Manufacturer,dbo.BIS2_VW_Slot_Config.Model_Number AS Model,dbo.BIS2_VW_Slot_Config.Number_Of_Play_Lines AS Paylines,dbo.BIS2_VW_Slot_Config.Number_Of_Reels AS Reels,dbo.BIS2_VW_Slot_Config.Section AS Section,dbo.BIS2_VW_Slot_Config.Serial_Number AS SerialNumber,dbo.BIS2_VW_Slot_Config.Game_Description AS Theme,dbo.BIS2_GEO_chairs.standid AS Chairs_StandID,dbo.BIS2_GEO_chairs.startgd AS Chairs_StandID_SCD_Start,dbo.BIS2_GEO_chairs.endgd AS Chairs_StandID_SCD_End,dbo.BIS2_GEO_chairs.version AS Chairs_StandID_SCD_Version,CASE WHEN(datepart(year,dbo.BIS2_GEO_chairs.startgd)*10000+datepart(mm,dbo.BIS2_GEO_chairs.startgd)*100+datepart(dd,dbo.BIS2_GEO_chairs.startgd))-(datepart(year,'20160801')*10000+datepart(mm,'20160801')*100+datepart(dd,'20160801'))<0 AND (datepart(year,'20160801')*10000+datepart(mm,'20160801')*100+datepart(dd,'20160801'))-(datepart(year,dbo.BIS2_GEO_chairs.endgd)*10000+datepart(mm,dbo.BIS2_GEO_chairs.endgd)*100+datepart(dd,dbo.BIS2_GEO_chairs.endgd))<=0 THEN 0 ELSE 1 END AS Chairs_StandID_SCD_History,CASE WHEN((dbo.BIS2_GEO_chairs.startgd < '20160801' AND dbo.BIS2_GEO_chairs.startgd >= '20160101') OR (dbo.BIS2_GEO_chairs.endgd < '20160801' AND dbo.BIS2_GEO_chairs.endgd >= '20160101'))THEN 1 ELSE 0 END AS Chairs_StandID_SCD_Changed,dbo.BIS2_VW_Slot_Config.stand_id AS Slot_StandID,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AS Slot_StandID_SCD_Start,dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AS Slot_StandID_SCD_End,CASE WHEN(datepart(year,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date)*10000+datepart(mm,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date)*100+datepart(dd,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date))-(datepart(year,'20160801')*10000+datepart(mm,'20160801')*100+datepart(dd,'20160801'))<0 AND (datepart(year,'20160801')*10000+datepart(mm,'20160801')*100+datepart(dd,'20160801'))-(datepart(year,dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date)*10000+datepart(mm,dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date)*100+datepart(dd,dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date))<=0 THEN 0 ELSE 1 END AS Slot_StandID_SCD_History,CASE WHEN((dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date < '20160801' AND dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date >= '20160101') OR (dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date < '20160801' AND dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date >= '20160101'))THEN 1 ELSE 0 END AS Slot_StandID_SCD_Changed,CASE WHEN SUM(BIS2_VW_Slot_Daily.Meter_Coin_In) <> 0 THEN 100.0*SUM(BIS2_VW_Slot_Daily.Meter_Win)/SUM(BIS2_VW_Slot_Daily.Meter_Coin_In) ELSE 0 END AS ActualHoldPct,SUM(dbo.BIS2_VW_Slot_Daily.Meter_Win) AS ActualWin,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS ActualWinperDay,CASE WHEN SUM(BIS2_VW_Slot_Daily.Meter_Handle_Pulls) <> 0 THEN SUM(BIS2_VW_Slot_Daily.Meter_Coin_In)/SUM(BIS2_VW_Slot_Daily.Meter_Handle_Pulls) ELSE 0 END AS AvgBet,SUM(dbo.BIS2_VW_Slot_Daily.Meter_Coin_In) AS CoinIn,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS CoinInperDay,COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DaysonFloor,SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls) AS GamesPlayed,SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls)/COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS GamesPlayedperDay,MAX(BIS2_SQLTC_UtilCalculation.GamesPlayedperMinute) AS GamesPlayedperMinute,CASE    WHEN SUM(BIS2_VW_Slot_Daily.Meter_Coin_In) <> 0   THEN 100.0*(SUM(BIS2_VW_Slot_Daily.Meter_Win) - SUM(BIS2_VW_Slot_Daily.TheoWin))/SUM(BIS2_VW_Slot_Daily.Meter_Coin_In)   ELSE 0 END AS HoldVariance,SUM(dbo.BIS2_VW_Slot_Daily.Actual_Manual_Jackpots) AS Jackpot,MAX(BIS2_SQLTC_UtilCalculation.Occupancy) AS Occupancy,CASE    WHEN MAX(BIS2_SQLTC_DenomAvg.DenomAvgActualWin) <> 0    THEN (      SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(DISTINCT CAST(BIS2_VW_Slot_Daily.Slot_Date AS            VARCHAR) + CAST(BIS2_VW_Slot_Config.Stand_ID AS VARCHAR))      ) * 100.0 / MAX(BIS2_SQLTC_DenomAvg.DenomAvgActualWin)   ELSE 0   END AS PctofDenomAvgActualWin,CASE    WHEN MAX(BIS2_SQLTC_DenomAvg.DenomAvgCoinIn) <> 0    THEN (      SUM(BIS2_VW_Slot_Daily.Meter_Coin_In) / COUNT(DISTINCT CAST(BIS2_VW_Slot_Daily.           Slot_Date AS VARCHAR) + CAST(BIS2_VW_Slot_Config.Stand_ID AS VARCHAR))      ) * 100.0 / MAX(BIS2_SQLTC_DenomAvg.DenomAvgCoinIn)   ELSE 0   END AS PctofDenomAvgCoinIn,CASE    WHEN MAX(BIS2_SQLTC_DenomAvg.DenomAvgTheoWin) <> 0    THEN (      SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(DISTINCT CAST(BIS2_VW_Slot_Daily.slot_Date AS            VARCHAR) + CAST(BIS2_VW_Slot_Config.Stand_ID AS VARCHAR))      ) * 100.0 / MAX(BIS2_SQLTC_DenomAvg.DenomAvgTheoWin)   ELSE 0   END AS PctofDenomAvgTheoWin,CASE    WHEN MAX(BIS2_SQLTC_FloorAvg.FloorAvgActualWin) <> 0    THEN (      SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(DISTINCT CAST(BIS2_VW_Slot_Daily.slot_Date AS            VARCHAR) + CAST(BIS2_VW_Slot_Config.Stand_ID AS VARCHAR))      ) * 100.0 / MAX(BIS2_SQLTC_FloorAvg.FloorAvgActualWin)   ELSE 0   END AS PctofFloorAvgActualWin,CASE    WHEN MAX(BIS2_SQLTC_FloorAvg.FloorAvgCoinIn) <> 0    THEN (      SUM(BIS2_VW_Slot_Daily.Meter_Coin_In) / COUNT(DISTINCT CAST(BIS2_VW_Slot_Daily.           slot_Date AS VARCHAR) + CAST(BIS2_VW_Slot_Config.Stand_ID AS VARCHAR))      ) * 100.0 / MAX(BIS2_SQLTC_FloorAvg.FloorAvgCoinIn)   ELSE 0   END AS PctofFloorAvgCoinIn,CASE    WHEN MAX(BIS2_SQLTC_FloorAvg.FloorAvgTheoWin) <> 0    THEN (      SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(DISTINCT CAST(BIS2_VW_Slot_Daily.slot_Date AS            VARCHAR) + CAST(BIS2_VW_Slot_Config.Stand_ID AS VARCHAR))      ) * 100.0 / MAX(BIS2_SQLTC_FloorAvg.FloorAvgTheoWin)   ELSE 0   END AS PctofFloorAvgTheoWin,CASE    WHEN MAX(BIS2_SQLTC_SectionAvg.SectionAvgActualWin) <> 0    THEN (      SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(DISTINCT CAST(BIS2_VW_Slot_Daily.slot_Date AS            VARCHAR) + CAST(BIS2_VW_Slot_Config.Stand_ID AS VARCHAR))      ) * 100.0 / MAX(BIS2_SQLTC_SectionAvg.SectionAvgActualWin)   ELSE 0   END AS PctofSectionAvgActualWin,CASE    WHEN MAX(BIS2_SQLTC_SectionAvg.SectionAvgCoinIn) <> 0    THEN (      SUM(BIS2_VW_Slot_Daily.Meter_Coin_In) / COUNT(DISTINCT CAST(BIS2_VW_Slot_Daily.           slot_Date AS VARCHAR) + CAST(BIS2_VW_Slot_Config.Stand_ID AS VARCHAR))      ) * 100.0 / MAX(BIS2_SQLTC_SectionAvg.SectionAvgCoinIn)   ELSE 0   END AS PctofSectionAvgCoinIn,CASE    WHEN MAX(BIS2_SQLTC_SectionAvg.SectionAvgTheoWin) <> 0    THEN (      SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(DISTINCT CAST(BIS2_VW_Slot_Daily.slot_Date AS            VARCHAR) + CAST(BIS2_VW_Slot_Config.Stand_ID AS VARCHAR))      ) * 100.0 / MAX(BIS2_SQLTC_SectionAvg.SectionAvgTheoWin)   ELSE 0   END AS PctofSectionAvgTheoWin,CASE WHEN SUM(BIS2_VW_Slot_Daily.Meter_Coin_In) <> 0 THEN 100.0*SUM(BIS2_VW_Slot_Daily.Theowin)/SUM(BIS2_VW_Slot_Daily.Meter_Coin_In) ELSE 0 END AS TheoHoldPct,SUM(dbo.BIS2_VW_Slot_Daily.TheoWin) AS TheoWin,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS TheoWinperDay,MAX(BIS2_SQLTC_UtilCalculation.TheoWinperHour) AS TheoWinperHour FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) INNER JOIN dbo.BIS2_GEO_chairs ON dbo.BIS2_VW_Slot_Config.stand_id = dbo.BIS2_GEO_chairs.standid INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_SectionAvg*/SELECT dbo.BIS2_VW_Slot_Config.Section AS Section,dbo.BIS2_VW_Slot_Config.SiteID AS SiteID,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgActualWin,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgCoinIn,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgTheoWin FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.Section,dbo.BIS2_VW_Slot_Config.SiteID/* End: BIS2_SQLTC_SectionAvg*/) AS BIS2_SQLTC_SectionAvg ON (dbo.BIS2_VW_Slot_Config.Section = BIS2_SQLTC_SectionAvg.Section AND dbo.BIS2_VW_Slot_Config.SiteID = BIS2_SQLTC_SectionAvg.SiteID) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DenomAvg*/SELECT dbo.BIS2_VW_Slot_Config.denomination_nominal AS Denom,dbo.BIS2_VW_Slot_Config.SiteID AS SiteID,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DenomAvgActualWin,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DenomAvgCoinIn,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DenomAvgTheoWin FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.denomination_nominal,dbo.BIS2_VW_Slot_Config.SiteID/* End: BIS2_SQLTC_DenomAvg*/) AS BIS2_SQLTC_DenomAvg ON (dbo.BIS2_VW_Slot_Config.denomination_nominal = BIS2_SQLTC_DenomAvg.Denom AND dbo.BIS2_VW_Slot_Config.SiteID = BIS2_SQLTC_DenomAvg.SiteID) LEFT HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_UtilCalculation*/SELECT BIS2_SQLTC_RatedMetrics.Asset AS Asset,BIS2_SQLTC_RatedMetrics.Slot_Start AS Slot_Start,BIS2_SQLTC_RatedMetrics.StandID AS StandID,BIS2_SQLTC_RatedMetrics.GamesPlayedperMinute AS GamesPlayedperMinute,case when BIS2_SQLTC_RatedMetrics.GamesPlayedperHour<>0 then 100.0*BIS2_SQLTC_UnRatedMetrics.GamesPlayedperDay / BIS2_SQLTC_RatedMetrics.GamesPlayedperHour / 24.0 ELSE 0 END AS Occupancy,BIS2_SQLTC_RatedMetrics.PlayerCount AS PlayerCount,BIS2_SQLTC_RatedMetrics.TheoWinperHour AS TheoWinperHour FROM (/* SqlTableCalculator: BIS2_SQLTC_RatedMetrics*/SELECT dbo.BIS2_VW_Slot_Config.Asset AS Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AS Slot_Start,dbo.BIS2_VW_Slot_Config.stand_id AS StandID,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0)<>0 then SUM(BIS2_VW_PlayerSession.handle_pulls_meter)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) else 0 end AS GamesPlayedperHour,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/60.0)<>0 then SUM(BIS2_VW_PlayerSession.handle_pulls_meter)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/60.0) else 0 end AS GamesPlayedperMinute,count(distinct dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big) AS PlayerCount,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0)<>0 then SUM(BIS2_VW_PlayerSession.theo_loss_dol)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) else 0 end AS TheoWinperHour FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_PlayerSession.asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_PlayerSession.Time_Stopped >= dbo.BIS2_VW_Slot_Config.AV_Start_Date AND dbo.BIS2_VW_PlayerSession.Time_Stopped < dbo.BIS2_VW_Slot_Config.AV_End_Date AND dbo.BIS2_VW_PlayerSession.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20160101 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20160801 07:00:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20151231') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20160802') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date,dbo.BIS2_VW_Slot_Config.stand_id/* End: BIS2_SQLTC_RatedMetrics*/) AS BIS2_SQLTC_RatedMetrics INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_UnRatedMetrics*/SELECT dbo.BIS2_VW_Slot_Config.Asset AS Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AS Slot_Start,dbo.BIS2_VW_Slot_Config.stand_id AS StandID,CASE WHEN SUM(dbo.BIS2_VW_Slot_Daily.Machine_Days)<>0 THEN SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls)/SUM(dbo.BIS2_VW_Slot_Daily.Machine_Days) ELSE 0 END AS GamesPlayedperDay FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date,dbo.BIS2_VW_Slot_Config.stand_id/* End: BIS2_SQLTC_UnRatedMetrics*/) AS BIS2_SQLTC_UnRatedMetrics ON (BIS2_SQLTC_RatedMetrics.StandID = BIS2_SQLTC_UnRatedMetrics.StandID AND BIS2_SQLTC_RatedMetrics.Asset = BIS2_SQLTC_UnRatedMetrics.Asset AND BIS2_SQLTC_RatedMetrics.Slot_Start = BIS2_SQLTC_UnRatedMetrics.Slot_Start)/* End: BIS2_SQLTC_UtilCalculation*/) AS BIS2_SQLTC_UtilCalculation ON (dbo.BIS2_VW_Slot_Config.Asset = BIS2_SQLTC_UtilCalculation.Asset AND dbo.BIS2_VW_Slot_Config.stand_id = BIS2_SQLTC_UtilCalculation.StandID AND dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date = BIS2_SQLTC_UtilCalculation.Slot_Start) INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_FloorAvg*/SELECT dbo.BIS2_VW_Slot_Config.SiteID AS SiteID,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS FloorAvgActualWin,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS FloorAvgCoinIn,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS FloorAvgTheoWin FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.SiteID/* End: BIS2_SQLTC_FloorAvg*/) AS BIS2_SQLTC_FloorAvg ON dbo.BIS2_VW_Slot_Config.SiteID = BIS2_SQLTC_FloorAvg.SiteID WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_GEO_chairs.startgd) AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_GEO_chairs.endgd) AND (dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date) AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date)) GROUP BY dbo.BIS2_VW_Slot_Config.Asset,dbo.BIS2_VW_Slot_Config.Bank,dbo.BIS2_VW_Slot_Config.Cabinet_Type,dbo.BIS2_GEO_chairs.ogc_fid,dbo.BIS2_VW_Slot_Config.denomination_nominal,dbo.BIS2_VW_Slot_Config.Game_Code,dbo.BIS2_VW_Slot_Config.Location,dbo.BIS2_VW_Slot_Config.Manufacturer_Short_Name,dbo.BIS2_VW_Slot_Config.Model_Number,dbo.BIS2_VW_Slot_Config.Number_Of_Play_Lines,dbo.BIS2_VW_Slot_Config.Number_Of_Reels,dbo.BIS2_VW_Slot_Config.Section,dbo.BIS2_VW_Slot_Config.Serial_Number,dbo.BIS2_VW_Slot_Config.Game_Description,dbo.BIS2_GEO_chairs.standid,dbo.BIS2_GEO_chairs.startgd,dbo.BIS2_GEO_chairs.endgd,dbo.BIS2_GEO_chairs.version,CASE WHEN(datepart(year,dbo.BIS2_GEO_chairs.startgd)*10000+datepart(mm,dbo.BIS2_GEO_chairs.startgd)*100+datepart(dd,dbo.BIS2_GEO_chairs.startgd))-(datepart(year,'20160801')*10000+datepart(mm,'20160801')*100+datepart(dd,'20160801'))<0 AND (datepart(year,'20160801')*10000+datepart(mm,'20160801')*100+datepart(dd,'20160801'))-(datepart(year,dbo.BIS2_GEO_chairs.endgd)*10000+datepart(mm,dbo.BIS2_GEO_chairs.endgd)*100+datepart(dd,dbo.BIS2_GEO_chairs.endgd))<=0 THEN 0 ELSE 1 END,CASE WHEN((dbo.BIS2_GEO_chairs.startgd < '20160801' AND dbo.BIS2_GEO_chairs.startgd >= '20160101') OR (dbo.BIS2_GEO_chairs.endgd < '20160801' AND dbo.BIS2_GEO_chairs.endgd >= '20160101'))THEN 1 ELSE 0 END,dbo.BIS2_VW_Slot_Config.stand_id,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date,dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date,CASE WHEN(datepart(year,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date)*10000+datepart(mm,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date)*100+datepart(dd,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date))-(datepart(year,'20160801')*10000+datepart(mm,'20160801')*100+datepart(dd,'20160801'))<0 AND (datepart(year,'20160801')*10000+datepart(mm,'20160801')*100+datepart(dd,'20160801'))-(datepart(year,dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date)*10000+datepart(mm,dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date)*100+datepart(dd,dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date))<=0 THEN 0 ELSE 1 END,CASE WHEN((dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date < '20160801' AND dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date >= '20160101') OR (dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date < '20160801' AND dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date >= '20160101'))THEN 1 ELSE 0 END) AS VBB2__Aggregates INNER JOIN (SELECT dbo.BIS2_GEO_chairs.ogc_fid AS VBB2__kf_Chairs_ogc,dbo.BIS2_GEO_chairs.wkt_geo AS Latitude,dbo.BIS2_GEO_chairs.wkt_geo AS Longitude FROM dbo.BIS2_GEO_chairs) AS VBB2__Spatials ON VBB2__Aggregates.VBB2__kf_Chairs_ogc = VBB2__Spatials.VBB2__kf_Chairs_ogc ORDER BY Chairs_StandID,Chairs_StandID_SCD_History,Chairs_StandID_SCD_Start DESC,Slot_StandID,Slot_StandID_SCD_History,Slot_StandID_SCD_Start DESC
	DocAggs: ['ActualHoldPct', 'ActualWin', 'ActualWinperDay', 'AvgBet', 'CoinIn', 'CoinInperDay', 'DaysonFloor', 'GamesPlayed', 'GamesPlayedperDay', 'HoldVariance', 'Jackpot']
	DocAggDict: {'GamesPlayedperDay': 'SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls)/COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS GamesPlayedperDay', 'ActualWin': 'SUM(dbo.BIS2_VW_Slot_Daily.Meter_Win) AS ActualWin', 'ActualHoldPct': 'SUM(BIS2_VW_Slot_Daily.Meter_Coin_In) <> 0 THEN 100.0*SUM(BIS2_VW_Slot_Daily.Meter_Win)/SUM(BIS2_VW_Slot_Daily.Meter_Coin_In) ELSE 0 END AS ActualHoldPct', 'AvgBet': 'SUM(BIS2_VW_Slot_Daily.Meter_Handle_Pulls) <> 0 THEN SUM(BIS2_VW_Slot_Daily.Meter_Coin_In)/SUM(BIS2_VW_Slot_Daily.Meter_Handle_Pulls) ELSE 0 END AS AvgBet', 'Jackpot': 'SUM(dbo.BIS2_VW_Slot_Daily.Actual_Manual_Jackpots) AS Jackpot', 'CoinInperDay': 'SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS CoinInperDay', 'CoinIn': 'SUM(dbo.BIS2_VW_Slot_Daily.Meter_Coin_In) AS CoinIn', 'GamesPlayed': 'SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls) AS GamesPlayed', 'DaysonFloor': 'COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DaysonFloor', 'HoldVariance': 'SUM(BIS2_VW_Slot_Daily.Meter_Coin_In) <> 0   THEN 100.0*(SUM(BIS2_VW_Slot_Daily.Meter_Win) - SUM(BIS2_VW_Slot_Daily.TheoWin))/SUM(BIS2_VW_Slot_Daily.Meter_Coin_In)   ELSE 0 END AS HoldVariance', 'ActualWinperDay': 'SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS ActualWinperDay'}
	DocJoins: ['dbo.BIS2_VW_Slot_Daily', 'dbo.BIS2_VW_Slot_Config', 'dbo.BIS2_GEO_chairs', 'BIS2_SQLTC_SectionAvg', 'BIS2_SQLTC_DenomAvg', 'BIS2_SQLTC_UtilCalculation', 'BIS2_SQLTC_FloorAvg']DocJoinDict: {'BIS2_SQLTC_SectionAvg': "INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_SectionAvg*/SELECT dbo.BIS2_VW_Slot_Config.Section AS Section,dbo.BIS2_VW_Slot_Config.SiteID AS SiteID,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgActualWin,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgCoinIn,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgTheoWin FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.Section,dbo.BIS2_VW_Slot_Config.SiteID/* End: BIS2_SQLTC_SectionAvg*/) AS BIS2_SQLTC_SectionAvg ON (dbo.BIS2_VW_Slot_Config.Section = BIS2_SQLTC_SectionAvg.Section AND dbo.BIS2_VW_Slot_Config.SiteID = BIS2_SQLTC_SectionAvg.SiteID) ", 'dbo.BIS2_GEO_chairs': 'INNER JOIN dbo.BIS2_GEO_chairs ON dbo.BIS2_VW_Slot_Config.stand_id = dbo.BIS2_GEO_chairs.standid ', 'BIS2_SQLTC_UtilCalculation': "LEFT HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_UtilCalculation*/SELECT BIS2_SQLTC_RatedMetrics.Asset AS Asset,BIS2_SQLTC_RatedMetrics.Slot_Start AS Slot_Start,BIS2_SQLTC_RatedMetrics.StandID AS StandID,BIS2_SQLTC_RatedMetrics.GamesPlayedperMinute AS GamesPlayedperMinute,case when BIS2_SQLTC_RatedMetrics.GamesPlayedperHour<>0 then 100.0*BIS2_SQLTC_UnRatedMetrics.GamesPlayedperDay / BIS2_SQLTC_RatedMetrics.GamesPlayedperHour / 24.0 ELSE 0 END AS Occupancy,BIS2_SQLTC_RatedMetrics.PlayerCount AS PlayerCount,BIS2_SQLTC_RatedMetrics.TheoWinperHour AS TheoWinperHour FROM (/* SqlTableCalculator: BIS2_SQLTC_RatedMetrics*/SELECT dbo.BIS2_VW_Slot_Config.Asset AS Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AS Slot_Start,dbo.BIS2_VW_Slot_Config.stand_id AS StandID,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0)<>0 then SUM(BIS2_VW_PlayerSession.handle_pulls_meter)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) else 0 end AS GamesPlayedperHour,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/60.0)<>0 then SUM(BIS2_VW_PlayerSession.handle_pulls_meter)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/60.0) else 0 end AS GamesPlayedperMinute,count(distinct dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big) AS PlayerCount,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0)<>0 then SUM(BIS2_VW_PlayerSession.theo_loss_dol)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) else 0 end AS TheoWinperHour FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_PlayerSession.asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_PlayerSession.Time_Stopped >= dbo.BIS2_VW_Slot_Config.AV_Start_Date AND dbo.BIS2_VW_PlayerSession.Time_Stopped < dbo.BIS2_VW_Slot_Config.AV_End_Date AND dbo.BIS2_VW_PlayerSession.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20160101 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20160801 07:00:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20151231') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20160802') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date,dbo.BIS2_VW_Slot_Config.stand_id/* End: BIS2_SQLTC_RatedMetrics*/) AS BIS2_SQLTC_RatedMetrics INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_UnRatedMetrics*/SELECT dbo.BIS2_VW_Slot_Config.Asset AS Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AS Slot_Start,dbo.BIS2_VW_Slot_Config.stand_id AS StandID,CASE WHEN SUM(dbo.BIS2_VW_Slot_Daily.Machine_Days)<>0 THEN SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls)/SUM(dbo.BIS2_VW_Slot_Daily.Machine_Days) ELSE 0 END AS GamesPlayedperDay FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date,dbo.BIS2_VW_Slot_Config.stand_id/* End: BIS2_SQLTC_UnRatedMetrics*/) AS BIS2_SQLTC_UnRatedMetrics ON (BIS2_SQLTC_RatedMetrics.StandID = BIS2_SQLTC_UnRatedMetrics.StandID AND BIS2_SQLTC_RatedMetrics.Asset = BIS2_SQLTC_UnRatedMetrics.Asset AND BIS2_SQLTC_RatedMetrics.Slot_Start = BIS2_SQLTC_UnRatedMetrics.Slot_Start)/* End: BIS2_SQLTC_UtilCalculation*/) AS BIS2_SQLTC_UtilCalculation ON (dbo.BIS2_VW_Slot_Config.Asset = BIS2_SQLTC_UtilCalculation.Asset AND dbo.BIS2_VW_Slot_Config.stand_id = BIS2_SQLTC_UtilCalculation.StandID AND dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date = BIS2_SQLTC_UtilCalculation.Slot_Start) ", 'BIS2_SQLTC_DenomAvg': "INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DenomAvg*/SELECT dbo.BIS2_VW_Slot_Config.denomination_nominal AS Denom,dbo.BIS2_VW_Slot_Config.SiteID AS SiteID,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DenomAvgActualWin,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DenomAvgCoinIn,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DenomAvgTheoWin FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.denomination_nominal,dbo.BIS2_VW_Slot_Config.SiteID/* End: BIS2_SQLTC_DenomAvg*/) AS BIS2_SQLTC_DenomAvg ON (dbo.BIS2_VW_Slot_Config.denomination_nominal = BIS2_SQLTC_DenomAvg.Denom AND dbo.BIS2_VW_Slot_Config.SiteID = BIS2_SQLTC_DenomAvg.SiteID) ", 'dbo.BIS2_VW_Slot_Daily': 'FROM dbo.BIS2_VW_Slot_Daily ', 'BIS2_SQLTC_FloorAvg': "INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_FloorAvg*/SELECT dbo.BIS2_VW_Slot_Config.SiteID AS SiteID,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS FloorAvgActualWin,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS FloorAvgCoinIn,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS FloorAvgTheoWin FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.SiteID/* End: BIS2_SQLTC_FloorAvg*/) AS BIS2_SQLTC_FloorAvg ON dbo.BIS2_VW_Slot_Config.SiteID = BIS2_SQLTC_FloorAvg.SiteID ", 'dbo.BIS2_VW_Slot_Config': 'INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) '}
	DocWhere: ["(dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') ", "(dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801') ", "(dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%') ", '(dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_GEO_chairs.startgd) ', '(dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_GEO_chairs.endgd) ', '(dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date) ', '(dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date)']
	DocWhereAnd: {"(dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801') ": 'AND ', '(dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date) ': 'AND ', '(dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date)': 'AND ', '(dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_GEO_chairs.startgd) ': 'AND ', "(dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%') ": 'AND ', '(dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_GEO_chairs.endgd) ': 'AND ', "(dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') ": 'start'}
2016-10-04 10:33:46.033757: Final data about 3502f802c-15679da5643:
	UserAggList: ['ActualWin', 'CoinIn', 'DaysonFloor', 'GamesPlayed', 'Jackpot']
	UserRestrictList: []
	FinalQuery: SELECT 'Step 1' AS Step, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Win) AS ActualWin, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Coin_In) AS CoinIn, COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DaysonFloor, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls) AS GamesPlayed, SUM(dbo.BIS2_VW_Slot_Daily.Actual_Manual_Jackpots) AS Jackpot, 'dbo.BIS2_VW_Slot_Daily' AS StepInfo FROM dbo.BIS2_VW_Slot_Daily WHERE (dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101')  AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801')  UNION ALL SELECT 'Step 2' AS Step, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Win) AS ActualWin, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Coin_In) AS CoinIn, COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DaysonFloor, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls) AS GamesPlayed, SUM(dbo.BIS2_VW_Slot_Daily.Actual_Manual_Jackpots) AS Jackpot, 'dbo.BIS2_VW_Slot_Config' AS StepInfo FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE (dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101')  AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801')  AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')  UNION ALL SELECT 'Step 3' AS Step, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Win) AS ActualWin, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Coin_In) AS CoinIn, COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DaysonFloor, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls) AS GamesPlayed, SUM(dbo.BIS2_VW_Slot_Daily.Actual_Manual_Jackpots) AS Jackpot, 'dbo.BIS2_GEO_chairs' AS StepInfo FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) INNER JOIN dbo.BIS2_GEO_chairs ON dbo.BIS2_VW_Slot_Config.stand_id = dbo.BIS2_GEO_chairs.standid WHERE (dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101')  AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801')  AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')  UNION ALL SELECT 'Step 4' AS Step, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Win) AS ActualWin, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Coin_In) AS CoinIn, COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DaysonFloor, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls) AS GamesPlayed, SUM(dbo.BIS2_VW_Slot_Daily.Actual_Manual_Jackpots) AS Jackpot, 'BIS2_SQLTC_SectionAvg' AS StepInfo FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) INNER JOIN dbo.BIS2_GEO_chairs ON dbo.BIS2_VW_Slot_Config.stand_id = dbo.BIS2_GEO_chairs.standid INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_SectionAvg*/SELECT dbo.BIS2_VW_Slot_Config.Section AS Section,dbo.BIS2_VW_Slot_Config.SiteID AS SiteID,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgActualWin,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgCoinIn,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgTheoWin FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.Section,dbo.BIS2_VW_Slot_Config.SiteID/* End: BIS2_SQLTC_SectionAvg*/) AS BIS2_SQLTC_SectionAvg ON (dbo.BIS2_VW_Slot_Config.Section = BIS2_SQLTC_SectionAvg.Section AND dbo.BIS2_VW_Slot_Config.SiteID = BIS2_SQLTC_SectionAvg.SiteID) WHERE (dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101')  AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801')  AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')  UNION ALL SELECT 'Step 5' AS Step, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Win) AS ActualWin, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Coin_In) AS CoinIn, COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DaysonFloor, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls) AS GamesPlayed, SUM(dbo.BIS2_VW_Slot_Daily.Actual_Manual_Jackpots) AS Jackpot, 'BIS2_SQLTC_DenomAvg' AS StepInfo FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) INNER JOIN dbo.BIS2_GEO_chairs ON dbo.BIS2_VW_Slot_Config.stand_id = dbo.BIS2_GEO_chairs.standid INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_SectionAvg*/SELECT dbo.BIS2_VW_Slot_Config.Section AS Section,dbo.BIS2_VW_Slot_Config.SiteID AS SiteID,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgActualWin,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgCoinIn,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgTheoWin FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.Section,dbo.BIS2_VW_Slot_Config.SiteID/* End: BIS2_SQLTC_SectionAvg*/) AS BIS2_SQLTC_SectionAvg ON (dbo.BIS2_VW_Slot_Config.Section = BIS2_SQLTC_SectionAvg.Section AND dbo.BIS2_VW_Slot_Config.SiteID = BIS2_SQLTC_SectionAvg.SiteID) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DenomAvg*/SELECT dbo.BIS2_VW_Slot_Config.denomination_nominal AS Denom,dbo.BIS2_VW_Slot_Config.SiteID AS SiteID,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DenomAvgActualWin,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DenomAvgCoinIn,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DenomAvgTheoWin FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.denomination_nominal,dbo.BIS2_VW_Slot_Config.SiteID/* End: BIS2_SQLTC_DenomAvg*/) AS BIS2_SQLTC_DenomAvg ON (dbo.BIS2_VW_Slot_Config.denomination_nominal = BIS2_SQLTC_DenomAvg.Denom AND dbo.BIS2_VW_Slot_Config.SiteID = BIS2_SQLTC_DenomAvg.SiteID) WHERE (dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101')  AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801')  AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')  UNION ALL SELECT 'Step 6' AS Step, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Win) AS ActualWin, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Coin_In) AS CoinIn, COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DaysonFloor, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls) AS GamesPlayed, SUM(dbo.BIS2_VW_Slot_Daily.Actual_Manual_Jackpots) AS Jackpot, 'BIS2_SQLTC_UtilCalculation' AS StepInfo FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) INNER JOIN dbo.BIS2_GEO_chairs ON dbo.BIS2_VW_Slot_Config.stand_id = dbo.BIS2_GEO_chairs.standid INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_SectionAvg*/SELECT dbo.BIS2_VW_Slot_Config.Section AS Section,dbo.BIS2_VW_Slot_Config.SiteID AS SiteID,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgActualWin,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgCoinIn,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgTheoWin FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.Section,dbo.BIS2_VW_Slot_Config.SiteID/* End: BIS2_SQLTC_SectionAvg*/) AS BIS2_SQLTC_SectionAvg ON (dbo.BIS2_VW_Slot_Config.Section = BIS2_SQLTC_SectionAvg.Section AND dbo.BIS2_VW_Slot_Config.SiteID = BIS2_SQLTC_SectionAvg.SiteID) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DenomAvg*/SELECT dbo.BIS2_VW_Slot_Config.denomination_nominal AS Denom,dbo.BIS2_VW_Slot_Config.SiteID AS SiteID,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DenomAvgActualWin,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DenomAvgCoinIn,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DenomAvgTheoWin FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.denomination_nominal,dbo.BIS2_VW_Slot_Config.SiteID/* End: BIS2_SQLTC_DenomAvg*/) AS BIS2_SQLTC_DenomAvg ON (dbo.BIS2_VW_Slot_Config.denomination_nominal = BIS2_SQLTC_DenomAvg.Denom AND dbo.BIS2_VW_Slot_Config.SiteID = BIS2_SQLTC_DenomAvg.SiteID) LEFT HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_UtilCalculation*/SELECT BIS2_SQLTC_RatedMetrics.Asset AS Asset,BIS2_SQLTC_RatedMetrics.Slot_Start AS Slot_Start,BIS2_SQLTC_RatedMetrics.StandID AS StandID,BIS2_SQLTC_RatedMetrics.GamesPlayedperMinute AS GamesPlayedperMinute,case when BIS2_SQLTC_RatedMetrics.GamesPlayedperHour<>0 then 100.0*BIS2_SQLTC_UnRatedMetrics.GamesPlayedperDay / BIS2_SQLTC_RatedMetrics.GamesPlayedperHour / 24.0 ELSE 0 END AS Occupancy,BIS2_SQLTC_RatedMetrics.PlayerCount AS PlayerCount,BIS2_SQLTC_RatedMetrics.TheoWinperHour AS TheoWinperHour FROM (/* SqlTableCalculator: BIS2_SQLTC_RatedMetrics*/SELECT dbo.BIS2_VW_Slot_Config.Asset AS Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AS Slot_Start,dbo.BIS2_VW_Slot_Config.stand_id AS StandID,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0)<>0 then SUM(BIS2_VW_PlayerSession.handle_pulls_meter)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) else 0 end AS GamesPlayedperHour,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/60.0)<>0 then SUM(BIS2_VW_PlayerSession.handle_pulls_meter)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/60.0) else 0 end AS GamesPlayedperMinute,count(distinct dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big) AS PlayerCount,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0)<>0 then SUM(BIS2_VW_PlayerSession.theo_loss_dol)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) else 0 end AS TheoWinperHour FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_PlayerSession.asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_PlayerSession.Time_Stopped >= dbo.BIS2_VW_Slot_Config.AV_Start_Date AND dbo.BIS2_VW_PlayerSession.Time_Stopped < dbo.BIS2_VW_Slot_Config.AV_End_Date AND dbo.BIS2_VW_PlayerSession.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20160101 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20160801 07:00:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20151231') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20160802') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date,dbo.BIS2_VW_Slot_Config.stand_id/* End: BIS2_SQLTC_RatedMetrics*/) AS BIS2_SQLTC_RatedMetrics INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_UnRatedMetrics*/SELECT dbo.BIS2_VW_Slot_Config.Asset AS Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AS Slot_Start,dbo.BIS2_VW_Slot_Config.stand_id AS StandID,CASE WHEN SUM(dbo.BIS2_VW_Slot_Daily.Machine_Days)<>0 THEN SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls)/SUM(dbo.BIS2_VW_Slot_Daily.Machine_Days) ELSE 0 END AS GamesPlayedperDay FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date,dbo.BIS2_VW_Slot_Config.stand_id/* End: BIS2_SQLTC_UnRatedMetrics*/) AS BIS2_SQLTC_UnRatedMetrics ON (BIS2_SQLTC_RatedMetrics.StandID = BIS2_SQLTC_UnRatedMetrics.StandID AND BIS2_SQLTC_RatedMetrics.Asset = BIS2_SQLTC_UnRatedMetrics.Asset AND BIS2_SQLTC_RatedMetrics.Slot_Start = BIS2_SQLTC_UnRatedMetrics.Slot_Start)/* End: BIS2_SQLTC_UtilCalculation*/) AS BIS2_SQLTC_UtilCalculation ON (dbo.BIS2_VW_Slot_Config.Asset = BIS2_SQLTC_UtilCalculation.Asset AND dbo.BIS2_VW_Slot_Config.stand_id = BIS2_SQLTC_UtilCalculation.StandID AND dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date = BIS2_SQLTC_UtilCalculation.Slot_Start) WHERE (dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101')  AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801')  AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')  UNION ALL SELECT 'Step 7' AS Step, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Win) AS ActualWin, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Coin_In) AS CoinIn, COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DaysonFloor, SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls) AS GamesPlayed, SUM(dbo.BIS2_VW_Slot_Daily.Actual_Manual_Jackpots) AS Jackpot, 'BIS2_SQLTC_FloorAvg' AS StepInfo FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) INNER JOIN dbo.BIS2_GEO_chairs ON dbo.BIS2_VW_Slot_Config.stand_id = dbo.BIS2_GEO_chairs.standid INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_SectionAvg*/SELECT dbo.BIS2_VW_Slot_Config.Section AS Section,dbo.BIS2_VW_Slot_Config.SiteID AS SiteID,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgActualWin,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgCoinIn,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS SectionAvgTheoWin FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.Section,dbo.BIS2_VW_Slot_Config.SiteID/* End: BIS2_SQLTC_SectionAvg*/) AS BIS2_SQLTC_SectionAvg ON (dbo.BIS2_VW_Slot_Config.Section = BIS2_SQLTC_SectionAvg.Section AND dbo.BIS2_VW_Slot_Config.SiteID = BIS2_SQLTC_SectionAvg.SiteID) INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_DenomAvg*/SELECT dbo.BIS2_VW_Slot_Config.denomination_nominal AS Denom,dbo.BIS2_VW_Slot_Config.SiteID AS SiteID,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DenomAvgActualWin,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DenomAvgCoinIn,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS DenomAvgTheoWin FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.denomination_nominal,dbo.BIS2_VW_Slot_Config.SiteID/* End: BIS2_SQLTC_DenomAvg*/) AS BIS2_SQLTC_DenomAvg ON (dbo.BIS2_VW_Slot_Config.denomination_nominal = BIS2_SQLTC_DenomAvg.Denom AND dbo.BIS2_VW_Slot_Config.SiteID = BIS2_SQLTC_DenomAvg.SiteID) LEFT HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_UtilCalculation*/SELECT BIS2_SQLTC_RatedMetrics.Asset AS Asset,BIS2_SQLTC_RatedMetrics.Slot_Start AS Slot_Start,BIS2_SQLTC_RatedMetrics.StandID AS StandID,BIS2_SQLTC_RatedMetrics.GamesPlayedperMinute AS GamesPlayedperMinute,case when BIS2_SQLTC_RatedMetrics.GamesPlayedperHour<>0 then 100.0*BIS2_SQLTC_UnRatedMetrics.GamesPlayedperDay / BIS2_SQLTC_RatedMetrics.GamesPlayedperHour / 24.0 ELSE 0 END AS Occupancy,BIS2_SQLTC_RatedMetrics.PlayerCount AS PlayerCount,BIS2_SQLTC_RatedMetrics.TheoWinperHour AS TheoWinperHour FROM (/* SqlTableCalculator: BIS2_SQLTC_RatedMetrics*/SELECT dbo.BIS2_VW_Slot_Config.Asset AS Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AS Slot_Start,dbo.BIS2_VW_Slot_Config.stand_id AS StandID,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0)<>0 then SUM(BIS2_VW_PlayerSession.handle_pulls_meter)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) else 0 end AS GamesPlayedperHour,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/60.0)<>0 then SUM(BIS2_VW_PlayerSession.handle_pulls_meter)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/60.0) else 0 end AS GamesPlayedperMinute,count(distinct dbo.BIS2_VW_PlayerSession.Patron_Account_Number_9_Big) AS PlayerCount,case when sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0)<>0 then SUM(BIS2_VW_PlayerSession.theo_loss_dol)/sum(BIS2_VW_PlayerSession.TimePlayedSecs/3600.0) else 0 end AS TheoWinperHour FROM dbo.BIS2_VW_PlayerSession INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_PlayerSession.asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_PlayerSession.Time_Stopped >= dbo.BIS2_VW_Slot_Config.AV_Start_Date AND dbo.BIS2_VW_PlayerSession.Time_Stopped < dbo.BIS2_VW_Slot_Config.AV_End_Date AND dbo.BIS2_VW_PlayerSession.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_PlayerSession.Time_Started >= '20160101 07:00:00') AND (dbo.BIS2_VW_PlayerSession.Time_Started < '20160801 07:00:00') AND (dbo.BIS2_VW_PlayerSession.GamingDate >= '20151231') AND (dbo.BIS2_VW_PlayerSession.GamingDate < '20160802') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date,dbo.BIS2_VW_Slot_Config.stand_id/* End: BIS2_SQLTC_RatedMetrics*/) AS BIS2_SQLTC_RatedMetrics INNER HASH JOIN (/* SqlTableCalculator: BIS2_SQLTC_UnRatedMetrics*/SELECT dbo.BIS2_VW_Slot_Config.Asset AS Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AS Slot_Start,dbo.BIS2_VW_Slot_Config.stand_id AS StandID,CASE WHEN SUM(dbo.BIS2_VW_Slot_Daily.Machine_Days)<>0 THEN SUM(dbo.BIS2_VW_Slot_Daily.Meter_Handle_Pulls)/SUM(dbo.BIS2_VW_Slot_Daily.Machine_Days) ELSE 0 END AS GamesPlayedperDay FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.Asset,dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date,dbo.BIS2_VW_Slot_Config.stand_id/* End: BIS2_SQLTC_UnRatedMetrics*/) AS BIS2_SQLTC_UnRatedMetrics ON (BIS2_SQLTC_RatedMetrics.StandID = BIS2_SQLTC_UnRatedMetrics.StandID AND BIS2_SQLTC_RatedMetrics.Asset = BIS2_SQLTC_UnRatedMetrics.Asset AND BIS2_SQLTC_RatedMetrics.Slot_Start = BIS2_SQLTC_UnRatedMetrics.Slot_Start)/* End: BIS2_SQLTC_UtilCalculation*/) AS BIS2_SQLTC_UtilCalculation ON (dbo.BIS2_VW_Slot_Config.Asset = BIS2_SQLTC_UtilCalculation.Asset AND dbo.BIS2_VW_Slot_Config.stand_id = BIS2_SQLTC_UtilCalculation.StandID AND dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date = BIS2_SQLTC_UtilCalculation.Slot_Start) INNER JOIN (/* SqlTableCalculator: BIS2_SQLTC_FloorAvg*/SELECT dbo.BIS2_VW_Slot_Config.SiteID AS SiteID,SUM(BIS2_VW_Slot_Daily.Meter_Win) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS FloorAvgActualWin,SUM(BIS2_VW_Slot_Daily.Meter_coin_in) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS FloorAvgCoinIn,SUM(BIS2_VW_Slot_Daily.TheoWin) / COUNT(distinct cast(dbo.BIS2_VW_Slot_Daily.slot_date as varchar) + cast(BIS2_VW_Slot_Config.Stand_ID as varchar)) AS FloorAvgTheoWin FROM dbo.BIS2_VW_Slot_Daily INNER JOIN dbo.BIS2_VW_Slot_Config ON (dbo.BIS2_VW_Slot_Daily.Asset = dbo.BIS2_VW_Slot_Config.Asset AND dbo.BIS2_VW_Slot_Daily.Slot_Date >= dbo.BIS2_VW_Slot_Config.Configuration_Activation_Date AND dbo.BIS2_VW_Slot_Daily.Slot_Date < dbo.BIS2_VW_Slot_Config.Configuration_Deactivation_Date AND dbo.BIS2_VW_Slot_Daily.Stand_ID = dbo.BIS2_VW_Slot_Config.stand_id) WHERE ((dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101') AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801') AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%')) GROUP BY dbo.BIS2_VW_Slot_Config.SiteID/* End: BIS2_SQLTC_FloorAvg*/) AS BIS2_SQLTC_FloorAvg ON dbo.BIS2_VW_Slot_Config.SiteID = BIS2_SQLTC_FloorAvg.SiteID WHERE (dbo.BIS2_VW_Slot_Daily.Slot_Date >= '20160101')  AND (dbo.BIS2_VW_Slot_Daily.Slot_Date < '20160801')  AND (dbo.BIS2_VW_Slot_Config.Section NOT LIKE 'T%') 
2016-10-04 10:33:46.048789: Now attempting to run the query for 34cdb4f78-1572bb96312:
2016-10-04 10:33:46.061298: Attempting to connect to the database:
2016-10-04 10:33:52.019175: Database connection successful.
2016-10-04 10:35:08.517549: Query successfully run. Here are the results:
	[('Step 1', Decimal('113791.7900'), Decimal('6948415.14'), Decimal('0.00'), Decimal('4008259'), Decimal('660285.96'), 'dbo.BIS2_FN_Loyalty'), ('Step 2', Decimal('113791.7900'), Decimal('6948415.14'), Decimal('0.00'), Decimal('4008259'), Decimal('660285.96'), 'dbo.BIS2_VW_Patron'), ('Step 3', Decimal('113791.7900'), Decimal('6948415.14'), Decimal('0.00'), Decimal('4008259'), Decimal('660285.96'), 'dbo.BIS2_VW_EMAIL'), ('Step 4', Decimal('113791.7900'), Decimal('6948415.14'), Decimal('0.00'), Decimal('4008259'), Decimal('660285.96'), 'dbo.BIS2_VW_Card_Levels'), ('Step 5', Decimal('113791.7900'), Decimal('6948415.14'), Decimal('0.00'), Decimal('4008259'), Decimal('660285.96'), 'dbo.BIS2_VW_Host_Patron'), ('Step 6', Decimal('113791.7900'), Decimal('6948415.14'), Decimal('0.00'), Decimal('4008259'), Decimal('660285.96'), 'dbo.BIS2_VW_Host_Master'), ('Step 7', Decimal('113791.7900'), Decimal('6948415.14'), Decimal('0.00'), Decimal('4008259'), Decimal('660285.96'), 'dbo.BIS2_VW_Cell'), ('Step 8', Decimal('113791.7900'), Decimal('6948415.14'), Decimal('0.00'), Decimal('4008259'), Decimal('660285.96'), 'dbo.BIS2_Patron_Profile')]
2016-10-04 10:35:08.529530: Now attempting to run the query for 35054c327-14d4e2e337d:
2016-10-04 10:35:08.542065: Attempting to connect to the database:
2016-10-04 10:35:08.769710: Database connection successful.